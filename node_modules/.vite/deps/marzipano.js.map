{
  "version": 3,
  "sources": ["../../minimal-event-emitter/index.js", "../../marzipano/src/util/now.js", "../../marzipano/src/collections/WorkQueue.js", "../../marzipano/src/util/calcRect.js", "../../marzipano/src/util/async.js", "../../marzipano/src/util/once.js", "../../marzipano/src/util/cancelize.js", "../../marzipano/src/util/clearOwnProperties.js", "../../marzipano/src/stages/RendererRegistry.js", "../../marzipano/src/stages/Stage.js", "../../marzipano/src/util/global.js", "../../marzipano/src/assets/Static.js", "../../marzipano/src/util/inherits.js", "../../marzipano/src/NetworkError.js", "../../bowser/src/bowser.js", "../../marzipano/src/loaders/HtmlImage.js", "../../marzipano/src/util/pixelRatio.js", "../../marzipano/src/util/ispot.js", "../../marzipano/src/util/dom.js", "../../marzipano/src/stages/WebGl.js", "../../gl-matrix/esm/common.js", "../../gl-matrix/esm/mat2.js", "../../gl-matrix/esm/mat2d.js", "../../gl-matrix/esm/mat3.js", "../../gl-matrix/esm/mat4.js", "../../gl-matrix/esm/vec3.js", "../../gl-matrix/esm/vec4.js", "../../gl-matrix/esm/quat.js", "../../gl-matrix/esm/quat2.js", "../../gl-matrix/esm/vec2.js", "../../gl-matrix/esm/index.js", "../../marzipano/src/util/clamp.js", "../../marzipano/src/renderers/WebGlCommon.js", "../../marzipano/src/shaders/vertexNormal.js", "../../marzipano/src/shaders/fragmentNormal.js", "../../marzipano/src/renderers/WebGlBase.js", "../../marzipano/src/renderers/WebGlCube.js", "../../marzipano/src/renderers/WebGlFlat.js", "../../marzipano/src/shaders/vertexEquirect.js", "../../marzipano/src/shaders/fragmentEquirect.js", "../../marzipano/src/renderers/WebGlEquirect.js", "../../marzipano/src/renderers/registerDefaultRenderers.js", "../../marzipano/src/util/hash.js", "../../marzipano/src/util/mod.js", "../../marzipano/src/collections/Set.js", "../../marzipano/src/TileSearcher.js", "../../marzipano/src/collections/LruMap.js", "../../marzipano/src/geometries/Level.js", "../../marzipano/src/util/cmp.js", "../../marzipano/src/geometries/common.js", "../../marzipano/src/util/type.js", "../../marzipano/src/geometries/Cube.js", "../../marzipano/src/geometries/Flat.js", "../../marzipano/src/geometries/Equirect.js", "../../marzipano/src/util/convertFov.js", "../../marzipano/src/util/real.js", "../../marzipano/src/util/decimal.js", "../../marzipano/src/util/compose.js", "../../marzipano/src/views/Rectilinear.js", "../../marzipano/src/views/Flat.js", "../../marzipano/src/collections/WorkPool.js", "../../marzipano/src/util/noop.js", "../../marzipano/src/util/chain.js", "../../marzipano/src/util/delay.js", "../../marzipano/src/sources/ImageUrl.js", "../../marzipano/src/sources/SingleAsset.js", "../../marzipano/src/assets/Dynamic.js", "../../marzipano/src/collections/Map.js", "../../marzipano/src/collections/LruSet.js", "../../marzipano/src/util/defaults.js", "../../marzipano/src/util/retry.js", "../../marzipano/src/TextureStore.js", "../../marzipano/src/util/extend.js", "../../marzipano/src/Layer.js", "../../marzipano/src/RenderLoop.js", "../../marzipano/src/controls/Dynamics.js", "../../marzipano/src/controls/Key.js", "../../hammerjs/hammer.js", "../../marzipano/src/controls/HammerGestures.js", "../../marzipano/src/controls/util.js", "../../marzipano/src/controls/Drag.js", "../../marzipano/src/controls/Qtvr.js", "../../marzipano/src/controls/ScrollZoom.js", "../../marzipano/src/controls/PinchZoom.js", "../../marzipano/src/controls/Velocity.js", "../../marzipano/src/controls/ElementPress.js", "../../marzipano/src/controls/Composer.js", "../../marzipano/src/controls/Controls.js", "../../marzipano/src/util/positionAbsolutely.js", "../../marzipano/src/Hotspot.js", "../../marzipano/src/HotspotContainer.js", "../../marzipano/src/Scene.js", "../../marzipano/src/Timer.js", "../../marzipano/src/controls/ControlCursor.js", "../../marzipano/src/controls/registerDefaultControls.js", "../../marzipano/src/util/tween.js", "../../marzipano/src/Viewer.js", "../../marzipano/src/colorEffects.js", "../../marzipano/src/autorotate.js", "../../marzipano/src/util/defer.js", "../../marzipano/src/util/degToRad.js", "../../marzipano/src/util/radToDeg.js", "../../marzipano/src/index.js"],
  "sourcesContent": ["'use strict';\n\n/**\n * @class\n * @classdesc Minimalistic event emitter mixin.\n */\nfunction EventEmitter() {}\n\n/**\n * Registers an event listener for the specified event. If the listener has\n * already been registered for the event, this is a no-op.\n *\n * @param {string} name The event name.\n * @param {function} fn The listener function.\n */\nEventEmitter.prototype.addEventListener = function(name, fn) {\n  var eventMap = this.__events = this.__events || {};\n  var handlerList = eventMap[name] = eventMap[name] || [];\n  if (handlerList.indexOf(fn) < 0) {\n    handlerList.push(fn);\n  }\n};\n\n/**\n * Unregisters an event listener from the specified event. If the listener\n * hasn't been registered for the event, this is a no-op.\n *\n * @param {string} name The event name.\n * @param {function} fn The listener function.\n */\nEventEmitter.prototype.removeEventListener = function(name, fn) {\n  var eventMap = this.__events = this.__events || {};\n  var handlerList = eventMap[name];\n  if (handlerList) {\n    var index = handlerList.indexOf(fn);\n    if (index >= 0) {\n      handlerList.splice(index, 1);\n    }\n  }\n};\n\n/**\n * Emits an event, causing all registered event listeners for that event to be\n * called in registration order.\n *\n * @param {string} name The event name.\n * @param {...*} var_args Arguments to call listeners with.\n */\nEventEmitter.prototype.emit = function(name, var_args) {\n  var eventMap = this.__events = this.__events || {};\n  var handlerList = eventMap[name];\n  var args = Array.prototype.slice.call(arguments, 1);\n  if (handlerList) {\n    for (var i = 0; i < handlerList.length; i++) {\n      var fn = handlerList[i];\n      fn.apply(this, args);\n    }\n  }\n};\n\n/**\n * Mixes in {@link EventEmitter} into a constructor function.\n *\n * @param {function} ctor The constructor function.\n */\nfunction eventEmitter(ctor) {\n  for (var prop in EventEmitter.prototype) {\n    if (EventEmitter.prototype.hasOwnProperty(prop)) {\n      ctor.prototype[prop] = EventEmitter.prototype[prop];\n    }\n  }\n}\n\nmodule.exports = eventEmitter;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction getNow() {\n  if (typeof performance !== 'undefined' && performance.now) {\n    return function performanceNow() {\n      return performance.now();\n    };\n  }\n  return function dateNow() {\n    return Date.now();\n  };\n}\n\nmodule.exports = getNow();\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar now = require('../util/now');\n\n\nfunction WorkTask(fn, cb) {\n  this.fn = fn;\n  this.cb = cb;\n  this.cfn = null;\n}\n\n\nfunction WorkQueue(opts) {\n  this._queue = [];\n  this._delay = opts && opts.delay || 0;\n  this._paused = opts && !!opts.paused || false;\n  this._currentTask = null;\n  this._lastFinished = null;\n}\n\n\nWorkQueue.prototype.length = function() {\n  return this._queue.length;\n};\n\n\nWorkQueue.prototype.push = function(fn, cb) {\n\n  var task = new WorkTask(fn, cb);\n\n  var cancel = this._cancel.bind(this, task);\n\n  // Push the task into the queue.\n  this._queue.push(task);\n\n  // Run the task if idle.\n  this._next();\n\n  return cancel;\n\n};\n\n\nWorkQueue.prototype.pause = function() {\n  if (!this._paused) {\n    this._paused = true;\n  }\n};\n\n\nWorkQueue.prototype.resume = function() {\n  if (this._paused) {\n    this._paused = false;\n    this._next();\n  }\n};\n\n\nWorkQueue.prototype._start = function(task) {\n\n  // Consistency check.\n  if (this._currentTask) {\n    throw new Error('WorkQueue: called start while running task');\n  }\n\n  // Mark queue as busy, so that concurrent tasks wait.\n  this._currentTask = task;\n\n  // Execute the task.\n  var finish = this._finish.bind(this, task);\n  task.cfn = task.fn(finish);\n\n  // Detect when a non-cancellable function has been queued.\n  if (typeof task.cfn !== 'function') {\n    throw new Error('WorkQueue: function is not cancellable');\n  }\n\n};\n\n\nWorkQueue.prototype._finish = function(task) {\n\n  var args = Array.prototype.slice.call(arguments, 1);\n\n  // Consistency check.\n  if (this._currentTask !== task) {\n    throw new Error('WorkQueue: called finish on wrong task');\n  }\n\n  // Call the task callback on the return values.\n  task.cb.apply(null, args);\n\n  // Mark as not busy and record task finish time, then advance to next task.\n  this._currentTask = null;\n  this._lastFinished = now();\n  this._next();\n\n};\n\n\nWorkQueue.prototype._cancel = function(task) {\n\n  var args = Array.prototype.slice.call(arguments, 1);\n\n  if (this._currentTask === task) {\n\n    // Cancel running task. Because cancel passes control to the _finish\n    // callback we passed into fn, the cleanup logic will be handled there.\n    task.cfn.apply(null, args);\n\n  } else {\n\n    // Remove task from queue.\n    var pos = this._queue.indexOf(task);\n    if (pos >= 0) {\n      this._queue.splice(pos, 1);\n      task.cb.apply(null, args);\n    }\n\n  }\n\n};\n\n\nWorkQueue.prototype._next = function() {\n\n  if (this._paused) {\n    // Do not start tasks while paused.\n    return;\n  }\n\n  if (!this._queue.length) {\n    // No tasks to run.\n    return;\n  }\n\n  if (this._currentTask) {\n    // Will be called again when the current task finishes.\n    return;\n  }\n\n  if (this._lastFinished != null) {\n    var elapsed = now() - this._lastFinished;\n    var remaining = this._delay - elapsed;\n    if (remaining > 0) {\n      // Too soon. Run again after the inter-task delay.\n      setTimeout(this._next.bind(this), remaining);\n      return;\n    }\n  }\n\n  // Run the next task.\n  var task = this._queue.shift();\n  this._start(task);\n\n};\n\n\nmodule.exports = WorkQueue;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * Converts a {@link RectSpec} into an equivalent {@link Rect}.\n *\n * A {@link RectSpec} is a convenient user API format, providing default values\n * and the flexibility of specifying absolute, relative or mixed dimensions.\n *\n * A {@link Rect} is a more convenient format for the rendering pipeline. It is\n * always expressed in normalized coordinates, and all its properties are\n * guaranteed to be present.\n *\n * @param {number} totalWidth The total width of the rendering area in pixels.\n * @param {number} totalHeight The total height of the rendering area in pixels.\n * @param {RectSpec} spec The input spec, defaulting to the full rendering area\n *     if null or undefined.\n * @param {Rect} result The output spec. If the argument is present, it is\n *     filled in and returned; otherwise, a fresh object is returned.\n */\nfunction calcRect(totalWidth, totalHeight, spec, result) {\n\n  result = result || {};\n\n  var width;\n  if (spec != null && spec.absoluteWidth != null) {\n    width = spec.absoluteWidth / totalWidth;\n  } else if (spec != null && spec.relativeWidth != null) {\n    width = spec.relativeWidth;\n  } else {\n    width = 1;\n  }\n\n  var height;\n  if (spec && spec.absoluteHeight != null) {\n    height = spec.absoluteHeight / totalHeight;\n  } else if (spec != null && spec.relativeHeight != null) {\n    height = spec.relativeHeight;\n  } else {\n    height = 1;\n  }\n\n  var x;\n  if (spec != null && spec.absoluteX != null) {\n    x = spec.absoluteX / totalWidth;\n  } else if (spec != null && spec.relativeX != null) {\n    x = spec.relativeX;\n  } else {\n    x = 0;\n  }\n\n  var y;\n  if (spec != null && spec.absoluteY != null) {\n    y = spec.absoluteY / totalHeight;\n  } else if (spec != null && spec.relativeY != null) {\n    y = spec.relativeY;\n  } else {\n    y = 0;\n  }\n\n  result.x = x;\n  result.y = y;\n  result.width = width;\n  result.height = height;\n\n  return result;\n}\n\nmodule.exports = calcRect;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Transform a synchronous function into an asynchronous one.\nfunction async(fn) {\n  return function asynced(done) {\n    var err, ret;\n    try {\n      ret = fn();\n    } catch (e) {\n      err = e;\n    } finally {\n      if (err) {\n        done(err);\n      } else {\n        done(null, ret);\n      }\n    }\n  };\n}\n\nmodule.exports = async;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction once(fn) {\n  var called = false;\n  var value;\n  return function onced() {\n    if (!called) {\n      called = true;\n      value = fn.apply(null, arguments);\n    }\n    return value;\n  };\n}\n\nmodule.exports = once;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar once = require('./once');\n\n// A cancelable function is an asynchronous function (i.e., one whose last\n// argument is a callback receiving an error plus zero or more return values)\n// that (synchronously) returns a cancel() function. Calling cancel() should\n// abort the asynchronous operation and call the callback with the arguments\n// that were passed into cancel(). Calling cancel() twice, as with callbacks,\n// is not guaranteed to be safe.\n\n// Wrap a non-cancellable asynchronous function into a cancelable one.\n//\n// Calling cancel() on the returned function will not interrupt the execution\n// of the original function; it will merely ignore its return value.\n//\n// Usually, instead of wrapping your function, you want to implement cancel()\n// yourself in order to have some abort logic. This utility function provides a\n// straighforward solution for cases in which no custom abort logic is required.\nfunction cancelize(fn) {\n  return function cancelized() {\n    if (!arguments.length) {\n      throw new Error('cancelized: expected at least one argument');\n    }\n    var args = Array.prototype.slice.call(arguments, 0);\n    var done = args[args.length - 1] = once(args[args.length - 1]);\n\n    function cancel() {\n      done.apply(null, arguments);\n    }\n\n    fn.apply(null, args);\n\n    return cancel;\n  };\n}\n\nmodule.exports = cancelize;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Sets an object's own properties to undefined. This may be called by\n// destructors to avoid retaining references and help detect incorrect use of\n// destroyed instances.\nfunction clearOwnProperties(obj) {\n  for (var prop in obj) {\n    if (obj.hasOwnProperty(prop)) {\n      obj[prop] = undefined;\n    }\n  }\n}\n\nmodule.exports = clearOwnProperties;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @class RendererRegistry\n * @classdesc\n *\n * A RendererRegistry maps pairs of {@link Geometry} and {@link View} type into\n * the appropriate {@link Renderer} class. It is used by a {@link Stage} to\n * determine the appropriate renderer for a {@link Layer}.\n *\n * See also {@link Stage#registerRenderer}.\n */\nfunction RendererRegistry() {\n  this._renderers = {};\n}\n\n/**\n * Registers a renderer for the given geometry and view type.\n * @param {string} geometryType The geometry type, as given by\n *     {@link Geometry#type}.\n * @param {string} viewType The view type, as given by {@link View#type}.\n * @param {*} Renderer The renderer class.\n */\nRendererRegistry.prototype.set = function(geometryType, viewType, Renderer) {\n  if (!this._renderers[geometryType]) {\n    this._renderers[geometryType] = {};\n  }\n  this._renderers[geometryType][viewType] = Renderer;\n};\n\n/**\n * Retrieves the renderer for the given geometry and view type.\n * @param {string} geometryType The geometry type, as given by\n *     {@link Geometry#type}.\n * @param {string} viewType The view type, as given by {@link View#type}.\n * @param {*} Renderer The renderer class, or null if no such renderer has been\n * registered.\n */\nRendererRegistry.prototype.get = function(geometryType, viewType) {\n  var Renderer = this._renderers[geometryType] &&\n      this._renderers[geometryType][viewType];\n  return Renderer || null;\n};\n\nmodule.exports = RendererRegistry;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar WorkQueue = require('../collections/WorkQueue');\nvar calcRect = require('../util/calcRect');\nvar async = require('../util/async');\nvar cancelize = require('../util/cancelize');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar RendererRegistry = require('./RendererRegistry');\n\nfunction forwardTileCmp(t1, t2) {\n  return t1.cmp(t2);\n}\n\nfunction reverseTileCmp(t1, t2) {\n  return -t1.cmp(t2);\n}\n\n/**\n * Signals that the stage has been rendered.\n *\n * @param {boolean} stable Whether all tiles were successfully rendered without\n *     missing textures or resorting to fallbacks.\n * @event Stage#renderComplete\n */\n\n/**\n * Signals that the contents of the stage have been invalidated and must be\n * rendered again.\n *\n * This is used by the {@link RenderLoop} implementation.\n *\n * @event Stage#renderInvalid\n */\n\n/**\n * @interface Stage\n * @classdesc\n *\n * A Stage is a container with the ability to render a stack of\n * {@link Layer layers}.\n *\n * This class should never be instantiated directly. Use {@link WebGlStage}\n * instead.\n *\n * @param {Object} opts\n * @param {boolean} [opts.progressive=false]\n *\n * Options listed here may be passed into the `opts` constructor argument of\n * subclasses.\n *\n * The `progressive` option controls whether resolution levels are loaded in\n * order, from lowest to highest. This results in a more pleasing effect when\n * zooming past several levels in a large panoramas, but consumes additional\n * bandwidth.\n */\nfunction Stage(opts) {\n  this._progressive = !!(opts && opts.progressive);\n\n  // The list of layers in display order (background to foreground).\n  this._layers = [];\n\n  // The list of renderers; the i-th renderer is for the i-th layer.\n  this._renderers = [];\n\n  // The lists of tiles to load and render, populated during render().\n  this._tilesToLoad = [];\n  this._tilesToRender = [];\n\n  // Temporary tile lists.\n  this._tmpVisible = [];\n  this._tmpChildren = [];\n\n  // Cached stage dimensions.\n  // Start with zero, which inhibits rendering until setSize() is called.\n  this._width = 0;\n  this._height = 0;\n\n  // Temporary variable for rect.\n  this._tmpRect = {};\n\n  // Temporary variable for size.\n  this._tmpSize = {};\n\n  // Work queue for createTexture.\n  this._createTextureWorkQueue = new WorkQueue();\n\n  // Function to emit event when render parameters have changed.\n  this._emitRenderInvalid = this._emitRenderInvalid.bind(this);\n\n  // The renderer registry maps each geometry/view pair into the respective\n  // Renderer class.\n  this._rendererRegistry = new RendererRegistry();\n}\n\neventEmitter(Stage);\n\n\n/**\n * Destructor.\n */\nStage.prototype.destroy = function() {\n  this.removeAllLayers();\n  clearOwnProperties(this);\n};\n\n\n/**\n * Registers a {@link Renderer} for the given {@link Geometry} and {@link View}\n * type.\n *\n * The {@link registerDefaultRenderers} utility function may be used to\n * register all known renderers for a stage type into that stage. Most users\n * will not need to register renderers, as {@link Viewer} does it for them.\n *\n * @param {string} geometryType The geometry type, as given by\n *     {@link Geometry#type}.\n * @param {string} viewType The view type, as given by {@link View#type}.\n * @param {*} Renderer The renderer class.\n */\nStage.prototype.registerRenderer = function(geometryType, viewType, Renderer) {\n  return this._rendererRegistry.set(geometryType, viewType, Renderer);\n};\n\n\n/**\n * Returns the underlying DOM element.\n *\n * Must be overridden by subclasses.\n *\n * @return {Element}\n */\nStage.prototype.domElement = function() {\n  throw new Error('Stage implementation must override domElement');\n};\n\n\n/**\n * Get the stage width.\n * @return {number}\n */\nStage.prototype.width = function() {\n  return this._width;\n};\n\n\n/**\n * Get the stage height.\n * @return {number}\n */\nStage.prototype.height = function() {\n  return this._height;\n};\n\n\n/**\n * Get the stage dimensions. If an argument is supplied, it is filled in with\n * the result and returned. Otherwise, a fresh object is filled in and returned.\n *\n * @param {Size=} size\n */\nStage.prototype.size = function(size) {\n  size = size || {};\n  size.width = this._width;\n  size.height = this._height;\n  return size;\n};\n\n\n/**\n * Set the stage dimensions.\n *\n * This contains the size update logic common to all stage types. Subclasses\n * must define the {@link Stage#setSizeForType} method to perform their own\n * logic.\n *\n * @param {Size} size\n */\nStage.prototype.setSize = function(size) {\n  this._width = size.width;\n  this._height = size.height;\n\n  this.setSizeForType(); // must be defined by subclasses.\n\n  this.emit('resize');\n  this._emitRenderInvalid();\n};\n\n\n/**\n * Call {@link Stage#setSize} instead.\n *\n * This contains the size update logic specific to a stage type. It is called by\n * {@link Stage#setSize} after the base class has been updated to reflect the\n * new size, but before any events are emitted.\n *\n * @param {Size} size\n */\nStage.prototype.setSizeForType = function(size) {\n  throw new Error('Stage implementation must override setSizeForType');\n};\n\n\n/**\n * Loads an {@link Asset} from an image.\n * @param {string} url The image URL.\n * @param {?Rect} rect A {@link Rect} describing a portion of the image, or null\n *     to use the full image.\n * @param {function(?Error, Asset)} done The callback.\n * @return {function()} A function to cancel loading.\n */\nStage.prototype.loadImage = function() {\n  throw new Error('Stage implementation must override loadImage');\n};\n\n\nStage.prototype._emitRenderInvalid = function() {\n  this.emit('renderInvalid');\n};\n\n\n/**\n * Verifies that the layer is valid for this stage, throwing an exception\n * otherwise.\n *\n * @param {Layer} layer\n * @throws {Error} If the layer is not valid for this stage.\n */\nStage.prototype.validateLayer = function(layer) {\n  throw new Error('Stage implementation must override validateLayer');\n};\n\n\n/**\n * Returns a list of all {@link Layer layers} belonging to the stage. The\n * returned list is in display order, background to foreground.\n * @return {Layer[]}\n */\nStage.prototype.listLayers = function() {\n  // Return a copy to prevent unintended mutation by the caller.\n  return [].concat(this._layers);\n};\n\n\n/**\n * Return whether a {@link Layer layer} belongs to the stage.\n * @param {Layer} layer\n * @return {boolean}\n */\nStage.prototype.hasLayer = function(layer) {\n  return this._layers.indexOf(layer) >= 0;\n};\n\n\n/**\n * Adds a {@link Layer layer} into the stage.\n * @param {Layer} layer The layer to add.\n * @param {number|undefined} i The optional position, where 0 ≤ i ≤ n and n is\n *     the current number of layers. The default is n, which inserts at the\n *     top of the display stack.\n * @throws An error if the layer already belongs to the stage or if the position\n *     is invalid.\n */\nStage.prototype.addLayer = function(layer, i) {\n  if (this._layers.indexOf(layer) >= 0) {\n    throw new Error('Layer already in stage');\n  }\n\n  if (i == null) {\n    i = this._layers.length;\n  }\n  if (i < 0 || i > this._layers.length) {\n    throw new Error('Invalid layer position');\n  }\n\n  this.validateLayer(layer); // must be defined by subclasses.\n\n  var geometryType = layer.geometry().type;\n  var viewType = layer.view().type;\n  var rendererClass = this._rendererRegistry.get(geometryType, viewType);\n  if (!rendererClass) {\n    throw new Error('No ' + this.type + ' renderer avaiable for ' +\n        geometryType + ' geometry and ' + viewType + ' view');\n  }\n  var renderer = this.createRenderer(rendererClass);\n\n  this._layers.splice(i, 0, layer);\n  this._renderers.splice(i, 0, renderer);\n\n  // Listeners for render invalid.\n  layer.addEventListener('viewChange', this._emitRenderInvalid);\n  layer.addEventListener('effectsChange', this._emitRenderInvalid);\n  layer.addEventListener('fixedLevelChange', this._emitRenderInvalid);\n  layer.addEventListener('textureStoreChange', this._emitRenderInvalid);\n\n  this._emitRenderInvalid();\n};\n\n\n/**\n * Moves a {@link Layer layer} into a different position in the display stack.\n * @param {Layer} layer The layer to move.\n * @param {number} i The position, where 0 ≤ i ≤ n-1 and n is the current number\n *     of layers.\n * @throws An error if the layer does not belong to the stage or if the position\n *     is invalid.\n */\nStage.prototype.moveLayer = function(layer, i) {\n  var index = this._layers.indexOf(layer);\n  if (index < 0) {\n    throw new Error('No such layer in stage');\n  }\n\n  if (i < 0 || i >= this._layers.length) {\n    throw new Error('Invalid layer position');\n  }\n\n  layer = this._layers.splice(index, 1)[0];\n  var renderer = this._renderers.splice(index, 1)[0];\n\n  this._layers.splice(i, 0, layer);\n  this._renderers.splice(i, 0, renderer);\n\n  this._emitRenderInvalid();\n};\n\n\n/**\n * Removes a {@link Layer} from the stage.\n * @param {Layer} layer The layer to remove.\n * @throws An error if the layer does not belong to the stage.\n */\nStage.prototype.removeLayer = function(layer) {\n  var index = this._layers.indexOf(layer);\n  if (index < 0) {\n    throw new Error('No such layer in stage');\n  }\n\n  var removedLayer = this._layers.splice(index, 1)[0];\n  var renderer = this._renderers.splice(index, 1)[0];\n\n  this.destroyRenderer(renderer);\n\n  removedLayer.removeEventListener('viewChange', this._emitRenderInvalid);\n  removedLayer.removeEventListener('effectsChange', this._emitRenderInvalid);\n  removedLayer.removeEventListener('fixedLevelChange', this._emitRenderInvalid);\n  removedLayer.removeEventListener('textureStoreChange', this._emitRenderInvalid);\n\n  this._emitRenderInvalid();\n};\n\n\n/**\n * Removes all {@link Layer layers} from the stage.\n */\nStage.prototype.removeAllLayers = function() {\n  while (this._layers.length > 0) {\n    this.removeLayer(this._layers[0]);\n  }\n};\n\n\n/**\n * Called before a frame is rendered.\n *\n * Must be overridden by subclasses.\n */\nStage.prototype.startFrame = function() {\n  throw new Error('Stage implementation must override startFrame');\n};\n\n\n/**\n * Called after a frame is rendered.\n *\n * Must be overridden by subclasses.\n */\nStage.prototype.endFrame = function() {\n  throw new Error('Stage implementation must override endFrame');\n};\n\n\n/**\n * Render the current frame. Usually called from a {@link RenderLoop}.\n *\n * This contains the rendering logic common to all stage types. Subclasses\n * define the startFrame() and endFrame() methods to perform their own logic.\n */\nStage.prototype.render = function() {\n  var i, j;\n\n  var tilesToLoad = this._tilesToLoad;\n  var tilesToRender = this._tilesToRender;\n\n  var stableStage = true;\n  var stableLayer;\n\n  // Get the stage dimensions.\n  var width = this._width;\n  var height = this._height;\n\n  var rect = this._tmpRect;\n  var size = this._tmpSize;\n\n  if (width <= 0 || height <= 0) {\n    return;\n  }\n\n  this.startFrame(); // defined by subclasses\n\n  // Signal start of frame to the texture stores.\n  for (i = 0; i < this._layers.length; i++) {\n    this._layers[i].textureStore().startFrame();\n  }\n\n  // Render layers.\n  for (i = 0; i < this._layers.length; i++) {\n    var layer = this._layers[i];\n    var effects = layer.effects();\n    var view = layer.view();\n    var textureStore = layer.textureStore();\n    var renderer = this._renderers[i];\n    var depth = this._layers.length - i;\n    var tile, texture;\n\n    // Convert the rect effect into a normalized rect.\n    // TODO: avoid doing this on every frame.\n    calcRect(width, height, effects && effects.rect, rect);\n\n    if (rect.width <= 0 || rect.height <= 0) {\n      // Skip rendering on a null viewport.\n      continue;\n    }\n\n    // Update the view size.\n    size.width = rect.width * this._width;\n    size.height = rect.height * this._height;\n    view.setSize(size);\n\n    // Signal start of layer to the renderer.\n    renderer.startLayer(layer, rect);\n\n    // We render with both alpha blending and depth testing enabled. Thus, when\n    // rendering a subsequent pixel at the same location than an existing one,\n    // the subsequent pixel gets discarded unless it has smaller depth, and is\n    // otherwise composited with the existing pixel.\n    //\n    // When using fallback tiles to fill a gap in the preferred resolution\n    // level, we prefer higher resolution fallbacks to lower resolution ones.\n    // However, where fallbacks overlap, we want higher resolution ones to\n    // prevail, and we don't want multiple fallbacks to be composited with each\n    // other, as that would produce a bad result when semitransparent textures\n    // are involved.\n    //\n    // In order to achieve this within the constraints of alpha blending and\n    // depth testing, the depth of a tile must be inversely proportional to its\n    // resolution, and higher-resolution tiles must be rendered before lower-\n    // resolution ones.\n\n    // Collect the lists of tiles to load and render.\n    stableLayer = this._collectTiles(layer, textureStore);\n\n    // Mark all the tiles whose textures must be loaded.\n    // This will either trigger loading (for textures not yet loaded) or\n    // prevent unloading (for textures already loaded).\n    for (j = 0; j < tilesToLoad.length; j++) {\n      tile = tilesToLoad[j];\n      textureStore.markTile(tile);\n    }\n\n    // Render tiles.\n    for (j = 0; j < tilesToRender.length; j++) {\n      tile = tilesToRender[j];\n      texture = textureStore.texture(tile);\n      renderer.renderTile(tile, texture, layer, depth);\n    }\n\n    layer.emit('renderComplete', stableLayer);\n    if (!stableLayer) {\n      stableStage = false;\n    }\n\n    // Signal end of layer to the renderer.\n    renderer.endLayer(layer, rect);\n  }\n\n  // Signal end of frame to the texture stores.\n  for (i = 0; i < this._layers.length; i++) {\n    this._layers[i].textureStore().endFrame();\n  }\n\n  this.endFrame(); // defined by subclasses\n\n  this.emit('renderComplete', stableStage);\n};\n\nStage.prototype._collectTiles = function(layer, textureStore) {\n  var tilesToLoad = this._tilesToLoad;\n  var tilesToRender = this._tilesToRender;\n  var tmpVisible = this._tmpVisible;\n\n  tilesToLoad.length = 0;\n  tilesToRender.length = 0;\n  tmpVisible.length = 0;\n\n  layer.visibleTiles(tmpVisible);\n\n  var isStable = true;\n\n  for (var i = 0; i < tmpVisible.length; i++) {\n    var tile = tmpVisible[i];\n    var needsFallback;\n    this._collectTileToLoad(tile);\n    if (textureStore.texture(tile)) {\n      // The preferred texture is available.\n      // No fallback is required.\n      needsFallback = false;\n      this._collectTileToRender(tile);\n    } else {\n      // The preferred texture is unavailable.\n      // Collect children for rendering as a fallback.\n      needsFallback = this._collectChildren(tile, textureStore);\n      isStable = false;\n    }\n    // Collect all parents for loading, and the closest parent for rendering if\n    // a fallback is required.\n    this._collectParents(tile, textureStore, needsFallback);\n  }\n\n  // Sort tiles to load in ascending resolution order.\n  tilesToLoad.sort(forwardTileCmp);\n\n  // Sort tiles to render in descending resolution order.\n  tilesToRender.sort(reverseTileCmp);\n\n  return isStable;\n};\n\nStage.prototype._collectChildren = function(tile, textureStore) {\n  var tmpChildren = this._tmpChildren;\n\n  var needsFallback = true;\n\n  // Fall back as many levels as necessary on single-child geometries, but do\n  // not go beyond immediate children on multiple-child geometries, to avoid\n  // exploring an exponential number of tiles.\n  do {\n    tmpChildren.length = 0;\n    if (!tile.children(tmpChildren)) {\n      break;\n    }\n    needsFallback = false;\n    for (var i = 0; i < tmpChildren.length; i++) {\n      tile = tmpChildren[i];\n      if (textureStore.texture(tile)) {\n        this._collectTileToLoad(tile);\n        this._collectTileToRender(tile);\n      } else {\n        needsFallback = true;\n      }\n    }\n  } while (needsFallback && tmpChildren.length === 1)\n\n  return needsFallback;\n};\n\nStage.prototype._collectParents = function(tile, textureStore, needsFallback) {\n  // Recursively visit parent tiles until:\n  //   - all parents have been marked for loading, if progressive rendering is\n  //     enabled; and\n  //   - at least one parent has been marked for both loading and rendering, if\n  //     a fallback is required.\n  var needsLoading = this._progressive;\n  while ((needsLoading || needsFallback) && (tile = tile.parent()) != null) {\n    if (needsFallback) {\n      if (textureStore.texture(tile)) {\n        this._collectTileToRender(tile);\n        needsFallback = false;\n      } else if (!this._progressive) {\n        continue;\n      }\n    }\n    if (!this._collectTileToLoad(tile)) {\n      needsLoading = false;\n    }\n  }\n  return needsFallback;\n};\n\nStage.prototype._collectTileToLoad = function(tile) {\n  return this._collectTileIntoList(tile, this._tilesToLoad);\n};\n\nStage.prototype._collectTileToRender = function(tile) {\n  return this._collectTileIntoList(tile, this._tilesToRender);\n};\n\nStage.prototype._collectTileIntoList = function(tile, tileList) {\n  // TODO: Investigate whether it's worth it to make this better than O(n²).\n  var found = false;\n  for (var i = 0; i < tileList.length; i++) {\n    if (tile.equals(tileList[i])) {\n      found = true;\n      break;\n    }\n  }\n  if (!found) {\n    tileList.push(tile);\n  }\n  return !found;\n};\n\n/**\n * Create a texture for the given tile and asset. Called by {@link TextureStore}.\n * @param {Tile} tile\n * @param {Asset} asset\n * @param {Function} done\n */\nStage.prototype.createTexture = function(tile, asset, done) {\n\n  var self = this;\n\n  function makeTexture() {\n    return new self.TextureClass(self, tile, asset);\n  }\n\n  var fn = cancelize(async(makeTexture));\n\n  return this._createTextureWorkQueue.push(fn, function(err, texture) {\n    done(err, tile, asset, texture);\n  });\n\n};\n\n/**\n * The stage type, used to determine the appropriate renderer for a given\n * geometry and view.\n *\n * The sole known value is `\"webgl\".\n *\n * See also {@link Stage#registerRenderer}.\n *\n * @property {string}\n * @name Stage#type\n */\n\nmodule.exports = Stage;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// The global object.\nvar globalObject = (function() {\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return null;\n})();\n\nmodule.exports = globalObject;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar global = require('../util/global');\nvar eventEmitter = require('minimal-event-emitter');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar propertyMap = {\n  HTMLImageElement: ['naturalWidth', 'naturalHeight'],\n  HTMLCanvasElement: ['width', 'height'],\n  ImageBitmap: ['width', 'height']\n};\n\n/**\n * @class StaticAsset\n * @implements Asset\n * @classdesc\n *\n * An {@link Asset} whose pixel contents never change.\n *\n * @param {HTMLImageElement|HTMLCanvasElement|ImageBitmap} element The\n *     underlying pixel source.\n * @throws If the pixel source is unsupported.\n */\nfunction StaticAsset(element) {\n  var supported = false;\n  for (var type in propertyMap) {\n    if (global[type] && element instanceof global[type]) {\n      supported = true;\n      this._widthProp = propertyMap[type][0];\n      this._heightProp = propertyMap[type][1];\n      break;\n    }\n  }\n  if (!supported) {\n    throw new Error('Unsupported pixel source');\n  }\n\n  this._element = element;\n}\n\neventEmitter(StaticAsset);\n\n/**\n * Destructor.\n */\nStaticAsset.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\nStaticAsset.prototype.element = function() {\n  return this._element;\n};\n\nStaticAsset.prototype.width = function() {\n  return this._element[this._widthProp];\n};\n\nStaticAsset.prototype.height = function() {\n  return this._element[this._heightProp];\n};\n\nStaticAsset.prototype.timestamp = function() {\n  return 0;\n};\n\nStaticAsset.prototype.isDynamic = function() {\n  return false;\n};\n\nmodule.exports = StaticAsset;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Make ctor a subclass of superCtor.\n// Do not depend on ES5 Object.create semantics because of older browsers.\nfunction inherits(ctor, superCtor) {\n  ctor.super_ = superCtor;\n  var TempCtor = function() {};\n  TempCtor.prototype = superCtor.prototype;\n  ctor.prototype = new TempCtor();\n  ctor.prototype.constructor = ctor;\n}\n\nmodule.exports = inherits;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar inherits = require('./util/inherits');\n\n/**\n * @class NetworkError\n * @extends {Error}\n * @classdesc\n *\n * Signals an error that occurred while fetching a URL. This is used by\n * {@link Loader loaders} to distinguish network failures from other errors.\n */\nfunction NetworkError(message) {\n  // See: https://stackoverflow.com/questions/1382107/whats-a-good-way-to-extend-error-in-javascript\n  this.constructor.super_.apply(this, arguments);\n  this.message = message;\n}\n\ninherits(NetworkError, Error);\n\nmodule.exports = NetworkError;\n", "/*!\n * Bowser - a browser detector\n * https://github.com/ded/bowser\n * MIT License | (c) Dustin Diaz 2015\n */\n\n!function (root, name, definition) {\n  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n  else if (typeof define == 'function' && define.amd) define(name, definition)\n  else root[name] = definition()\n}(this, 'bowser', function () {\n  /**\n    * See useragents.js for examples of navigator.userAgent\n    */\n\n  var t = true\n\n  function detect(ua) {\n\n    function getFirstMatch(regex) {\n      var match = ua.match(regex);\n      return (match && match.length > 1 && match[1]) || '';\n    }\n\n    function getSecondMatch(regex) {\n      var match = ua.match(regex);\n      return (match && match.length > 1 && match[2]) || '';\n    }\n\n    var iosdevice = getFirstMatch(/(ipod|iphone|ipad)/i).toLowerCase()\n      , likeAndroid = /like android/i.test(ua)\n      , android = !likeAndroid && /android/i.test(ua)\n      , nexusMobile = /nexus\\s*[0-6]\\s*/i.test(ua)\n      , nexusTablet = !nexusMobile && /nexus\\s*[0-9]+/i.test(ua)\n      , chromeos = /CrOS/.test(ua)\n      , silk = /silk/i.test(ua)\n      , sailfish = /sailfish/i.test(ua)\n      , tizen = /tizen/i.test(ua)\n      , webos = /(web|hpw)(o|0)s/i.test(ua)\n      , windowsphone = /windows phone/i.test(ua)\n      , samsungBrowser = /SamsungBrowser/i.test(ua)\n      , windows = !windowsphone && /windows/i.test(ua)\n      , mac = !iosdevice && !silk && /macintosh/i.test(ua)\n      , linux = !android && !sailfish && !tizen && !webos && /linux/i.test(ua)\n      , edgeVersion = getSecondMatch(/edg([ea]|ios)\\/(\\d+(\\.\\d+)?)/i)\n      , versionIdentifier = getFirstMatch(/version\\/(\\d+(\\.\\d+)?)/i)\n      , tablet = /tablet/i.test(ua) && !/tablet pc/i.test(ua)\n      , mobile = !tablet && /[^-]mobi/i.test(ua)\n      , xbox = /xbox/i.test(ua)\n      , result\n\n    if (/opera/i.test(ua)) {\n      //  an old Opera\n      result = {\n        name: 'Opera'\n      , opera: t\n      , version: versionIdentifier || getFirstMatch(/(?:opera|opr|opios)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    } else if (/opr\\/|opios/i.test(ua)) {\n      // a new Opera\n      result = {\n        name: 'Opera'\n        , opera: t\n        , version: getFirstMatch(/(?:opr|opios)[\\s\\/](\\d+(\\.\\d+)?)/i) || versionIdentifier\n      }\n    }\n    else if (/SamsungBrowser/i.test(ua)) {\n      result = {\n        name: 'Samsung Internet for Android'\n        , samsungBrowser: t\n        , version: versionIdentifier || getFirstMatch(/(?:SamsungBrowser)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/Whale/i.test(ua)) {\n      result = {\n        name: 'NAVER Whale browser'\n        , whale: t\n        , version: getFirstMatch(/(?:whale)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/MZBrowser/i.test(ua)) {\n      result = {\n        name: 'MZ Browser'\n        , mzbrowser: t\n        , version: getFirstMatch(/(?:MZBrowser)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/coast/i.test(ua)) {\n      result = {\n        name: 'Opera Coast'\n        , coast: t\n        , version: versionIdentifier || getFirstMatch(/(?:coast)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/focus/i.test(ua)) {\n      result = {\n        name: 'Focus'\n        , focus: t\n        , version: getFirstMatch(/(?:focus)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/yabrowser/i.test(ua)) {\n      result = {\n        name: 'Yandex Browser'\n      , yandexbrowser: t\n      , version: versionIdentifier || getFirstMatch(/(?:yabrowser)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/ucbrowser/i.test(ua)) {\n      result = {\n          name: 'UC Browser'\n        , ucbrowser: t\n        , version: getFirstMatch(/(?:ucbrowser)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/mxios/i.test(ua)) {\n      result = {\n        name: 'Maxthon'\n        , maxthon: t\n        , version: getFirstMatch(/(?:mxios)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/epiphany/i.test(ua)) {\n      result = {\n        name: 'Epiphany'\n        , epiphany: t\n        , version: getFirstMatch(/(?:epiphany)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/puffin/i.test(ua)) {\n      result = {\n        name: 'Puffin'\n        , puffin: t\n        , version: getFirstMatch(/(?:puffin)[\\s\\/](\\d+(?:\\.\\d+)?)/i)\n      }\n    }\n    else if (/sleipnir/i.test(ua)) {\n      result = {\n        name: 'Sleipnir'\n        , sleipnir: t\n        , version: getFirstMatch(/(?:sleipnir)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/k-meleon/i.test(ua)) {\n      result = {\n        name: 'K-Meleon'\n        , kMeleon: t\n        , version: getFirstMatch(/(?:k-meleon)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (windowsphone) {\n      result = {\n        name: 'Windows Phone'\n      , osname: 'Windows Phone'\n      , windowsphone: t\n      }\n      if (edgeVersion) {\n        result.msedge = t\n        result.version = edgeVersion\n      }\n      else {\n        result.msie = t\n        result.version = getFirstMatch(/iemobile\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/msie|trident/i.test(ua)) {\n      result = {\n        name: 'Internet Explorer'\n      , msie: t\n      , version: getFirstMatch(/(?:msie |rv:)(\\d+(\\.\\d+)?)/i)\n      }\n    } else if (chromeos) {\n      result = {\n        name: 'Chrome'\n      , osname: 'Chrome OS'\n      , chromeos: t\n      , chromeBook: t\n      , chrome: t\n      , version: getFirstMatch(/(?:chrome|crios|crmo)\\/(\\d+(\\.\\d+)?)/i)\n      }\n    } else if (/edg([ea]|ios)/i.test(ua)) {\n      result = {\n        name: 'Microsoft Edge'\n      , msedge: t\n      , version: edgeVersion\n      }\n    }\n    else if (/vivaldi/i.test(ua)) {\n      result = {\n        name: 'Vivaldi'\n        , vivaldi: t\n        , version: getFirstMatch(/vivaldi\\/(\\d+(\\.\\d+)?)/i) || versionIdentifier\n      }\n    }\n    else if (sailfish) {\n      result = {\n        name: 'Sailfish'\n      , osname: 'Sailfish OS'\n      , sailfish: t\n      , version: getFirstMatch(/sailfish\\s?browser\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/seamonkey\\//i.test(ua)) {\n      result = {\n        name: 'SeaMonkey'\n      , seamonkey: t\n      , version: getFirstMatch(/seamonkey\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/firefox|iceweasel|fxios/i.test(ua)) {\n      result = {\n        name: 'Firefox'\n      , firefox: t\n      , version: getFirstMatch(/(?:firefox|iceweasel|fxios)[ \\/](\\d+(\\.\\d+)?)/i)\n      }\n      if (/\\((mobile|tablet);[^\\)]*rv:[\\d\\.]+\\)/i.test(ua)) {\n        result.firefoxos = t\n        result.osname = 'Firefox OS'\n      }\n    }\n    else if (silk) {\n      result =  {\n        name: 'Amazon Silk'\n      , silk: t\n      , version : getFirstMatch(/silk\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/phantom/i.test(ua)) {\n      result = {\n        name: 'PhantomJS'\n      , phantom: t\n      , version: getFirstMatch(/phantomjs\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/slimerjs/i.test(ua)) {\n      result = {\n        name: 'SlimerJS'\n        , slimer: t\n        , version: getFirstMatch(/slimerjs\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/blackberry|\\bbb\\d+/i.test(ua) || /rim\\stablet/i.test(ua)) {\n      result = {\n        name: 'BlackBerry'\n      , osname: 'BlackBerry OS'\n      , blackberry: t\n      , version: versionIdentifier || getFirstMatch(/blackberry[\\d]+\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (webos) {\n      result = {\n        name: 'WebOS'\n      , osname: 'WebOS'\n      , webos: t\n      , version: versionIdentifier || getFirstMatch(/w(?:eb)?osbrowser\\/(\\d+(\\.\\d+)?)/i)\n      };\n      /touchpad\\//i.test(ua) && (result.touchpad = t)\n    }\n    else if (/bada/i.test(ua)) {\n      result = {\n        name: 'Bada'\n      , osname: 'Bada'\n      , bada: t\n      , version: getFirstMatch(/dolfin\\/(\\d+(\\.\\d+)?)/i)\n      };\n    }\n    else if (tizen) {\n      result = {\n        name: 'Tizen'\n      , osname: 'Tizen'\n      , tizen: t\n      , version: getFirstMatch(/(?:tizen\\s?)?browser\\/(\\d+(\\.\\d+)?)/i) || versionIdentifier\n      };\n    }\n    else if (/qupzilla/i.test(ua)) {\n      result = {\n        name: 'QupZilla'\n        , qupzilla: t\n        , version: getFirstMatch(/(?:qupzilla)[\\s\\/](\\d+(?:\\.\\d+)+)/i) || versionIdentifier\n      }\n    }\n    else if (/chromium/i.test(ua)) {\n      result = {\n        name: 'Chromium'\n        , chromium: t\n        , version: getFirstMatch(/(?:chromium)[\\s\\/](\\d+(?:\\.\\d+)?)/i) || versionIdentifier\n      }\n    }\n    else if (/chrome|crios|crmo/i.test(ua)) {\n      result = {\n        name: 'Chrome'\n        , chrome: t\n        , version: getFirstMatch(/(?:chrome|crios|crmo)\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (android) {\n      result = {\n        name: 'Android'\n        , version: versionIdentifier\n      }\n    }\n    else if (/safari|applewebkit/i.test(ua)) {\n      result = {\n        name: 'Safari'\n      , safari: t\n      }\n      if (versionIdentifier) {\n        result.version = versionIdentifier\n      }\n    }\n    else if (iosdevice) {\n      result = {\n        name : iosdevice == 'iphone' ? 'iPhone' : iosdevice == 'ipad' ? 'iPad' : 'iPod'\n      }\n      // WTF: version is not part of user agent in web apps\n      if (versionIdentifier) {\n        result.version = versionIdentifier\n      }\n    }\n    else if(/googlebot/i.test(ua)) {\n      result = {\n        name: 'Googlebot'\n      , googlebot: t\n      , version: getFirstMatch(/googlebot\\/(\\d+(\\.\\d+))/i) || versionIdentifier\n      }\n    }\n    else {\n      result = {\n        name: getFirstMatch(/^(.*)\\/(.*) /),\n        version: getSecondMatch(/^(.*)\\/(.*) /)\n     };\n   }\n\n    // set webkit or gecko flag for browsers based on these engines\n    if (!result.msedge && /(apple)?webkit/i.test(ua)) {\n      if (/(apple)?webkit\\/537\\.36/i.test(ua)) {\n        result.name = result.name || \"Blink\"\n        result.blink = t\n      } else {\n        result.name = result.name || \"Webkit\"\n        result.webkit = t\n      }\n      if (!result.version && versionIdentifier) {\n        result.version = versionIdentifier\n      }\n    } else if (!result.opera && /gecko\\//i.test(ua)) {\n      result.name = result.name || \"Gecko\"\n      result.gecko = t\n      result.version = result.version || getFirstMatch(/gecko\\/(\\d+(\\.\\d+)?)/i)\n    }\n\n    // set OS flags for platforms that have multiple browsers\n    if (!result.windowsphone && (android || result.silk)) {\n      result.android = t\n      result.osname = 'Android'\n    } else if (!result.windowsphone && iosdevice) {\n      result[iosdevice] = t\n      result.ios = t\n      result.osname = 'iOS'\n    } else if (mac) {\n      result.mac = t\n      result.osname = 'macOS'\n    } else if (xbox) {\n      result.xbox = t\n      result.osname = 'Xbox'\n    } else if (windows) {\n      result.windows = t\n      result.osname = 'Windows'\n    } else if (linux) {\n      result.linux = t\n      result.osname = 'Linux'\n    }\n\n    function getWindowsVersion (s) {\n      switch (s) {\n        case 'NT': return 'NT'\n        case 'XP': return 'XP'\n        case 'NT 5.0': return '2000'\n        case 'NT 5.1': return 'XP'\n        case 'NT 5.2': return '2003'\n        case 'NT 6.0': return 'Vista'\n        case 'NT 6.1': return '7'\n        case 'NT 6.2': return '8'\n        case 'NT 6.3': return '8.1'\n        case 'NT 10.0': return '10'\n        default: return undefined\n      }\n    }\n\n    // OS version extraction\n    var osVersion = '';\n    if (result.windows) {\n      osVersion = getWindowsVersion(getFirstMatch(/Windows ((NT|XP)( \\d\\d?.\\d)?)/i))\n    } else if (result.windowsphone) {\n      osVersion = getFirstMatch(/windows phone (?:os)?\\s?(\\d+(\\.\\d+)*)/i);\n    } else if (result.mac) {\n      osVersion = getFirstMatch(/Mac OS X (\\d+([_\\.\\s]\\d+)*)/i);\n      osVersion = osVersion.replace(/[_\\s]/g, '.');\n    } else if (iosdevice) {\n      osVersion = getFirstMatch(/os (\\d+([_\\s]\\d+)*) like mac os x/i);\n      osVersion = osVersion.replace(/[_\\s]/g, '.');\n    } else if (android) {\n      osVersion = getFirstMatch(/android[ \\/-](\\d+(\\.\\d+)*)/i);\n    } else if (result.webos) {\n      osVersion = getFirstMatch(/(?:web|hpw)os\\/(\\d+(\\.\\d+)*)/i);\n    } else if (result.blackberry) {\n      osVersion = getFirstMatch(/rim\\stablet\\sos\\s(\\d+(\\.\\d+)*)/i);\n    } else if (result.bada) {\n      osVersion = getFirstMatch(/bada\\/(\\d+(\\.\\d+)*)/i);\n    } else if (result.tizen) {\n      osVersion = getFirstMatch(/tizen[\\/\\s](\\d+(\\.\\d+)*)/i);\n    }\n    if (osVersion) {\n      result.osversion = osVersion;\n    }\n\n    // device type extraction\n    var osMajorVersion = !result.windows && osVersion.split('.')[0];\n    if (\n         tablet\n      || nexusTablet\n      || iosdevice == 'ipad'\n      || (android && (osMajorVersion == 3 || (osMajorVersion >= 4 && !mobile)))\n      || result.silk\n    ) {\n      result.tablet = t\n    } else if (\n         mobile\n      || iosdevice == 'iphone'\n      || iosdevice == 'ipod'\n      || android\n      || nexusMobile\n      || result.blackberry\n      || result.webos\n      || result.bada\n    ) {\n      result.mobile = t\n    }\n\n    // Graded Browser Support\n    // http://developer.yahoo.com/yui/articles/gbs\n    if (result.msedge ||\n        (result.msie && result.version >= 10) ||\n        (result.yandexbrowser && result.version >= 15) ||\n\t\t    (result.vivaldi && result.version >= 1.0) ||\n        (result.chrome && result.version >= 20) ||\n        (result.samsungBrowser && result.version >= 4) ||\n        (result.whale && compareVersions([result.version, '1.0']) === 1) ||\n        (result.mzbrowser && compareVersions([result.version, '6.0']) === 1) ||\n        (result.focus && compareVersions([result.version, '1.0']) === 1) ||\n        (result.firefox && result.version >= 20.0) ||\n        (result.safari && result.version >= 6) ||\n        (result.opera && result.version >= 10.0) ||\n        (result.ios && result.osversion && result.osversion.split(\".\")[0] >= 6) ||\n        (result.blackberry && result.version >= 10.1)\n        || (result.chromium && result.version >= 20)\n        ) {\n      result.a = t;\n    }\n    else if ((result.msie && result.version < 10) ||\n        (result.chrome && result.version < 20) ||\n        (result.firefox && result.version < 20.0) ||\n        (result.safari && result.version < 6) ||\n        (result.opera && result.version < 10.0) ||\n        (result.ios && result.osversion && result.osversion.split(\".\")[0] < 6)\n        || (result.chromium && result.version < 20)\n        ) {\n      result.c = t\n    } else result.x = t\n\n    return result\n  }\n\n  var bowser = detect(typeof navigator !== 'undefined' ? navigator.userAgent || '' : '')\n\n  bowser.test = function (browserList) {\n    for (var i = 0; i < browserList.length; ++i) {\n      var browserItem = browserList[i];\n      if (typeof browserItem=== 'string') {\n        if (browserItem in bowser) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Get version precisions count\n   *\n   * @example\n   *   getVersionPrecision(\"1.10.3\") // 3\n   *\n   * @param  {string} version\n   * @return {number}\n   */\n  function getVersionPrecision(version) {\n    return version.split(\".\").length;\n  }\n\n  /**\n   * Array::map polyfill\n   *\n   * @param  {Array} arr\n   * @param  {Function} iterator\n   * @return {Array}\n   */\n  function map(arr, iterator) {\n    var result = [], i;\n    if (Array.prototype.map) {\n      return Array.prototype.map.call(arr, iterator);\n    }\n    for (i = 0; i < arr.length; i++) {\n      result.push(iterator(arr[i]));\n    }\n    return result;\n  }\n\n  /**\n   * Calculate browser version weight\n   *\n   * @example\n   *   compareVersions(['1.10.2.1',  '1.8.2.1.90'])    // 1\n   *   compareVersions(['1.010.2.1', '1.09.2.1.90']);  // 1\n   *   compareVersions(['1.10.2.1',  '1.10.2.1']);     // 0\n   *   compareVersions(['1.10.2.1',  '1.0800.2']);     // -1\n   *\n   * @param  {Array<String>} versions versions to compare\n   * @return {Number} comparison result\n   */\n  function compareVersions(versions) {\n    // 1) get common precision for both versions, for example for \"10.0\" and \"9\" it should be 2\n    var precision = Math.max(getVersionPrecision(versions[0]), getVersionPrecision(versions[1]));\n    var chunks = map(versions, function (version) {\n      var delta = precision - getVersionPrecision(version);\n\n      // 2) \"9\" -> \"9.0\" (for precision = 2)\n      version = version + new Array(delta + 1).join(\".0\");\n\n      // 3) \"9.0\" -> [\"000000000\"\", \"000000009\"]\n      return map(version.split(\".\"), function (chunk) {\n        return new Array(20 - chunk.length).join(\"0\") + chunk;\n      }).reverse();\n    });\n\n    // iterate in reverse order by reversed chunks array\n    while (--precision >= 0) {\n      // 4) compare: \"000000009\" > \"000000010\" = false (but \"9\" > \"10\" = true)\n      if (chunks[0][precision] > chunks[1][precision]) {\n        return 1;\n      }\n      else if (chunks[0][precision] === chunks[1][precision]) {\n        if (precision === 0) {\n          // all version chunks are same\n          return 0;\n        }\n      }\n      else {\n        return -1;\n      }\n    }\n  }\n\n  /**\n   * Check if browser is unsupported\n   *\n   * @example\n   *   bowser.isUnsupportedBrowser({\n   *     msie: \"10\",\n   *     firefox: \"23\",\n   *     chrome: \"29\",\n   *     safari: \"5.1\",\n   *     opera: \"16\",\n   *     phantom: \"534\"\n   *   });\n   *\n   * @param  {Object}  minVersions map of minimal version to browser\n   * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map\n   * @param  {String}  [ua] user agent string\n   * @return {Boolean}\n   */\n  function isUnsupportedBrowser(minVersions, strictMode, ua) {\n    var _bowser = bowser;\n\n    // make strictMode param optional with ua param usage\n    if (typeof strictMode === 'string') {\n      ua = strictMode;\n      strictMode = void(0);\n    }\n\n    if (strictMode === void(0)) {\n      strictMode = false;\n    }\n    if (ua) {\n      _bowser = detect(ua);\n    }\n\n    var version = \"\" + _bowser.version;\n    for (var browser in minVersions) {\n      if (minVersions.hasOwnProperty(browser)) {\n        if (_bowser[browser]) {\n          if (typeof minVersions[browser] !== 'string') {\n            throw new Error('Browser version in the minVersion map should be a string: ' + browser + ': ' + String(minVersions));\n          }\n\n          // browser version and min supported version.\n          return compareVersions([version, minVersions[browser]]) < 0;\n        }\n      }\n    }\n\n    return strictMode; // not found\n  }\n\n  /**\n   * Check if browser is supported\n   *\n   * @param  {Object} minVersions map of minimal version to browser\n   * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map\n   * @param  {String}  [ua] user agent string\n   * @return {Boolean}\n   */\n  function check(minVersions, strictMode, ua) {\n    return !isUnsupportedBrowser(minVersions, strictMode, ua);\n  }\n\n  bowser.isUnsupportedBrowser = isUnsupportedBrowser;\n  bowser.compareVersions = compareVersions;\n  bowser.check = check;\n\n  /*\n   * Set our detect method to the main bowser object so we can\n   * reuse it to test other user agents.\n   * This is needed to implement future tests.\n   */\n  bowser._detect = detect;\n\n  /*\n   * Set our detect public method to the main bowser object\n   * This is needed to implement bowser in server side\n   */\n  bowser.detect = detect;\n  return bowser\n});\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar StaticAsset = require('../assets/Static');\nvar NetworkError = require('../NetworkError');\nvar browser = require('bowser');\nvar global = require('../util/global');\nvar once = require('../util/once');\n\n// TODO: Move the load queue into the loader.\n\n// Whether to use createImageBitmap instead of a canvas for cropping.\n// See https://caniuse.com/?search=createimagebitmap\nvar useCreateImageBitmap = !!global.createImageBitmap && !browser.firefox;\n\n// Options for createImageBitmap.\nvar createImageBitmapOpts = {\n  imageOrientation: 'flipY',\n  premultiplyAlpha: 'premultiply'\n};\n\n/**\n * @class HtmlImageLoader\n * @implements ImageLoader\n * @classdesc\n *\n * A {@link Loader} for HTML images.\n *\n * @param {Stage} stage The stage which is going to request images to be loaded.\n */\nfunction HtmlImageLoader(stage) {\n  this._stage = stage;\n}\n\n/**\n * Loads an {@link Asset} from an image.\n * @param {string} url The image URL.\n * @param {?Rect} rect A {@link Rect} describing a portion of the image, or null\n *     to use the full image.\n * @param {function(?Error, Asset)} done The callback.\n * @return {function()} A function to cancel loading.\n */\nHtmlImageLoader.prototype.loadImage = function(url, rect, done) {\n  var self = this;\n\n  var img = new Image();\n\n  // Allow cross-domain image loading.\n  // This is required to be able to create WebGL textures from images fetched\n  // from a different domain. Note that setting the crossorigin attribute to\n  // 'anonymous' will trigger a CORS preflight for cross-domain requests, but no\n  // credentials (cookies or HTTP auth) will be sent; to do so, the attribute\n  // would have to be set to 'use-credentials' instead. Unfortunately, this is\n  // not a safe choice, as it causes requests to fail when the response contains\n  // an Access-Control-Allow-Origin header with a wildcard. See the section\n  // \"Credentialed requests and wildcards\" on:\n  // https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\n  img.crossOrigin = 'anonymous';\n\n  var x = rect && rect.x || 0;\n  var y = rect && rect.y || 0;\n  var width = rect && rect.width || 1;\n  var height = rect && rect.height || 1;\n\n  done = once(done);\n\n  img.onload = function() {\n    self._handleLoad(img, x, y, width, height, done);\n  };\n\n  img.onerror = function() {\n    self._handleError(url, done);\n  };\n\n  img.src = url;\n\n  function cancel() {\n    img.onload = img.onerror = null;\n    img.src = '';\n    done.apply(null, arguments);\n  }\n\n  return cancel;\n};\n\nHtmlImageLoader.prototype._handleLoad = function(img, x, y, width, height, done) {\n  if (x === 0 && y === 0 && width === 1 && height === 1) {\n    // Fast path for when cropping is not needed.\n    done(null, new StaticAsset(img));\n    return;\n  }\n\n  x *= img.naturalWidth;\n  y *= img.naturalHeight;\n  width *= img.naturalWidth;\n  height *= img.naturalHeight;\n\n  if (useCreateImageBitmap) {\n    // Prefer to crop using createImageBitmap, which can potentially offload\n    // work to another thread and avoid blocking the user interface.\n    // Assume that the promise is never rejected.\n    global.createImageBitmap(img, x, y, width, height, createImageBitmapOpts)\n      .then(function(bitmap) {\n        done(null, new StaticAsset(bitmap));\n      });\n  } else {\n    // Fall back to cropping using a canvas, which can potentially block the\n    // user interface, but is the best we can do.\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    var context = canvas.getContext('2d');\n    context.drawImage(img, x, y, width, height, 0, 0, width, height);\n    done(null, new StaticAsset(canvas));\n  }\n};\n\nHtmlImageLoader.prototype._handleError = function(url, done) {\n  // TODO: is there any way to distinguish a network error from other\n  // kinds of errors? For now we always return NetworkError since this\n  // prevents images to be retried continuously while we are offline.\n  done(new NetworkError('Network error: ' + url));\n};\n\nmodule.exports = HtmlImageLoader;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar defaultPixelRatio = 1;\n\nfunction pixelRatio() {\n  if (typeof window !== 'undefined') {\n    if (window.devicePixelRatio) {\n      return window.devicePixelRatio;\n    }\n    else {\n      var screen = window.screen;\n      if (screen && screen.deviceXDPI && screen.logicalXDPI) {\n        return screen.deviceXDPI / screen.logicalXDPI;\n      } else if (screen && screen.systemXDPI && screen.logicalXDPI) {\n        return screen.systemXDPI / screen.logicalXDPI;\n      }\n    }\n  }\n  return defaultPixelRatio;\n}\n\nmodule.exports = pixelRatio;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Returns whether n is a power of two.\nfunction ispot(n) {\n  return (n & (n - 1)) == 0;\n}\n\nmodule.exports = ispot;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n\nfunction prefixProperty(property) {\n\n  var style = document.documentElement.style;\n  var prefixList = ['Moz', 'Webkit', 'Khtml', 'O', 'ms'];\n\n  for (var i = 0; i < prefixList.length; i++) {\n    var prefix = prefixList[i];\n    var capitalizedProperty = property[0].toUpperCase() + property.slice(1);\n    var prefixedProperty = prefix + capitalizedProperty;\n\n    if (prefixedProperty in style) {\n      return prefixedProperty;\n    }\n  }\n\n  return property;\n\n}\n\n\nfunction getWithVendorPrefix(property) {\n  var prefixedProperty = prefixProperty(property);\n  return function getPropertyWithVendorPrefix(element) {\n    return element.style[prefixedProperty];\n  };\n\n}\n\n\nfunction setWithVendorPrefix(property) {\n  var prefixedProperty = prefixProperty(property);\n  return function setPropertyWithVendorPrefix(element, val) {\n    return (element.style[prefixedProperty] = val);\n  };\n}\n\n\nvar setTransform = setWithVendorPrefix('transform');\nvar setTransformOrigin = setWithVendorPrefix('transformOrigin');\n\n\nfunction setNullTransform(element) {\n  setTransform(element, 'translateZ(0)');\n}\n\n\nfunction setNullTransformOrigin(element) {\n  setTransformOrigin(element, '0 0 0');\n}\n\n\nfunction setAbsolute(element) {\n  element.style.position = 'absolute';\n}\n\n\nfunction setPixelPosition(element, x, y) {\n  element.style.left = x + 'px';\n  element.style.top = y + 'px';\n}\n\n\nfunction setPixelSize(element, width, height) {\n  element.style.width = width + 'px';\n  element.style.height = height + 'px';\n}\n\n\nfunction setNullSize(element) {\n  element.style.width = element.style.height = 0;\n}\n\n\nfunction setFullSize(element) {\n  element.style.width = element.style.height = '100%';\n}\n\n\nfunction setOverflowHidden(element) {\n  element.style.overflow = 'hidden';\n}\n\n\nfunction setOverflowVisible(element) {\n  element.style.overflow = 'visible';\n}\n\n\nfunction setNoPointerEvents(element) {\n  element.style.pointerEvents = 'none';\n}\n\n\nmodule.exports = {\n  prefixProperty: prefixProperty,\n  getWithVendorPrefix: getWithVendorPrefix,\n  setWithVendorPrefix: setWithVendorPrefix,\n  setTransform: setTransform,\n  setTransformOrigin: setTransformOrigin,\n  setNullTransform: setNullTransform,\n  setNullTransformOrigin: setNullTransformOrigin,\n  setAbsolute: setAbsolute,\n  setPixelPosition: setPixelPosition,\n  setPixelSize: setPixelSize,\n  setNullSize: setNullSize,\n  setFullSize: setFullSize,\n  setOverflowHidden: setOverflowHidden,\n  setOverflowVisible: setOverflowVisible,\n  setNoPointerEvents: setNoPointerEvents\n};\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Stage = require('./Stage');\nvar HtmlImageLoader = require('../loaders/HtmlImage');\nvar browser = require('bowser');\nvar inherits = require('../util/inherits');\nvar pixelRatio = require('../util/pixelRatio');\nvar ispot = require('../util/ispot');\nvar setAbsolute = require('../util/dom').setAbsolute;\nvar setFullSize = require('../util/dom').setFullSize;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n// TODO(tjgq): Unify Stage and WebGlStage.\n\n// Browser-specific workarounds.\nvar browserQuirks = {\n  // Whether to use texImage2D instead of texSubImage2D when repainting an\n  // existing texture from a video element. On most browsers texSubImage2D is\n  // faster, but on Chrome the performance degrades significantly. See:\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=612542\n  videoUseTexImage2D: browser.chrome\n};\n\n\nfunction initWebGlContext(canvas, opts) {\n  var options = {\n    alpha: true,\n    premultipliedAlpha: true,\n    antialias: !!(opts && opts.antialias),\n    preserveDrawingBuffer: !!(opts && opts.preserveDrawingBuffer)\n  };\n\n  var gl = (canvas.getContext) && (canvas.getContext('webgl', options) || canvas.getContext('experimental-webgl', options));\n\n  if (!gl) {\n    throw new Error('Could not get WebGL context');\n  }\n\n  if (opts.wrapContext) {\n    gl = opts.wrapContext(gl);\n  }\n\n  return gl;\n}\n\n/**\n * @class WebGlStage\n * @extends Stage\n * @classdesc\n *\n * A {@link Stage} implementation using WebGl.\n *\n * @param {Object} opts\n * @param {boolean} [opts.antialias=false]\n * @param {boolean} [opts.preserveDrawingBuffer=false]\n * @param {boolean} [opts.generateMipmaps=false]\n * @param {function} [opts.wrapContext]\n *\n * The `antialias` and `preserveDrawingBuffer` options control the WebGL\n * context attributes of the same name. The `alpha` and `premultipliedAlpha`\n * WebGL context attributes are set to their default true value and cannot\n * be overriden; this allows semitransparent textures to be composited with\n * the page. See:\n * https://www.khronos.org/registry/webgl/specs/1.0/#WEBGLCONTEXTATTRIBUTES\n *\n * The `generateMipmaps` option controls texture mipmap generation. Mipmaps\n * may improve rendering quality, at the cost of increased memory usage.\n * Due to technical limitations, they are only generated for textures whose\n * dimensions are a power of two. See:\n * https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\n *\n * The `wrapContext` option is a function that receives and returns a\n * WebGLRenderingContext. The stage will use its return value as the context.\n * This is useful when used together with WebGLDebugUtils to debug WebGL issues.\n * See https://www.khronos.org/webgl/wiki/Debugging.\n *\n * Also see the available {@link Stage} options.\n */\nfunction WebGlStage(opts) {\n  opts = opts || {};\n\n  var self = this;\n\n  this.constructor.super_.call(this, opts);\n\n  this._generateMipmaps = opts.generateMipmaps != null ?\n    opts.generateMipmaps : false;\n\n  this._loader = new HtmlImageLoader(this);\n\n  this._domElement = document.createElement('canvas');\n\n  setAbsolute(this._domElement);\n  setFullSize(this._domElement);\n\n  this._gl = initWebGlContext(this._domElement, opts);\n\n  this._handleContextLoss = function() {\n    self.emit('webglcontextlost');\n    self._gl = null;\n  };\n\n  // Handle WebGl context loss.\n  this._domElement.addEventListener('webglcontextlost', this._handleContextLoss);\n\n  // WebGl renderers are singletons for a given stage. This list stores the\n  // existing renderers so they can be reused across layers with the same\n  // geometry and view type.\n  this._rendererInstances = [];\n}\n\ninherits(WebGlStage, Stage);\n\n\n/**\n * Destructor.\n */\nWebGlStage.prototype.destroy = function() {\n  this._domElement.removeEventListener('webglcontextlost', this._handleContextLoss);\n  // Delegate clearing own properties to the Stage destructor.\n  this.constructor.super_.prototype.destroy.call(this);\n};\n\n\n/**\n * Returns the underlying DOM element.\n *\n * @return {Element}\n */\nWebGlStage.prototype.domElement = function() {\n  return this._domElement;\n};\n\n\n/**\n * Returns the underlying WebGL rendering context.\n *\n * @return {WebGLRenderingContext }\n */\nWebGlStage.prototype.webGlContext = function() {\n  return this._gl;\n};\n\n\nWebGlStage.prototype.setSizeForType = function() {\n  // Update the size of the canvas coordinate space.\n  //\n  // The size is obtained by taking the stage dimensions, which are set in CSS\n  // pixels, and multiplying them by the device pixel ratio. Crucially, this\n  // must be the only place where the WebGL rendering pipeline accesses the\n  // pixel ratio; subsequent uses should reference the `drawingBufferWidth` and\n  // `drawingBufferHeight` properties on the WebGLRenderingContext. Failing to\n  // do so will break the rendering if the pixel ratio changes but the stage\n  // size does not, e.g. when moving the window across screens.\n  var ratio = pixelRatio();\n  this._domElement.width = ratio * this._width;\n  this._domElement.height = ratio * this._height;\n};\n\n\nWebGlStage.prototype.loadImage = function(url, rect, done) {\n  return this._loader.loadImage(url, rect, done);\n};\n\n\nWebGlStage.prototype.maxTextureSize = function() {\n  return this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE);\n};\n\n\nWebGlStage.prototype.validateLayer = function(layer) {\n  var tileSize = layer.geometry().maxTileSize();\n  var maxTextureSize = this.maxTextureSize();\n  if (tileSize > maxTextureSize) {\n    throw new Error('Layer has level with tile size larger than maximum texture size (' + tileSize + ' vs. ' + maxTextureSize + ')');\n  }\n};\n\n\nWebGlStage.prototype.createRenderer = function(Renderer) {\n  var rendererInstances = this._rendererInstances;\n  for (var i = 0; i < rendererInstances.length; i++) {\n    if (rendererInstances[i] instanceof Renderer) {\n      return rendererInstances[i];\n    }\n  }\n  var renderer = new Renderer(this._gl);\n  rendererInstances.push(renderer);\n  return renderer;\n};\n\n\nWebGlStage.prototype.destroyRenderer = function(renderer) {\n  var rendererInstances = this._rendererInstances;\n  if (this._renderers.indexOf(renderer) < 0) {\n    renderer.destroy();\n    var index = rendererInstances.indexOf(renderer);\n    if (index >= 0) {\n      rendererInstances.splice(index, 1);\n    }\n  }\n};\n\n\nWebGlStage.prototype.startFrame = function() {\n\n  var gl = this._gl;\n\n  if (!gl) {\n    throw new Error('Bad WebGL context - maybe context was lost?');\n  }\n\n  // Set the WebGL viewport.\n  gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n  // Clear framebuffer.\n  gl.clearColor(0.0, 0.0, 0.0, 0.0);\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n  // Enable depth testing.\n  gl.enable(gl.DEPTH_TEST);\n\n  // Enable blending. ONE and ONE_MINUS_SRC_ALPHA are the right choices for\n  // premultiplied textures.\n  gl.enable(gl.BLEND);\n  gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n};\n\n\nWebGlStage.prototype.endFrame = function() {};\n\n\nWebGlStage.prototype.takeSnapshot = function(options) {\n\n  // Validate passed argument\n  if (typeof options !== 'object' || options == null) {\n    options = {};\n  }\n\n  var quality = options.quality;\n\n  // Set default quality if it is not passed\n  if (typeof quality == 'undefined') {\n    quality = 75;\n  }\n\n  // Throw if quality is of invlid type or out of bounds\n  if (typeof quality !== 'number' || quality < 0 || quality > 100) {\n    throw new Error('WebGLStage: Snapshot quality needs to be a number between 0 and 100');\n  }\n\n  // Canvas method \"toDataURL\" needs to be called in the same\n  // context as where the actual rendering is done. Hence this.\n  this.render();\n\n  // Return the snapshot\n  return this._domElement.toDataURL('image/jpeg', quality / 100);\n}\n\n\nWebGlStage.type = WebGlStage.prototype.type = 'webgl';\n\n\nfunction WebGlTexture(stage, tile, asset) {\n  this._stage = stage;\n  this._gl = stage._gl;\n  this._texture = null;\n  this._timestamp = null;\n  this._width = this._height = null;\n  this.refresh(tile, asset);\n}\n\n\nWebGlTexture.prototype.refresh = function(tile, asset) {\n\n  var gl = this._gl;\n  var stage = this._stage;\n  var texture;\n\n  // Check whether the texture needs to be updated.\n  var timestamp = asset.timestamp();\n  if (timestamp === this._timestamp) {\n    return;\n  }\n\n  // Get asset element.\n  var element = asset.element();\n\n  // Get asset dimensions.\n  var width = asset.width();\n  var height = asset.height();\n\n  if (width !== this._width || height !== this._height) {\n\n    // If the texture dimensions have changed since the last refresh, create\n    // a new texture with the correct size.\n\n    // Check if texture dimensions would exceed the maximum texture size.\n    var maxSize = stage.maxTextureSize();\n    if (width > maxSize) {\n      throw new Error('Texture width larger than max size (' + width + ' vs. ' + maxSize + ')');\n    }\n    if (height > maxSize) {\n      throw new Error('Texture height larger than max size (' + height + ' vs. ' + maxSize + ')');\n    }\n\n    // Delete the current texture if it exists.\n    // This is necessary for Chrome on Android. If it isn't done the textures\n    // do not render when the size changes.\n    if (this._texture) {\n      gl.deleteTexture(texture);\n    }\n\n    // The texture must be premultiplied by alpha to ensure correct blending of\n    // semitransparent textures. For details, see:\n    // http://www.realtimerendering.com/blog/gpus-prefer-premultiplication/\n    texture = this._texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n    gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, element);\n\n  } else {\n\n    // If the texture dimensions remain the same, repaint the existing texture.\n    // Repainting with texSubImage2D is usually faster than with texImage2D,\n    // except in the case noted in browserQuirks.\n\n    texture = this._texture;\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n    gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n\n    if (element instanceof HTMLVideoElement && browserQuirks.videoUseTexImage2D) {\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, element);\n    } else {\n      gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, gl.RGBA, gl.UNSIGNED_BYTE, element);\n    }\n\n  }\n\n  // Generate mipmap if the corresponding stage option is set and the texture\n  // dimensions are powers of two.\n  if (stage._generateMipmaps && ispot(width) && ispot(height)) {\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n    gl.generateMipmap(gl.TEXTURE_2D);\n  } else {\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n  }\n\n  // Clamp texture to edges.\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n  // Unbind texture.\n  gl.bindTexture(gl.TEXTURE_2D, null);\n\n  // Update texture dimensions and timestamp.\n  this._timestamp = timestamp;\n  this._width = width;\n  this._height = height;\n\n};\n\n\nWebGlTexture.prototype.destroy = function() {\n  if (this._texture) {\n    this._gl.deleteTexture(this._texture);\n  }\n  clearOwnProperties(this);\n};\n\n\nWebGlStage.TextureClass = WebGlStage.prototype.TextureClass = WebGlTexture;\n\n\nmodule.exports = WebGlStage;\n", "/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};", "import * as glMatrix from \"./common.js\";\n/**\r\n * 2x2 Matrix\r\n * @module mat2\r\n */\n\n/**\r\n * Creates a new identity mat2\r\n *\r\n * @returns {mat2} a new 2x2 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat2 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat2} a matrix to clone\r\n * @returns {mat2} a new 2x2 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Copy the values from one mat2 to another\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set a mat2 to the identity matrix\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @returns {mat2} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Create a new mat2 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out A new 2x2 matrix\r\n */\n\nexport function fromValues(m00, m01, m10, m11) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\r\n * Set the components of a mat2 to the given values\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out\r\n */\n\nexport function set(out, m00, m01, m10, m11) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\r\n * Transpose the values of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache\n  // some values\n  if (out === a) {\n    var a1 = a[1];\n    out[1] = a[2];\n    out[2] = a1;\n  } else {\n    out[0] = a[0];\n    out[1] = a[2];\n    out[2] = a[1];\n    out[3] = a[3];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3]; // Calculate the determinant\n\n  var det = a0 * a3 - a2 * a1;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = a3 * det;\n  out[1] = -a1 * det;\n  out[2] = -a2 * det;\n  out[3] = a0 * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function adjoint(out, a) {\n  // Caching this value is nessecary if out == a\n  var a0 = a[0];\n  out[0] = a[3];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a0;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat2\r\n *\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  return a[0] * a[3] - a[2] * a[1];\n}\n/**\r\n * Multiplies two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  return out;\n}\n/**\r\n * Rotates a mat2 by the given angle\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  return out;\n}\n/**\r\n * Scales the mat2 by the dimensions in the given vec2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat2} out\r\n **/\n\nexport function scale(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.scale(dest, dest, vec);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat2} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  return out;\n}\n/**\r\n * Returns a string representation of a mat2\r\n *\r\n * @param {ReadonlyMat2} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat2\r\n *\r\n * @param {ReadonlyMat2} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3]);\n}\n/**\r\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\r\n * @param {ReadonlyMat2} L the lower triangular matrix\r\n * @param {ReadonlyMat2} D the diagonal matrix\r\n * @param {ReadonlyMat2} U the upper triangular matrix\r\n * @param {ReadonlyMat2} a the input matrix to factorize\r\n */\n\nexport function LDU(L, D, U, a) {\n  L[2] = a[2] / a[0];\n  U[0] = a[0];\n  U[1] = a[1];\n  U[3] = a[3] - L[2] * U[1];\n  return [L, D, U];\n}\n/**\r\n * Adds two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat2} a The first matrix.\r\n * @param {ReadonlyMat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat2} a The first matrix.\r\n * @param {ReadonlyMat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two mat2's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2} out the receiving vector\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Alias for {@link mat2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;", "import * as glMatrix from \"./common.js\";\n/**\r\n * 2x3 Matrix\r\n * @module mat2d\r\n * @description\r\n * A mat2d contains six elements defined as:\r\n * <pre>\r\n * [a, b,\r\n *  c, d,\r\n *  tx, ty]\r\n * </pre>\r\n * This is a short form for the 3x3 matrix:\r\n * <pre>\r\n * [a, b, 0,\r\n *  c, d, 0,\r\n *  tx, ty, 1]\r\n * </pre>\r\n * The last column is ignored so the array is shorter and operations are faster.\r\n */\n\n/**\r\n * Creates a new identity mat2d\r\n *\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(6);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[4] = 0;\n    out[5] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat2d initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat2d} a matrix to clone\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\r\n * Copy the values from one mat2d to another\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\r\n * Set a mat2d to the identity matrix\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Create a new mat2d with the given values\r\n *\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} A new mat2d\r\n */\n\nexport function fromValues(a, b, c, d, tx, ty) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\r\n * Set the components of a mat2d to the given values\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} out\r\n */\n\nexport function set(out, a, b, c, d, tx, ty) {\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\r\n * Inverts a mat2d\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function invert(out, a) {\n  var aa = a[0],\n      ab = a[1],\n      ac = a[2],\n      ad = a[3];\n  var atx = a[4],\n      aty = a[5];\n  var det = aa * ad - ab * ac;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = ad * det;\n  out[1] = -ab * det;\n  out[2] = -ac * det;\n  out[3] = aa * det;\n  out[4] = (ac * aty - ad * atx) * det;\n  out[5] = (ab * atx - aa * aty) * det;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat2d\r\n *\r\n * @param {ReadonlyMat2d} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  return a[0] * a[3] - a[1] * a[2];\n}\n/**\r\n * Multiplies two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  out[4] = a0 * b4 + a2 * b5 + a4;\n  out[5] = a1 * b4 + a3 * b5 + a5;\n  return out;\n}\n/**\r\n * Rotates a mat2d by the given angle\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\r\n * Scales the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to translate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat2d} out\r\n **/\n\nexport function scale(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\r\n * Translates the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to translate\r\n * @param {ReadonlyVec2} v the vec2 to translate the matrix by\r\n * @returns {mat2d} out\r\n **/\n\nexport function translate(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0;\n  out[1] = a1;\n  out[2] = a2;\n  out[3] = a3;\n  out[4] = a0 * v0 + a2 * v1 + a4;\n  out[5] = a1 * v0 + a3 * v1 + a5;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.scale(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat2d} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.translate(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat2d} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = v[0];\n  out[5] = v[1];\n  return out;\n}\n/**\r\n * Returns a string representation of a mat2d\r\n *\r\n * @param {ReadonlyMat2d} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat2d(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat2d\r\n *\r\n * @param {ReadonlyMat2d} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], 1);\n}\n/**\r\n * Adds two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2d} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  return out;\n}\n/**\r\n * Adds two mat2d's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2d} out the receiving vector\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2d} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat2d} a The first matrix.\r\n * @param {ReadonlyMat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat2d} a The first matrix.\r\n * @param {ReadonlyMat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5));\n}\n/**\r\n * Alias for {@link mat2d.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat2d.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;", "import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {ReadonlyMat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to translate\r\n * @param {ReadonlyVec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Calculates a 3x3 matrix from the given quaternion\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {ReadonlyMat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;", "import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;", "import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();", "import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();", "import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyVec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {ReadonlyQuat} a     Origin unit quaternion\r\n * @param  {ReadonlyQuat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random unit quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyMat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {ReadonlyQuat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {ReadonlyQuat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat} a The first quaternion.\r\n * @param {ReadonlyQuat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat} a The first vector.\r\n * @param {ReadonlyQuat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {ReadonlyVec3} a the initial vector\r\n * @param {ReadonlyVec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {ReadonlyQuat} c the third operand\r\n * @param {ReadonlyQuat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\r\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\r\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();", "import * as glMatrix from \"./common.js\";\nimport * as quat from \"./quat.js\";\nimport * as mat4 from \"./mat4.js\";\n/**\r\n * Dual Quaternion<br>\r\n * Format: [real, dual]<br>\r\n * Quaternion format: XYZW<br>\r\n * Make sure to have normalized dual quaternions, otherwise the functions may not work as intended.<br>\r\n * @module quat2\r\n */\n\n/**\r\n * Creates a new identity dual quat\r\n *\r\n * @returns {quat2} a new dual quaternion [real -> rotation, dual -> translation]\r\n */\n\nexport function create() {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    dq[0] = 0;\n    dq[1] = 0;\n    dq[2] = 0;\n    dq[4] = 0;\n    dq[5] = 0;\n    dq[6] = 0;\n    dq[7] = 0;\n  }\n\n  dq[3] = 1;\n  return dq;\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat2} a dual quaternion to clone\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function clone(a) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = a[0];\n  dq[1] = a[1];\n  dq[2] = a[2];\n  dq[3] = a[3];\n  dq[4] = a[4];\n  dq[5] = a[5];\n  dq[6] = a[6];\n  dq[7] = a[7];\n  return dq;\n}\n/**\r\n * Creates a new dual quat initialized with the given values\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  dq[4] = x2;\n  dq[5] = y2;\n  dq[6] = z2;\n  dq[7] = w2;\n  return dq;\n}\n/**\r\n * Creates a new dual quat from the given values (quat and translation)\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component (translation)\r\n * @param {Number} y2 Y component (translation)\r\n * @param {Number} z2 Z component (translation)\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  var ax = x2 * 0.5,\n      ay = y2 * 0.5,\n      az = z2 * 0.5;\n  dq[4] = ax * w1 + ay * z1 - az * y1;\n  dq[5] = ay * w1 + az * x1 - ax * z1;\n  dq[6] = az * w1 + ax * y1 - ay * x1;\n  dq[7] = -ax * x1 - ay * y1 - az * z1;\n  return dq;\n}\n/**\r\n * Creates a dual quat from a quaternion and a translation\r\n *\r\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\r\n * @param {ReadonlyQuat} q a normalized quaternion\r\n * @param {ReadonlyVec3} t tranlation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromRotationTranslation(out, q, t) {\n  var ax = t[0] * 0.5,\n      ay = t[1] * 0.5,\n      az = t[2] * 0.5,\n      bx = q[0],\n      by = q[1],\n      bz = q[2],\n      bw = q[3];\n  out[0] = bx;\n  out[1] = by;\n  out[2] = bz;\n  out[3] = bw;\n  out[4] = ax * bw + ay * bz - az * by;\n  out[5] = ay * bw + az * bx - ax * bz;\n  out[6] = az * bw + ax * by - ay * bx;\n  out[7] = -ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Creates a dual quat from a translation\r\n *\r\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\r\n * @param {ReadonlyVec3} t translation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromTranslation(out, t) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = t[0] * 0.5;\n  out[5] = t[1] * 0.5;\n  out[6] = t[2] * 0.5;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Creates a dual quat from a quaternion\r\n *\r\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\r\n * @param {ReadonlyQuat} q the quaternion\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromRotation(out, q) {\n  out[0] = q[0];\n  out[1] = q[1];\n  out[2] = q[2];\n  out[3] = q[3];\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Creates a new dual quat from a matrix (4x4)\r\n *\r\n * @param {quat2} out the dual quaternion\r\n * @param {ReadonlyMat4} a the matrix\r\n * @returns {quat2} dual quat receiving operation result\r\n * @function\r\n */\n\nexport function fromMat4(out, a) {\n  //TODO Optimize this\n  var outer = quat.create();\n  mat4.getRotation(outer, a);\n  var t = new glMatrix.ARRAY_TYPE(3);\n  mat4.getTranslation(t, a);\n  fromRotationTranslation(out, outer, t);\n  return out;\n}\n/**\r\n * Copy the values from one dual quat to another\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the source dual quaternion\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\r\n * Set a dual quat to the identity dual quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @returns {quat2} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Set the components of a dual quat to the given values\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function set(out, x1, y1, z1, w1, x2, y2, z2, w2) {\n  out[0] = x1;\n  out[1] = y1;\n  out[2] = z1;\n  out[3] = w1;\n  out[4] = x2;\n  out[5] = y2;\n  out[6] = z2;\n  out[7] = w2;\n  return out;\n}\n/**\r\n * Gets the real part of a dual quat\r\n * @param  {quat} out real part\r\n * @param  {ReadonlyQuat2} a Dual Quaternion\r\n * @return {quat} real part\r\n */\n\nexport var getReal = quat.copy;\n/**\r\n * Gets the dual part of a dual quat\r\n * @param  {quat} out dual part\r\n * @param  {ReadonlyQuat2} a Dual Quaternion\r\n * @return {quat} dual part\r\n */\n\nexport function getDual(out, a) {\n  out[0] = a[4];\n  out[1] = a[5];\n  out[2] = a[6];\n  out[3] = a[7];\n  return out;\n}\n/**\r\n * Set the real component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {ReadonlyQuat} q a quaternion representing the real part\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport var setReal = quat.copy;\n/**\r\n * Set the dual component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {ReadonlyQuat} q a quaternion representing the dual part\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function setDual(out, q) {\n  out[4] = q[0];\n  out[5] = q[1];\n  out[6] = q[2];\n  out[7] = q[3];\n  return out;\n}\n/**\r\n * Gets the translation of a normalized dual quat\r\n * @param  {vec3} out translation\r\n * @param  {ReadonlyQuat2} a Dual Quaternion to be decomposed\r\n * @return {vec3} translation\r\n */\n\nexport function getTranslation(out, a) {\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3];\n  out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n  out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n  out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  return out;\n}\n/**\r\n * Translates a dual quat by the given vector\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {quat2} out\r\n */\n\nexport function translate(out, a, v) {\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3],\n      bx1 = v[0] * 0.5,\n      by1 = v[1] * 0.5,\n      bz1 = v[2] * 0.5,\n      ax2 = a[4],\n      ay2 = a[5],\n      az2 = a[6],\n      aw2 = a[7];\n  out[0] = ax1;\n  out[1] = ay1;\n  out[2] = az1;\n  out[3] = aw1;\n  out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\n  out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\n  out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\n  out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the X axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateX(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the Y axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateY(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the Z axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateZ(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat by a given quaternion (a * q)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {ReadonlyQuat} q quaternion to rotate by\r\n * @returns {quat2} out\r\n */\n\nexport function rotateByQuatAppend(out, a, q) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  out[0] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[1] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[2] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[3] = aw * qw - ax * qx - ay * qy - az * qz;\n  ax = a[4];\n  ay = a[5];\n  az = a[6];\n  aw = a[7];\n  out[4] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[5] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[6] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[7] = aw * qw - ax * qx - ay * qy - az * qz;\n  return out;\n}\n/**\r\n * Rotates a dual quat by a given quaternion (q * a)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat} q quaternion to rotate by\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @returns {quat2} out\r\n */\n\nexport function rotateByQuatPrepend(out, q, a) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      bx = a[0],\n      by = a[1],\n      bz = a[2],\n      bw = a[3];\n  out[0] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[1] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[2] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[3] = qw * bw - qx * bx - qy * by - qz * bz;\n  bx = a[4];\n  by = a[5];\n  bz = a[6];\n  bw = a[7];\n  out[4] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[5] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[6] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[7] = qw * bw - qx * bx - qy * by - qz * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around a given axis. Does the normalisation automatically\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @param {Number} rad how far the rotation should be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateAroundAxis(out, a, axis, rad) {\n  //Special case for rad = 0\n  if (Math.abs(rad) < glMatrix.EPSILON) {\n    return copy(out, a);\n  }\n\n  var axisLength = Math.hypot(axis[0], axis[1], axis[2]);\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  var bx = s * axis[0] / axisLength;\n  var by = s * axis[1] / axisLength;\n  var bz = s * axis[2] / axisLength;\n  var bw = Math.cos(rad);\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3];\n  out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  out[4] = ax * bw + aw * bx + ay * bz - az * by;\n  out[5] = ay * bw + aw * by + az * bx - ax * bz;\n  out[6] = az * bw + aw * bz + ax * by - ay * bx;\n  out[7] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Adds two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  return out;\n}\n/**\r\n * Multiplies two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @returns {quat2} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax0 = a[0],\n      ay0 = a[1],\n      az0 = a[2],\n      aw0 = a[3],\n      bx1 = b[4],\n      by1 = b[5],\n      bz1 = b[6],\n      bw1 = b[7],\n      ax1 = a[4],\n      ay1 = a[5],\n      az1 = a[6],\n      aw1 = a[7],\n      bx0 = b[0],\n      by0 = b[1],\n      bz0 = b[2],\n      bw0 = b[3];\n  out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\n  out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\n  out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\n  out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\n  out[4] = ax0 * bw1 + aw0 * bx1 + ay0 * bz1 - az0 * by1 + ax1 * bw0 + aw1 * bx0 + ay1 * bz0 - az1 * by0;\n  out[5] = ay0 * bw1 + aw0 * by1 + az0 * bx1 - ax0 * bz1 + ay1 * bw0 + aw1 * by0 + az1 * bx0 - ax1 * bz0;\n  out[6] = az0 * bw1 + aw0 * bz1 + ax0 * by1 - ay0 * bx1 + az1 * bw0 + aw1 * bz0 + ax1 * by0 - ay1 * bx0;\n  out[7] = aw0 * bw1 - ax0 * bx1 - ay0 * by1 - az0 * bz1 + aw1 * bw0 - ax1 * bx0 - ay1 * by0 - az1 * bz0;\n  return out;\n}\n/**\r\n * Alias for {@link quat2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a dual quat by a scalar number\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {ReadonlyQuat2} a the dual quat to scale\r\n * @param {Number} b amount to scale the dual quat by\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  return out;\n}\n/**\r\n * Calculates the dot product of two dual quat's (The dot product of the real parts)\r\n *\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = quat.dot;\n/**\r\n * Performs a linear interpolation between two dual quats's\r\n * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when t = 0.5)\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var mt = 1 - t;\n  if (dot(a, b) < 0) t = -t;\n  out[0] = a[0] * mt + b[0] * t;\n  out[1] = a[1] * mt + b[1] * t;\n  out[2] = a[2] * mt + b[2] * t;\n  out[3] = a[3] * mt + b[3] * t;\n  out[4] = a[4] * mt + b[4] * t;\n  out[5] = a[5] * mt + b[5] * t;\n  out[6] = a[6] * mt + b[6] * t;\n  out[7] = a[7] * mt + b[7] * t;\n  return out;\n}\n/**\r\n * Calculates the inverse of a dual quat. If they are normalized, conjugate is cheaper\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a dual quat to calculate inverse of\r\n * @returns {quat2} out\r\n */\n\nexport function invert(out, a) {\n  var sqlen = squaredLength(a);\n  out[0] = -a[0] / sqlen;\n  out[1] = -a[1] / sqlen;\n  out[2] = -a[2] / sqlen;\n  out[3] = a[3] / sqlen;\n  out[4] = -a[4] / sqlen;\n  out[5] = -a[5] / sqlen;\n  out[6] = -a[6] / sqlen;\n  out[7] = a[7] / sqlen;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a dual quat\r\n * If the dual quaternion is normalized, this function is faster than quat2.inverse and produces the same result.\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {ReadonlyQuat2} a quat to calculate conjugate of\r\n * @returns {quat2} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  out[4] = -a[4];\n  out[5] = -a[5];\n  out[6] = -a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\r\n * Calculates the length of a dual quat\r\n *\r\n * @param {ReadonlyQuat2} a dual quat to calculate length of\r\n * @returns {Number} length of a\r\n * @function\r\n */\n\nexport var length = quat.length;\n/**\r\n * Alias for {@link quat2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a dual quat\r\n *\r\n * @param {ReadonlyQuat2} a dual quat to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = quat.squaredLength;\n/**\r\n * Alias for {@link quat2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a dual quat\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a dual quaternion to normalize\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function normalize(out, a) {\n  var magnitude = squaredLength(a);\n\n  if (magnitude > 0) {\n    magnitude = Math.sqrt(magnitude);\n    var a0 = a[0] / magnitude;\n    var a1 = a[1] / magnitude;\n    var a2 = a[2] / magnitude;\n    var a3 = a[3] / magnitude;\n    var b0 = a[4];\n    var b1 = a[5];\n    var b2 = a[6];\n    var b3 = a[7];\n    var a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;\n    out[0] = a0;\n    out[1] = a1;\n    out[2] = a2;\n    out[3] = a3;\n    out[4] = (b0 - a0 * a_dot_b) / magnitude;\n    out[5] = (b1 - a1 * a_dot_b) / magnitude;\n    out[6] = (b2 - a2 * a_dot_b) / magnitude;\n    out[7] = (b3 - a3 * a_dot_b) / magnitude;\n  }\n\n  return out;\n}\n/**\r\n * Returns a string representation of a dual quatenion\r\n *\r\n * @param {ReadonlyQuat2} a dual quaternion to represent as a string\r\n * @returns {String} string representation of the dual quat\r\n */\n\nexport function str(a) {\n  return \"quat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \")\";\n}\n/**\r\n * Returns whether or not the dual quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat2} a the first dual quaternion.\r\n * @param {ReadonlyQuat2} b the second dual quaternion.\r\n * @returns {Boolean} true if the dual quaternions are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7];\n}\n/**\r\n * Returns whether or not the dual quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat2} a the first dual quat.\r\n * @param {ReadonlyQuat2} b the second dual quat.\r\n * @returns {Boolean} true if the dual quats are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7));\n}", "import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {ReadonlyVec2} a The vec2 point to rotate\r\n * @param {ReadonlyVec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {ReadonlyVec2} a The first operand\r\n * @param {ReadonlyVec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();", "import * as glMatrix from \"./common.js\";\nimport * as mat2 from \"./mat2.js\";\nimport * as mat2d from \"./mat2d.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as mat4 from \"./mat4.js\";\nimport * as quat from \"./quat.js\";\nimport * as quat2 from \"./quat2.js\";\nimport * as vec2 from \"./vec2.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\nexport { glMatrix, mat2, mat2d, mat3, mat4, quat, quat2, vec2, vec3, vec4 };", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\nmodule.exports = clamp;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// These are used to set the WebGl depth for a tile.\nvar MAX_LAYERS = 256; // Max number of layers per stage.\nvar MAX_LEVELS = 256; // Max number of levels per layer.\n\nvar clamp = require('../util/clamp');\nvar vec4 = require('gl-matrix').vec4;\nvar vec3 = require('gl-matrix').vec3;\nvar mat4 = require('gl-matrix').mat4;\n\n\nfunction createShader(gl, type, src) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, src);\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    throw gl.getShaderInfoLog(shader);\n  }\n  return shader;\n}\n\n\nfunction createShaderProgram(gl, vertexSrc, fragmentSrc, attribList, uniformList) {\n\n  var vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexSrc);\n  var fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragmentSrc);\n\n  var shaderProgram = gl.createProgram();\n\n  gl.attachShader(shaderProgram, vertexShader);\n  gl.attachShader(shaderProgram, fragmentShader);\n  gl.linkProgram(shaderProgram);\n\n  if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n    throw gl.getProgramInfoLog(shaderProgram);\n  }\n\n  for (var i = 0; i < attribList.length; i++) {\n    var attrib = attribList[i];\n    shaderProgram[attrib] = gl.getAttribLocation(shaderProgram, attrib);\n    if (shaderProgram[attrib] === -1) {\n      throw new Error('Shader program has no ' + attrib + ' attribute');\n    }\n  }\n\n  for (var j = 0; j < uniformList.length; j++) {\n    var uniform = uniformList[j];\n    shaderProgram[uniform] = gl.getUniformLocation(shaderProgram, uniform);\n    if (shaderProgram[uniform] === -1) {\n      throw new Error('Shader program has no ' + uniform + ' uniform');\n    }\n  }\n\n  return shaderProgram;\n}\n\n\nfunction destroyShaderProgram(gl, shaderProgram) {\n  var shaderList = gl.getAttachedShaders(shaderProgram);\n  for (var i = 0; i < shaderList.length; i++) {\n    var shader = shaderList[i];\n    gl.detachShader(shaderProgram, shader);\n    gl.deleteShader(shader);\n  }\n  gl.deleteProgram(shaderProgram);\n}\n\n\nfunction createConstantBuffer(gl, target, usage, value) {\n  var buffer = gl.createBuffer();\n  gl.bindBuffer(target, buffer);\n  gl.bufferData(target, value, usage);\n  return buffer;\n}\n\n\nfunction createConstantBuffers(gl, vertexIndices, vertexPositions, textureCoords) {\n  return {\n    vertexIndices: createConstantBuffer(gl, gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW, new Uint16Array(vertexIndices)),\n    vertexPositions: createConstantBuffer(gl, gl.ARRAY_BUFFER, gl.STATIC_DRAW, new Float32Array(vertexPositions)),\n    textureCoords: createConstantBuffer(gl, gl.ARRAY_BUFFER, gl.STATIC_DRAW, new Float32Array(textureCoords))\n  };\n}\n\n\nfunction destroyConstantBuffers(gl, constantBuffers) {\n  gl.deleteBuffer(constantBuffers.vertexIndices);\n  gl.deleteBuffer(constantBuffers.vertexPositions);\n  gl.deleteBuffer(constantBuffers.textureCoords);\n}\n\n\nfunction enableAttributes(gl, shaderProgram) {\n  var numAttrs = gl.getProgramParameter(shaderProgram, gl.ACTIVE_ATTRIBUTES);\n  for (var i = 0; i < numAttrs; i++) {\n    gl.enableVertexAttribArray(i);\n  }\n}\n\n\nfunction disableAttributes(gl, shaderProgram) {\n  var numAttrs = gl.getProgramParameter(shaderProgram, gl.ACTIVE_ATTRIBUTES);\n  for (var i = 0; i < numAttrs; i++) {\n    gl.disableVertexAttribArray(i);\n  }\n}\n\n\nfunction setTexture(gl, shaderProgram, texture) {\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(gl.TEXTURE_2D, texture._texture);\n  gl.uniform1i(shaderProgram.uSampler, 0);\n}\n\n\nfunction setDepth(gl, shaderProgram, layerZ, tileZ) {\n  var depth = (((layerZ + 1) * MAX_LEVELS) - tileZ) / (MAX_LEVELS * MAX_LAYERS);\n  gl.uniform1f(shaderProgram.uDepth, depth);\n}\n\n\nvar defaultOpacity = 1.0;\nvar defaultColorOffset = vec4.create();\nvar defaultColorMatrix = mat4.create();\nmat4.identity(defaultColorMatrix);\n\nfunction setupPixelEffectUniforms(gl, effects, uniforms) {\n  var opacity = defaultOpacity;\n  if (effects && effects.opacity != null) {\n    opacity = effects.opacity;\n  }\n  gl.uniform1f(uniforms.opacity, opacity);\n\n  var colorOffset = defaultColorOffset;\n  if (effects && effects.colorOffset) {\n    colorOffset = effects.colorOffset;\n  }\n  gl.uniform4fv(uniforms.colorOffset, colorOffset);\n\n  var colorMatrix = defaultColorMatrix;\n  if (effects && effects.colorMatrix) {\n    colorMatrix = effects.colorMatrix;\n  }\n  gl.uniformMatrix4fv(uniforms.colorMatrix, false, colorMatrix);\n}\n\n\n// Temporary vectors for setViewport.\nvar translateVector = vec3.create();\nvar scaleVector = vec3.create();\n\n\n// Sets the WebGL viewport and returns a viewport clamping compensation matrix.\n//\n// Negative viewport origin coordinates cause rendering issues. Letting the\n// viewport dimensions extend beyond the visible area do not seem to cause\n// rendering issues, but they may still have an impact on performance.\n// Therefore, when the scene's rect is not fully contained in the rendering\n// area, we clamp the viewport to the rendering area, and return a compensation\n// matrix to scale and translate vertices accordingly.\nfunction setViewport(gl, layer, rect, viewportMatrix) {\n  if (rect.x === 0 && rect.width === 1 && rect.y === 0 && rect.height === 1) {\n    // Fast path for full rect.\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    mat4.identity(viewportMatrix);\n    return;\n  }\n\n  var offsetX = rect.x;\n  var clampedOffsetX = clamp(offsetX, 0, 1);\n  var leftExcess = clampedOffsetX - offsetX;\n  var maxClampedWidth = 1 - clampedOffsetX;\n  var clampedWidth = clamp(rect.width - leftExcess, 0, maxClampedWidth);\n  var rightExcess = rect.width - clampedWidth;\n\n  var offsetY = 1 - rect.height - rect.y;\n  var clampedOffsetY = clamp(offsetY, 0, 1);\n  var bottomExcess = clampedOffsetY - offsetY;\n  var maxClampedHeight = 1 - clampedOffsetY;\n  var clampedHeight = clamp(rect.height - bottomExcess, 0, maxClampedHeight);\n  var topExcess = rect.height - clampedHeight;\n\n  vec3.set(\n    scaleVector,\n    rect.width / clampedWidth,\n    rect.height / clampedHeight,\n    1);\n\n  vec3.set(\n    translateVector,\n    (rightExcess - leftExcess) / clampedWidth,\n    (topExcess - bottomExcess) / clampedHeight,\n    0);\n\n  mat4.identity(viewportMatrix);\n  mat4.translate(viewportMatrix, viewportMatrix, translateVector);\n  mat4.scale(viewportMatrix, viewportMatrix, scaleVector);\n\n  gl.viewport(gl.drawingBufferWidth * clampedOffsetX,\n              gl.drawingBufferHeight * clampedOffsetY,\n              gl.drawingBufferWidth * clampedWidth,\n              gl.drawingBufferHeight * clampedHeight);\n}\n\nmodule.exports = {\n  createShaderProgram: createShaderProgram,\n  destroyShaderProgram: destroyShaderProgram,\n  createConstantBuffers: createConstantBuffers,\n  destroyConstantBuffers: destroyConstantBuffers,\n  enableAttributes: enableAttributes,\n  disableAttributes: disableAttributes,\n  setTexture: setTexture,\n  setDepth: setDepth,\n  setViewport: setViewport,\n  setupPixelEffectUniforms: setupPixelEffectUniforms\n};\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = [\n'attribute vec3 aVertexPosition;',\n'attribute vec2 aTextureCoord;',\n\n'uniform float uDepth;',\n'uniform mat4 uViewportMatrix;',\n'uniform mat4 uProjMatrix;',\n\n'varying vec2 vTextureCoord;',\n\n'void main(void) {',\n'  gl_Position = uViewportMatrix * uProjMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);',\n'  gl_Position.z = uDepth * gl_Position.w;',\n'  vTextureCoord = aTextureCoord;',\n'}'\n].join('\\n');\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = [\n'#ifdef GL_FRAGMENT_PRECISION_HIGH',\n'precision highp float;',\n'#else',\n'precision mediump float;',\n'#endif',\n\n'uniform sampler2D uSampler;',\n'uniform float uOpacity;',\n'uniform vec4 uColorOffset;',\n'uniform mat4 uColorMatrix;',\n\n'varying vec2 vTextureCoord;',\n\n'void main(void) {',\n'  vec4 color = texture2D(uSampler, vTextureCoord) * uColorMatrix + uColorOffset;',\n'  gl_FragColor = vec4(color.rgba * uOpacity);',\n'}'\n].join('\\n');\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mat4 = require('gl-matrix').mat4;\nvar vec3 = require('gl-matrix').vec3;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar WebGlCommon = require('./WebGlCommon');\nvar createConstantBuffers = WebGlCommon.createConstantBuffers;\nvar destroyConstantBuffers = WebGlCommon.destroyConstantBuffers;\nvar createShaderProgram = WebGlCommon.createShaderProgram;\nvar destroyShaderProgram = WebGlCommon.destroyShaderProgram;\nvar enableAttributes = WebGlCommon.enableAttributes;\nvar disableAttributes = WebGlCommon.disableAttributes;\nvar setViewport = WebGlCommon.setViewport;\nvar setupPixelEffectUniforms = WebGlCommon.setupPixelEffectUniforms;\n\nvar setDepth = WebGlCommon.setDepth;\nvar setTexture = WebGlCommon.setTexture;\n\nvar vertexSrc = require('../shaders/vertexNormal');\nvar fragmentSrc = require('../shaders/fragmentNormal');\n\nvar vertexIndices = [0, 1, 2, 0, 2, 3];\nvar vertexPositions = [-0.5, -0.5, 0.0, 0.5, -0.5, 0.0, 0.5, 0.5, 0.0, -0.5, 0.5, 0.0];\nvar textureCoords = [0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0];\n\nvar attribList = ['aVertexPosition', 'aTextureCoord'];\nvar uniformList = [\n  'uDepth', 'uOpacity', 'uSampler', 'uProjMatrix', 'uViewportMatrix',\n  'uColorOffset', 'uColorMatrix'\n];\n\n\nfunction WebGlBaseRenderer(gl) {\n  this.gl = gl;\n\n  // The projection matrix positions the tiles in world space.\n  // We compute it in Javascript because lack of precision in the vertex shader\n  // causes seams to appear between adjacent tiles at large zoom levels.\n  this.projMatrix = mat4.create();\n\n  // The viewport matrix responsible for viewport clamping.\n  // See setViewport() for an explanation of how it works.\n  this.viewportMatrix = mat4.create();\n\n  // Translation and scale vectors for tiles.\n  this.translateVector = vec3.create();\n  this.scaleVector = vec3.create();\n\n  this.constantBuffers = createConstantBuffers(gl, vertexIndices, vertexPositions, textureCoords);\n\n  this.shaderProgram = createShaderProgram(gl, vertexSrc, fragmentSrc, attribList, uniformList);\n}\n\nWebGlBaseRenderer.prototype.destroy = function() {\n  destroyConstantBuffers(this.gl, this.constantBuffers);\n  destroyShaderProgram(this.gl, this.shaderProgram);\n  clearOwnProperties(this);\n};\n\nWebGlBaseRenderer.prototype.startLayer = function(layer, rect) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  var constantBuffers = this.constantBuffers;\n  var viewportMatrix = this.viewportMatrix;\n\n  gl.useProgram(shaderProgram);\n\n  enableAttributes(gl, shaderProgram);\n\n  setViewport(gl, layer, rect, viewportMatrix);\n  gl.uniformMatrix4fv(shaderProgram.uViewportMatrix, false, viewportMatrix);\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, constantBuffers.vertexPositions);\n  gl.vertexAttribPointer(shaderProgram.aVertexPosition, 3, gl.FLOAT, gl.FALSE, 0, 0);\n  gl.bindBuffer(gl.ARRAY_BUFFER, constantBuffers.textureCoords);\n  gl.vertexAttribPointer(shaderProgram.aTextureCoord, 2, gl.FLOAT, gl.FALSE, 0, 0);\n\n  setupPixelEffectUniforms(gl, layer.effects(), {\n    opacity: shaderProgram.uOpacity,\n    colorOffset: shaderProgram.uColorOffset,\n    colorMatrix: shaderProgram.uColorMatrix\n  });\n};\n\n\nWebGlBaseRenderer.prototype.endLayer = function(layer, rect) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  disableAttributes(gl, shaderProgram);\n};\n\n\nWebGlBaseRenderer.prototype.renderTile = function(tile, texture, layer, layerZ) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  var constantBuffers = this.constantBuffers;\n  var projMatrix = this.projMatrix;\n  var translateVector = this.translateVector;\n  var scaleVector = this.scaleVector;\n\n  translateVector[0] = tile.centerX();\n  translateVector[1] = tile.centerY();\n  translateVector[2] = -0.5;\n\n  scaleVector[0] = tile.scaleX();\n  scaleVector[1] = tile.scaleY();\n  scaleVector[2] = 1.0;\n\n  mat4.copy(projMatrix, layer.view().projection());\n  mat4.rotateX(projMatrix, projMatrix, tile.rotX());\n  mat4.rotateY(projMatrix, projMatrix, tile.rotY());\n  mat4.translate(projMatrix, projMatrix, translateVector);\n  mat4.scale(projMatrix, projMatrix, scaleVector);\n\n  gl.uniformMatrix4fv(shaderProgram.uProjMatrix, false, projMatrix);\n\n  setDepth(gl, shaderProgram, layerZ, tile.z);\n\n  setTexture(gl, shaderProgram, texture);\n\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, constantBuffers.vertexIndices);\n  gl.drawElements(gl.TRIANGLES, vertexIndices.length, gl.UNSIGNED_SHORT, 0);\n};\n\n\nmodule.exports = WebGlBaseRenderer;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WebGlBaseRenderer = require('./WebGlBase');\nvar inherits = require('../util/inherits');\n\n/**\n * @class WebGlCubeRenderer\n * @implements Renderer\n * @classdesc\n *\n * A renderer for {@link CubeGeometry} and {@link RectilinearView}, appropriate\n * for a {@link WebGlStage}.\n *\n * Most users do not need to instantiate this class. Renderers are created and\n * destroyed by {@link Stage} as necessary.\n */\nfunction WebGlCubeRenderer() {\n  this.constructor.super_.apply(this, arguments);\n}\n\ninherits(WebGlCubeRenderer, WebGlBaseRenderer);\n\nmodule.exports = WebGlCubeRenderer;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WebGlBaseRenderer = require('./WebGlBase');\nvar inherits = require('../util/inherits');\n\n/**\n * @class WebGlFlatRenderer\n * @implements Renderer\n * @classdesc\n *\n * A renderer for {@link FlatGeometry} and {@link FlatView}, appropriate for a\n * {@link WebGlStage}.\n *\n * Most users do not need to instantiate this class. Renderers are created and\n * destroyed by {@link Stage} as necessary.\n */\nfunction WebGlFlatRenderer() {\n  this.constructor.super_.apply(this, arguments);\n}\n\ninherits(WebGlFlatRenderer, WebGlBaseRenderer);\n\nmodule.exports = WebGlFlatRenderer;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = [\n'attribute vec3 aVertexPosition;',\n\n'uniform float uDepth;',\n'uniform mat4 uViewportMatrix;',\n'uniform mat4 uInvProjMatrix;',\n\n'varying vec4 vRay;',\n\n'void main(void) {',\n'  vRay = uInvProjMatrix * vec4(aVertexPosition.xy, 1.0, 1.0);',\n'  gl_Position = uViewportMatrix * vec4(aVertexPosition.xy, uDepth, 1.0);',\n'}'\n].join('\\n');\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = [\n'#ifdef GL_FRAGMENT_PRECISION_HIGH',\n'precision highp float;',\n'#else',\n'precision mediump float',\n'#endif',\n\n'uniform sampler2D uSampler;',\n'uniform float uOpacity;',\n'uniform float uTextureX;',\n'uniform float uTextureY;',\n'uniform float uTextureWidth;',\n'uniform float uTextureHeight;',\n'uniform vec4 uColorOffset;',\n'uniform mat4 uColorMatrix;',\n\n'varying vec4 vRay;',\n\n'const float PI = 3.14159265358979323846264;',\n\n'void main(void) {',\n'  float r = inversesqrt(vRay.x * vRay.x + vRay.y * vRay.y + vRay.z * vRay.z);',\n'  float phi  = acos(vRay.y * r);',\n'  float theta = atan(vRay.x, -1.0*vRay.z);',\n'  float s = 0.5 + 0.5 * theta / PI;',\n'  float t = 1.0 - phi / PI;',\n\n'  s = s * uTextureWidth + uTextureX;',\n'  t = t * uTextureHeight + uTextureY;',\n\n'  vec4 color = texture2D(uSampler, vec2(s, t)) * uColorMatrix + uColorOffset;',\n'  gl_FragColor = vec4(color.rgba * uOpacity);',\n'}'\n].join('\\n');\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mat4 = require('gl-matrix').mat4;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar WebGlCommon = require('./WebGlCommon');\nvar createConstantBuffers = WebGlCommon.createConstantBuffers;\nvar destroyConstantBuffers = WebGlCommon.destroyConstantBuffers;\nvar createShaderProgram = WebGlCommon.createShaderProgram;\nvar destroyShaderProgram = WebGlCommon.destroyShaderProgram;\nvar enableAttributes = WebGlCommon.enableAttributes;\nvar disableAttributes = WebGlCommon.disableAttributes;\nvar setViewport = WebGlCommon.setViewport;\nvar setupPixelEffectUniforms = WebGlCommon.setupPixelEffectUniforms;\n\nvar setDepth = WebGlCommon.setDepth;\nvar setTexture = WebGlCommon.setTexture;\n\nvar vertexSrc = require('../shaders/vertexEquirect');\nvar fragmentSrc = require('../shaders/fragmentEquirect');\n\nvar vertexIndices = [0, 1, 2, 0, 2, 3];\nvar vertexPositions = [-1.0, -1.0, 0.0, 1.0, -1.0, 0.0, 1.0, 1.0, 0.0, -1.0, 1.0, 0.0];\nvar textureCoords = [0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0];\n\nvar attribList = ['aVertexPosition'];\nvar uniformList = [\n  'uDepth', 'uOpacity', 'uSampler', 'uInvProjMatrix', 'uViewportMatrix',\n  'uColorOffset', 'uColorMatrix', 'uTextureX', 'uTextureY', 'uTextureWidth',\n  'uTextureHeight'\n];\n\n\n/**\n * @class WebGlEquirectRenderer\n * @implements Renderer\n * @classdesc\n *\n * A renderer for {@link EquirectGeometry} and {@link RectilinearView},\n * appropriate for {@link WebGlStage}.\n *\n * Most users do not need to instantiate this class. Renderers are created and\n * destroyed by {@link Stage} as necessary.\n */\nfunction WebGlEquirectRenderer(gl) {\n  this.gl = gl;\n\n  // The inverse projection matrix.\n  this.invProjMatrix = mat4.create();\n\n  // The viewport matrix responsible for viewport clamping.\n  // See setViewport() for an explanation of how it works.\n  this.viewportMatrix = mat4.create();\n\n  this.constantBuffers = createConstantBuffers(gl, vertexIndices, vertexPositions, textureCoords);\n\n  this.shaderProgram = createShaderProgram(gl, vertexSrc, fragmentSrc, attribList, uniformList);\n}\n\nWebGlEquirectRenderer.prototype.destroy = function() {\n  destroyConstantBuffers(this.gl, this.constantBuffers);\n  destroyShaderProgram(this.gl, this.shaderProgram);\n  clearOwnProperties(this);\n};\n\n\nWebGlEquirectRenderer.prototype.startLayer = function(layer, rect) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  var constantBuffers = this.constantBuffers;\n  var invProjMatrix = this.invProjMatrix;\n  var viewportMatrix = this.viewportMatrix;\n\n  gl.useProgram(shaderProgram);\n\n  enableAttributes(gl, shaderProgram);\n\n  setViewport(gl, layer, rect, viewportMatrix);\n  gl.uniformMatrix4fv(shaderProgram.uViewportMatrix, false, viewportMatrix);\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, constantBuffers.vertexPositions);\n  gl.vertexAttribPointer(shaderProgram.aVertexPosition, 3, gl.FLOAT, gl.FALSE, 0, 0);\n  gl.bindBuffer(gl.ARRAY_BUFFER, constantBuffers.textureCoords);\n\n  // Compute and set the inverse projection matrix.\n  mat4.copy(invProjMatrix, layer.view().projection());\n  mat4.invert(invProjMatrix, invProjMatrix);\n\n  gl.uniformMatrix4fv(shaderProgram.uInvProjMatrix, false, invProjMatrix);\n\n  // Compute and set the texture scale and crop offsets.\n  var textureCrop = layer.effects().textureCrop || {};\n  var textureX = textureCrop.x != null ? textureCrop.x : 0;\n  var textureY = textureCrop.y != null ? textureCrop.y : 0;\n  var textureWidth = textureCrop.width != null ? textureCrop.width : 1;\n  var textureHeight = textureCrop.height != null ? textureCrop.height : 1;\n\n  gl.uniform1f(shaderProgram.uTextureX, textureX);\n  gl.uniform1f(shaderProgram.uTextureY, textureY);\n  gl.uniform1f(shaderProgram.uTextureWidth, textureWidth);\n  gl.uniform1f(shaderProgram.uTextureHeight, textureHeight);\n\n  setupPixelEffectUniforms(gl, layer.effects(), {\n    opacity: shaderProgram.uOpacity,\n    colorOffset: shaderProgram.uColorOffset,\n    colorMatrix: shaderProgram.uColorMatrix\n  });\n};\n\n\nWebGlEquirectRenderer.prototype.endLayer = function(layer, rect) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  disableAttributes(gl, shaderProgram);\n};\n\n\nWebGlEquirectRenderer.prototype.renderTile = function(tile, texture, layer, layerZ) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  var constantBuffers = this.constantBuffers;\n\n  setDepth(gl, shaderProgram, layerZ, tile.z);\n\n  setTexture(gl, shaderProgram, texture);\n\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, constantBuffers.vertexIndices);\n  gl.drawElements(gl.TRIANGLES, vertexIndices.length, gl.UNSIGNED_SHORT, 0);\n};\n\n\nmodule.exports = WebGlEquirectRenderer;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WebGlCube = require('./WebGlCube');\nvar WebGlFlat = require('./WebGlFlat');\nvar WebGlEquirect = require('./WebGlEquirect');\n\n/**\n * Registers all known renderers for the given stage type into that stage.\n * Most users will not need to register renderers, as {@link Viewer} does it for\n * them.\n *\n * @param {Stage} stage The stage where the renderers are to be registered.\n * @throws An error if the stage type is unknown.\n */\nfunction registerDefaultRenderers(stage) {\n  switch (stage.type) {\n    case 'webgl':\n      stage.registerRenderer('flat', 'flat', WebGlFlat);\n      stage.registerRenderer('cube', 'rectilinear', WebGlCube);\n      stage.registerRenderer('equirect', 'rectilinear', WebGlEquirect);\n      break;\n    default:\n      throw new Error('Unknown stage type: ' + stage.type);\n  }\n}\n\nmodule.exports = registerDefaultRenderers;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Jenkins one-at-a-time hash\n// http://www.burtleburtle.net/bob/hash/doobs.html\n// Input: an array of integers\n// Output: an integer\n\nfunction hash() {\n  var h = 0;\n  for (var i = 0; i < arguments.length; i++) {\n    var k = arguments[i];\n    h += k;\n    h += k << 10;\n    h ^= k >> 6;\n  }\n  h += h << 3;\n  h ^= h >> 11;\n  h += h << 15;\n  return h >= 0 ? h : -h;\n}\n\nmodule.exports = hash;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * Modulo operation\n *\n * @memberof util\n * @param {Number} dividend\n * @param {Number} divisor\n * @returns {Number} Value in range `[0,divisor[`\n */\nfunction mod(a, b) {\n  return (+a % (b = +b) + b) % b;\n}\n\nmodule.exports = mod;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mod = require('../util/mod');\n\nvar defaultCapacity = 64;\n\n// A set data structure for elements implementing hash() and equals().\n// The capacity, if given, is just a hint; the set is allowed to exceed it, but\n// performance may suffer.\nfunction Set(capacity) {\n  if (capacity != null &&\n      (!isFinite(capacity) || Math.floor(capacity) !== capacity || capacity < 1)) {\n    throw new Error('Set: invalid capacity');\n  }\n  this._capacity = this._capacity || defaultCapacity;\n\n  this._buckets = [];\n  for (var i = 0; i < this._capacity; i++) {\n    this._buckets.push([]);\n  }\n  this._size = 0;\n}\n\n// Adds an element, replacing an existing element.\n// Returns the replaced element, or null if no element was replaced.\nSet.prototype.add = function(element) {\n  var h = mod(element.hash(), this._capacity);\n  var bucket = this._buckets[h];\n  for (var i = 0; i < bucket.length; i++) {\n    var existingElement = bucket[i];\n    if (element.equals(existingElement)) {\n      bucket[i] = element;\n      return existingElement;\n    }\n  }\n  bucket.push(element);\n  this._size++;\n  return null;\n};\n\n// Removes an element.\n// Returns the removed element, or null if the element was not found.\nSet.prototype.remove = function(element) {\n  var h = mod(element.hash(), this._capacity);\n  var bucket = this._buckets[h];\n  for (var i = 0; i < bucket.length; i++) {\n    var existingElement = bucket[i];\n    if (element.equals(existingElement)) {\n      // Splice manually to avoid Array#splice return value allocation.\n      for (var j = i; j < bucket.length - 1; j++) {\n        bucket[j] = bucket[j+1];\n      }\n      bucket.length = bucket.length - 1;\n      this._size--;\n      return existingElement;\n    }\n  }\n  return null;\n};\n\n// Returns whether an element is in the set.\nSet.prototype.has = function(element) {\n  var h = mod(element.hash(), this._capacity);\n  var bucket = this._buckets[h];\n  for (var i = 0; i < bucket.length; i++) {\n    var existingElement = bucket[i];\n    if (element.equals(existingElement)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n// Returns the number of elements in the set.\nSet.prototype.size = function() {\n  return this._size;\n};\n\n// Removes all elements from the set.\nSet.prototype.clear = function() {\n  for (var i = 0; i < this._capacity; i++) {\n    this._buckets[i].length = 0;\n  }\n  this._size = 0;\n};\n\n// Calls fn(element) for each element in the set, in an unspecified order.\n// Returns the number of times fn was called.\n// The result is unspecified if the set is mutated during iteration.\nSet.prototype.forEach = function(fn) {\n  var count = 0;\n  for (var i = 0; i < this._capacity; i++) {\n    var bucket = this._buckets[i];\n    for (var j = 0; j < bucket.length; j++) {\n      fn(bucket[j]);\n      count += 1;\n    }\n  }\n  return count;\n};\n\nmodule.exports = Set;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Set = require('./collections/Set');\n\n/**\n * @class TileSearcher\n * @classdesc\n *\n * A TileSearcher performs searches for visible tiles.\n */\nfunction TileSearcher() {\n  // Stack of tiles to be explored.\n  this._stack = [];\n\n  // Set of already explored tiles.\n  this._visited = new Set();\n\n  // Tile vertices. Allocated by Tile#vertices on first use.\n  this._vertices = null;\n}\n\n/**\n * Performs a search for visible tiles by starting at a given tile and\n * recursively exploring neighbors until no more visible tiles are found.\n *\n * @param {View} view The view used to deem whether a tile is visible.\n * @param {Tile} tile The starting tile.\n * @param {Tile[]} result An array to append the visible tiles to, including the\n *     starting tile when visible. Existing array members are preserved.\n * @return {number} The number of visible tiles found.\n */\nTileSearcher.prototype.search = function(view, startingTile, result) {\n  var stack = this._stack;\n  var visited = this._visited;\n  var vertices = this._vertices;\n\n  var count = 0;\n\n  // Clear internal state.\n  this._clear();\n\n  stack.push(startingTile);\n\n  while (stack.length > 0) {\n    var tile = stack.pop();\n\n    if (visited.has(tile)) {\n      // Skip already visited tile.\n      continue;\n    }\n\n    if (!view.intersects(tile.vertices(vertices))) {\n      // Skip non-visible tile.\n      continue;\n    }\n\n    // Mark tile as visited.\n    visited.add(tile);\n\n    // Add neighbors to the stack of tiles to explore.\n    var neighbors = tile.neighbors();\n    for (var i = 0; i < neighbors.length; i++) {\n      stack.push(neighbors[i]);\n    }\n\n    // Add to result.\n    result.push(tile);\n\n    count++;\n  }\n\n  // Reuse the vertices array in future searches.\n  this._vertices = vertices;\n\n  // Clear internal state.\n  this._clear();\n\n  return count;\n};\n\nTileSearcher.prototype._clear = function() {\n  this._stack.length = 0;\n  this._visited.clear();\n};\n\nmodule.exports = TileSearcher;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mod = require('../util/mod');\n\n// An LruMap holds up to a maximum number of key-value pairs, ordered by their\n// time of insertion. When the addition of a key-value pair would cause the\n// capacity to be exceeded, the oldest key-value pair in the set is evicted.\n// As a special case, an LruMap with zero capacity always rejects the insertion\n// of a key-value pair.\n//\n// Keys must implement hash() and equals(). Note that the implementation doesn't\n// currently use hash(), but a future version might.\nfunction LruMap(capacity) {\n  if (!isFinite(capacity) || Math.floor(capacity) !== capacity || capacity < 0) {\n    throw new Error('LruMap: invalid capacity');\n  }\n  this._capacity = capacity;\n\n  // Keys and values are stored in circular arrays ordered by decreasing age.\n  // Start is the index of the oldest key/value and size is the number of valid\n  // key/values; the region containing valid keys/values may wrap around.\n  this._keys = new Array(this._capacity);\n  this._values = new Array(this._capacity);\n  this._start = 0;\n  this._size = 0;\n}\n\nLruMap.prototype._index = function(i) {\n  return mod(this._start + i, this._capacity);\n};\n\n// Returns the value associated to the specified key, or null if not found.\nLruMap.prototype.get = function(key) {\n  for (var i = 0; i < this._size; i++) {\n    var existingKey = this._keys[this._index(i)];\n    if (key.equals(existingKey)) {\n      return this._values[this._index(i)];\n    }\n  }\n  return null;\n};\n\n// Associates the specified value with the specified key, possibly replacing the\n// currently associated value. The key-value pair becomes the newest. If the map\n// is at capacity, the oldest key-value pair is removed. Returns the removed\n// key, or null otherwise. If the capacity is zero, does nothing and returns\n// the key.\nLruMap.prototype.set = function(key, value) {\n  if (this._capacity === 0) {\n    return key;\n  }\n  this.del(key);\n  var evictedKey =\n      this._size === this._capacity ? this._keys[this._index(0)] : null;\n  this._keys[this._index(this._size)] = key;\n  this._values[this._index(this._size)] = value;\n  if (this._size < this._capacity) {\n    this._size++;\n  } else {\n    this._start = this._index(1);\n  }\n  return evictedKey;\n};\n\n// Removes the key-value pair associated with the specified key.\n// Returns the removed value, or null if not found.\nLruMap.prototype.del = function(key) {\n  for (var i = 0; i < this._size; i++) {\n    if (key.equals(this._keys[this._index(i)])) {\n      var existingValue = this._values[this._index(i)];\n      for (var j = i; j < this._size - 1; j++) {\n        this._keys[this._index(j)] = this._keys[this._index(j + 1)];\n        this._values[this._index(j)] = this._values[this._index(j + 1)];\n      }\n      this._size--;\n      return existingValue;\n    }\n  }\n  return null;\n};\n\n// Returns whether there is a value associated with the specified key.\nLruMap.prototype.has = function(key) {\n  for (var i = 0; i < this._size; i++) {\n    if (key.equals(this._keys[this._index(i)])) {\n      return true;\n    }\n  }\n  return false;\n};\n\n// Returns the number of key-value pairs in the map.\nLruMap.prototype.size = function() {\n  return this._size;\n};\n\n// Removes all key-value pairs from the map.\nLruMap.prototype.clear = function() {\n  this._keys.length = 0;\n  this._values.length = 0;\n  this._start = 0;\n  this._size = 0;\n};\n\n// Calls fn(key, value) for each item in the map, in an unspecified order.\n// Returns the number of times fn was called.\n// The result is unspecified if the map is mutated during iteration.\nLruMap.prototype.forEach = function(fn) {\n  var count = 0;\n  for (var i = 0; i < this._size; i++) {\n    fn(this._keys[this._index(i)], this._values[this._index(i)]);\n    count += 1;\n  }\n  return count;\n};\n\nmodule.exports = LruMap;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction Level(levelProperties) {\n  this._fallbackOnly = !!levelProperties.fallbackOnly;\n}\n\nLevel.prototype.numHorizontalTiles = function() {\n  return Math.ceil(this.width() / this.tileWidth());\n};\n\nLevel.prototype.numVerticalTiles = function() {\n  return Math.ceil(this.height() / this.tileHeight());\n};\n\nLevel.prototype.fallbackOnly = function() {\n  return this._fallbackOnly;\n};\n\nmodule.exports = Level;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction cmp(x, y) {\n  if (x < y) {\n    return -1;\n  }\n  if (x > y) {\n    return 1;\n  }\n  return 0;\n}\n\nmodule.exports = cmp;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar cmp = require('../util/cmp');\n\nfunction makeLevelList(levelPropertiesList, LevelClass) {\n  var list = [];\n\n  for (var i = 0; i < levelPropertiesList.length; i++) {\n    list.push(new LevelClass(levelPropertiesList[i]));\n  }\n\n  list.sort(function(level1, level2) {\n    return cmp(level1.width(), level2.width());\n  });\n\n  return list;\n}\n\nfunction makeSelectableLevelList(levelList) {\n  var list = [];\n\n  for (var i = 0; i < levelList.length; i++) {\n    if (!levelList[i]._fallbackOnly) {\n      list.push(levelList[i]);\n    }\n  }\n\n  if (!list.length) {\n    throw new Error('No selectable levels in list');\n  }\n\n  return list;\n}\n\nmodule.exports = {\n  makeLevelList: makeLevelList,\n  makeSelectableLevelList: makeSelectableLevelList\n};\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction type(x) {\n  var typ = typeof x;\n  if (typ === 'object') {\n    if (x === null) {\n      return 'null';\n    }\n    if (Object.prototype.toString.call(x) === '[object Array]') {\n      return 'array';\n    }\n    if (Object.prototype.toString.call(x) === '[object RegExp]') {\n      return 'regexp';\n    }\n  }\n  return typ;\n}\n\nmodule.exports = type;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar inherits = require('../util/inherits');\nvar hash = require('../util/hash');\nvar TileSearcher = require('../TileSearcher');\nvar LruMap = require('../collections/LruMap');\nvar Level = require('./Level');\nvar makeLevelList = require('./common').makeLevelList;\nvar makeSelectableLevelList = require('./common').makeSelectableLevelList;\nvar clamp = require('../util/clamp');\nvar cmp = require('../util/cmp');\nvar type = require('../util/type');\nvar vec3 = require('gl-matrix').vec3;\nvar vec4 = require('gl-matrix').vec4;\n\nvar neighborsCacheSize = 64;\n\n// Initials for cube faces.\nvar faceList = 'fudlrb';\n\n// Rotation of each face, relative to the front face.\nvar faceRotation = {\n  f: { x: 0, y: 0 },\n  b: { x: 0, y: Math.PI },\n  l: { x: 0, y: Math.PI/2 },\n  r: { x: 0, y: -Math.PI/2 },\n  u: { x: Math.PI/2, y: 0 },\n  d: { x: -Math.PI/2, y: 0 }\n};\n\n// Zero vector.\nvar origin = vec3.create();\n\n// Rotate a vector in ZXY order.\nfunction rotateVector(vec, z, x, y) {\n  if (z) {\n    vec3.rotateZ(vec, vec, origin, z);\n  }\n  if (x) {\n    vec3.rotateX(vec, vec, origin, x);\n  }\n  if (y) {\n    vec3.rotateY(vec, vec, origin, y);\n  }\n}\n\n// Normalized vectors pointing to the center of each face.\nvar faceVectors = {};\nfor (var i = 0; i < faceList.length; i++) {\n  var face = faceList[i];\n  var rotation = faceRotation[face];\n  var v = vec3.fromValues(0,  0, -1);\n  rotateVector(v, 0, rotation.x, rotation.y);\n  faceVectors[face] = v;\n}\n\n// Map each face to its adjacent faces.\n// The order is as suggested by the front face.\nvar adjacentFace = {\n  f: [ 'l', 'r', 'u', 'd' ],\n  b: [ 'r', 'l', 'u', 'd' ],\n  l: [ 'b', 'f', 'u', 'd' ],\n  r: [ 'f', 'b', 'u', 'd' ],\n  u: [ 'l', 'r', 'b', 'f' ],\n  d: [ 'l', 'r', 'f', 'b' ]\n};\n\n// Offsets to apply to the (x,y) coordinates of a tile to get its neighbors.\nvar neighborOffsets = [\n  [  0,  1 ], // top\n  [  1,  0 ], // right\n  [  0, -1 ], // bottom\n  [ -1,  0 ]  // left\n];\n\n\n/**\n * @class CubeTile\n * @implements Tile\n * @classdesc\n *\n * A tile in a @{CubeGeometry}.\n */\nfunction CubeTile(face, x, y, z, geometry) {\n  this.face = face;\n  this.x = x;\n  this.y = y;\n  this.z = z;\n  this._geometry = geometry;\n  this._level = geometry.levelList[z];\n}\n\n\nCubeTile.prototype.rotX = function() {\n  return faceRotation[this.face].x;\n};\n\n\nCubeTile.prototype.rotY = function() {\n  return faceRotation[this.face].y;\n};\n\n\nCubeTile.prototype.centerX = function() {\n  return (this.x + 0.5) / this._level.numHorizontalTiles() - 0.5;\n};\n\n\nCubeTile.prototype.centerY = function() {\n  return 0.5 - (this.y + 0.5) / this._level.numVerticalTiles();\n};\n\n\nCubeTile.prototype.scaleX = function() {\n  return 1 / this._level.numHorizontalTiles();\n};\n\n\nCubeTile.prototype.scaleY = function() {\n  return 1 / this._level.numVerticalTiles();\n};\n\n\nCubeTile.prototype.vertices = function(result) {\n  if (!result) {\n    result = [vec3.create(), vec3.create(), vec3.create(), vec3.create()];\n  }\n\n  var rot = faceRotation[this.face];\n\n  function makeVertex(vec, x, y) {\n    vec3.set(vec, x, y, -0.5);\n    rotateVector(vec, 0, rot.x, rot.y);\n  }\n\n  var left = this.centerX() - this.scaleX() / 2;\n  var right = this.centerX() + this.scaleX() / 2;\n  var bottom = this.centerY() - this.scaleY() / 2;\n  var top = this.centerY() + this.scaleY() / 2;\n\n  makeVertex(result[0], left, top);\n  makeVertex(result[1], right, top);\n  makeVertex(result[2], right, bottom);\n  makeVertex(result[3], left, bottom);\n\n  return result;\n};\n\n\nCubeTile.prototype.parent = function() {\n\n  if (this.z === 0) {\n    return null;\n  }\n\n  var face = this.face;\n  var z = this.z;\n  var x = this.x;\n  var y = this.y;\n\n  var geometry = this._geometry;\n  var level = geometry.levelList[z];\n  var parentLevel = geometry.levelList[z-1];\n\n  var tileX = Math.floor(x / level.numHorizontalTiles() * parentLevel.numHorizontalTiles());\n  var tileY = Math.floor(y / level.numVerticalTiles() * parentLevel.numVerticalTiles());\n  var tileZ = z-1;\n\n  return new CubeTile(face, tileX, tileY, tileZ, geometry);\n\n};\n\n\nCubeTile.prototype.children = function(result) {\n\n  if (this.z === this._geometry.levelList.length - 1) {\n    return null;\n  }\n\n  var face = this.face;\n  var z = this.z;\n  var x = this.x;\n  var y = this.y;\n\n  var geometry = this._geometry;\n  var level = geometry.levelList[z];\n  var childLevel = geometry.levelList[z+1];\n\n  var nHoriz = childLevel.numHorizontalTiles() / level.numHorizontalTiles();\n  var nVert = childLevel.numVerticalTiles() / level.numVerticalTiles();\n\n  result = result || [];\n\n  for (var h = 0; h < nHoriz; h++) {\n    for (var v = 0; v < nVert; v++) {\n      var tileX = nHoriz * x + h;\n      var tileY = nVert * y + v;\n      var tileZ = z+1;\n      result.push(new CubeTile(face, tileX, tileY, tileZ, geometry));\n    }\n  }\n\n  return result;\n\n};\n\n\nCubeTile.prototype.neighbors = function() {\n\n  var geometry = this._geometry;\n  var cache = geometry._neighborsCache;\n\n  // Satisfy from cache when available.\n  var cachedResult = cache.get(this);\n  if (cachedResult) {\n    return cachedResult;\n  }\n\n  var vec = geometry._vec;\n\n  var face = this.face;\n  var x = this.x;\n  var y = this.y;\n  var z = this.z;\n  var level = this._level;\n\n  var numX = level.numHorizontalTiles();\n  var numY = level.numVerticalTiles();\n\n  var result = [];\n\n  for (var i = 0; i < neighborOffsets.length; i++) {\n    var xOffset = neighborOffsets[i][0];\n    var yOffset = neighborOffsets[i][1];\n\n    var newX = x + xOffset;\n    var newY = y + yOffset;\n    var newZ = z;\n    var newFace = face;\n\n    if (newX < 0 || newX >= numX || newY < 0 || newY >= numY) {\n\n      // If the neighboring tile belongs to a different face, calculate a\n      // vector pointing to the edge between the two faces at the point the\n      // tile and its neighbor meet, and convert it into tile coordinates for\n      // the neighboring face.\n\n      var xCoord = this.centerX();\n      var yCoord = this.centerY();\n\n      // First, calculate the vector as if the initial tile belongs to the\n      // front face, so that the tile x,y coordinates map directly into the\n      // x,y axes.\n\n      if (newX < 0) {\n        vec3.set(vec, -0.5, yCoord, -0.5);\n        newFace = adjacentFace[face][0];\n      } else if (newX >= numX) {\n        vec3.set(vec, 0.5, yCoord, -0.5);\n        newFace = adjacentFace[face][1];\n      } else if (newY < 0) {\n        vec3.set(vec, xCoord, 0.5, -0.5);\n        newFace = adjacentFace[face][2];\n      } else if (newY >= numY) {\n        vec3.set(vec, xCoord, -0.5, -0.5);\n        newFace = adjacentFace[face][3];\n      }\n\n      var rot;\n\n      // Then, rotate the vector into the actual face the initial tile\n      // belongs to.\n\n      rot = faceRotation[face];\n      rotateVector(vec, 0, rot.x, rot.y);\n\n      // Finally, rotate the vector from the neighboring face into the front\n      // face. Again, this is so that the neighboring tile x,y coordinates\n      // map directly into the x,y axes.\n\n      rot = faceRotation[newFace];\n      rotateVector(vec, 0, -rot.x, -rot.y);\n\n      // Calculate the neighboring tile coordinates.\n\n      newX = clamp(Math.floor((0.5 + vec[0]) * numX), 0, numX - 1);\n      newY = clamp(Math.floor((0.5 - vec[1]) * numY), 0, numY - 1);\n    }\n\n    result.push(new CubeTile(newFace, newX, newY, newZ, geometry));\n  }\n\n  // Store into cache to satisfy future requests.\n  cache.set(this, result);\n\n  return result;\n\n};\n\n\nCubeTile.prototype.hash = function() {\n  return hash(faceList.indexOf(this.face), this.z, this.y, this.x);\n};\n\n\nCubeTile.prototype.equals = function(that) {\n  return (this._geometry === that._geometry &&\n      this.face === that.face &&\n      this.z === that.z &&\n      this.y === that.y &&\n      this.x === that.x);\n};\n\n\nCubeTile.prototype.cmp = function(that) {\n  return (cmp(this.z, that.z) ||\n  cmp(faceList.indexOf(this.face), faceList.indexOf(that.face)) ||\n  cmp(this.y, that.y) || cmp(this.x, that.x));\n};\n\n\nCubeTile.prototype.str = function() {\n  return 'CubeTile(' + tile.face + ', ' + tile.x + ', ' + tile.y + ', ' + tile.z + ')';\n};\n\n\nfunction CubeLevel(levelProperties) {\n  this.constructor.super_.call(this, levelProperties);\n\n  this._size = levelProperties.size;\n  this._tileSize = levelProperties.tileSize;\n\n  if (this._size % this._tileSize !== 0) {\n    throw new Error('Level size is not multiple of tile size: ' +\n                    this._size + ' ' + this._tileSize);\n  }\n}\n\ninherits(CubeLevel, Level);\n\n\nCubeLevel.prototype.width = function() {\n  return this._size;\n};\n\n\nCubeLevel.prototype.height = function() {\n  return this._size;\n};\n\n\nCubeLevel.prototype.tileWidth = function() {\n  return this._tileSize;\n};\n\n\nCubeLevel.prototype.tileHeight = function() {\n  return this._tileSize;\n};\n\n\nCubeLevel.prototype._validateWithParentLevel = function(parentLevel) {\n\n  var width = this.width();\n  var height = this.height();\n  var tileWidth = this.tileWidth();\n  var tileHeight = this.tileHeight();\n  var numHorizontal = this.numHorizontalTiles();\n  var numVertical = this.numVerticalTiles();\n\n  var parentWidth = parentLevel.width();\n  var parentHeight = parentLevel.height();\n  var parentTileWidth = parentLevel.tileWidth();\n  var parentTileHeight = parentLevel.tileHeight();\n  var parentNumHorizontal = parentLevel.numHorizontalTiles();\n  var parentNumVertical = parentLevel.numVerticalTiles();\n\n  if (width % parentWidth !== 0) {\n    throw new Error('Level width must be multiple of parent level: ' +\n                    width + ' vs. ' + parentWidth);\n  }\n\n  if (height % parentHeight !== 0) {\n    throw new Error('Level height must be multiple of parent level: ' +\n                    height + ' vs. ' + parentHeight);\n  }\n\n  if (numHorizontal % parentNumHorizontal !== 0) {\n    throw new Error('Number of horizontal tiles must be multiple of parent level: ' +\n      numHorizontal + \" (\" + width + '/' + tileWidth + ')' + \" vs. \" +\n      parentNumHorizontal + \" (\" + parentWidth + '/' + parentTileWidth + ')');\n  }\n\n  if (numVertical % parentNumVertical !== 0) {\n    throw new Error('Number of vertical tiles must be multiple of parent level: ' +\n      numVertical + \" (\" + height + '/' + tileHeight + ')' + \" vs. \" +\n      parentNumVertical + \" (\" + parentHeight + '/' + parentTileHeight + ')');\n  }\n\n};\n\n\n/**\n * @class CubeGeometry\n * @implements Geometry\n * @classdesc\n *\n * A {@link Geometry} implementation suitable for tiled cube images with\n * multiple resolution levels.\n *\n * The following restrictions apply:\n *   - All tiles in a level must be square and form a rectangular grid;\n *   - The size of a level must be a multiple of the tile size;\n *   - The size of a level must be a multiple of the parent level size;\n *   - The number of tiles in a level must be a multiple of the number of tiles\n *     in the parent level.\n *\n * @param {Object[]} levelPropertiesList Level description\n * @param {number} levelPropertiesList[].size Cube face size in pixels\n * @param {number} levelPropertiesList[].tileSize Tile size in pixels\n */\nfunction CubeGeometry(levelPropertiesList) {\n  if (type(levelPropertiesList) !== 'array') {\n    throw new Error('Level list must be an array');\n  }\n\n  this.levelList = makeLevelList(levelPropertiesList, CubeLevel);\n  this.selectableLevelList = makeSelectableLevelList(this.levelList);\n\n  for (var i = 1; i < this.levelList.length; i++) {\n    this.levelList[i]._validateWithParentLevel(this.levelList[i-1]);\n  }\n\n  this._tileSearcher = new TileSearcher(this);\n\n  this._neighborsCache = new LruMap(neighborsCacheSize);\n\n  this._vec = vec4.create();\n\n  this._viewSize = {};\n}\n\n\nCubeGeometry.prototype.maxTileSize = function() {\n  var maxTileSize = 0;\n  for (var i = 0; i < this.levelList.length; i++) {\n    var level = this.levelList[i];\n    maxTileSize = Math.max(maxTileSize, level.tileWidth, level.tileHeight);\n  }\n  return maxTileSize;\n};\n\n\nCubeGeometry.prototype.levelTiles = function(level, result) {\n\n  var levelIndex = this.levelList.indexOf(level);\n  var maxX = level.numHorizontalTiles() - 1;\n  var maxY = level.numVerticalTiles() - 1;\n\n  result = result || [];\n\n  for (var f = 0; f < faceList.length; f++) {\n    var face = faceList[f];\n    for (var x = 0; x <= maxX; x++) {\n      for (var y = 0; y <= maxY; y++) {\n        result.push(new CubeTile(face, x, y, levelIndex, this));\n      }\n    }\n  }\n\n  return result;\n\n};\n\n\nCubeGeometry.prototype._closestTile = function(view, level) {\n  var ray = this._vec;\n\n  // Compute a view ray into the central screen point.\n  vec4.set(ray, 0, 0, 1, 1);\n  vec4.transformMat4(ray, ray, view.inverseProjection());\n\n  var minAngle = Infinity;\n  var closestFace = null;\n\n  // Find the face whose vector makes a minimal angle with the view ray.\n  // This is the face into which the view ray points.\n  for (var face in faceVectors) {\n    var vector = faceVectors[face];\n    // For a small angle between two normalized vectors, angle ~ 1-cos(angle).\n    var angle = 1 - vec3.dot(vector, ray);\n    if (angle < minAngle) {\n      minAngle = angle;\n      closestFace = face;\n    }\n  }\n\n  // Project view ray onto cube, i.e., normalize the coordinate with\n  // largest absolute value to ±0.5.\n  var max = Math.max(Math.abs(ray[0]), Math.abs(ray[1]), Math.abs(ray[2])) / 0.5;\n  for (var i = 0; i < 3; i++) {\n    ray[i] = ray[i] / max;\n  }\n\n  // Rotate view ray into front face.\n  var rot = faceRotation[closestFace];\n  rotateVector(ray, 0, -rot.x, -rot.y);\n\n  // Get the desired zoom level.\n  var tileZ = this.levelList.indexOf(level);\n  var numX = level.numHorizontalTiles();\n  var numY = level.numVerticalTiles();\n\n  // Find the coordinates of the tile that the view ray points into.\n  var tileX = clamp(Math.floor((0.5 + ray[0]) * numX), 0, numX - 1);\n  var tileY = clamp(Math.floor((0.5 - ray[1]) * numY), 0, numY - 1);\n\n  return new CubeTile(closestFace, tileX, tileY, tileZ, this);\n};\n\n\nCubeGeometry.prototype.visibleTiles = function(view, level, result) {\n  var viewSize = this._viewSize;\n  var tileSearcher = this._tileSearcher;\n\n  result = result || [];\n\n  view.size(viewSize);\n  if (viewSize.width === 0 || viewSize.height === 0) {\n    // No tiles are visible if the viewport is empty.\n    return result;\n  }\n\n  var startingTile = this._closestTile(view, level);\n  var count = tileSearcher.search(view, startingTile, result);\n  if (!count) {\n    throw new Error('Starting tile is not visible');\n  }\n\n  return result;\n};\n\n\nCubeGeometry.Tile = CubeGeometry.prototype.Tile = CubeTile;\nCubeGeometry.type = CubeGeometry.prototype.type = 'cube';\nCubeTile.type = CubeTile.prototype.type = 'cube';\n\n\nmodule.exports = CubeGeometry;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar inherits = require('../util/inherits');\nvar hash = require('../util/hash');\nvar TileSearcher = require('../TileSearcher');\nvar LruMap = require('../collections/LruMap');\nvar Level = require('./Level');\nvar makeLevelList = require('./common').makeLevelList;\nvar makeSelectableLevelList = require('./common').makeSelectableLevelList;\nvar clamp = require('../util/clamp');\nvar mod = require('../util/mod');\nvar cmp = require('../util/cmp');\nvar type = require('../util/type');\nvar vec2 = require('gl-matrix').vec2;\nvar vec4 = require('gl-matrix').vec4;\n\nvar neighborsCacheSize = 64;\n\n// Offsets to apply to the (x,y) coordinates of a tile to get its neighbors.\nvar neighborOffsets = [\n  [  0,  1 ], // top\n  [  1,  0 ], // right\n  [  0, -1 ], // bottom\n  [ -1,  0 ]  // left\n];\n\n\n/**\n * @class FlatTile\n * @implements Tile\n * @classdesc\n *\n * A tile in a {@link FlatGeometry}.\n */\nfunction FlatTile(x, y, z, geometry) {\n  this.x = x;\n  this.y = y;\n  this.z = z;\n  this._geometry = geometry;\n  this._level = geometry.levelList[z];\n}\n\n\nFlatTile.prototype.rotX = function() {\n  return 0;\n};\n\n\nFlatTile.prototype.rotY = function() {\n  return 0;\n};\n\n\nFlatTile.prototype.centerX = function() {\n  var levelWidth = this._level.width();\n  var tileWidth = this._level.tileWidth();\n  return (this.x * tileWidth + 0.5 * this.width()) / levelWidth - 0.5;\n};\n\n\nFlatTile.prototype.centerY = function() {\n  var levelHeight = this._level.height();\n  var tileHeight = this._level.tileHeight();\n  return 0.5 - (this.y * tileHeight + 0.5 * this.height()) / levelHeight;\n};\n\n\nFlatTile.prototype.scaleX = function() {\n  var levelWidth = this._level.width();\n  return this.width() / levelWidth;\n};\n\n\nFlatTile.prototype.scaleY = function() {\n  var levelHeight = this._level.height();\n  return this.height() / levelHeight;\n};\n\n\nFlatTile.prototype.width = function() {\n  var levelWidth = this._level.width();\n  var tileWidth = this._level.tileWidth();\n  if (this.x === this._level.numHorizontalTiles() - 1) {\n    var widthRemainder = mod(levelWidth, tileWidth);\n    return widthRemainder || tileWidth;\n  } else {\n    return tileWidth;\n  }\n};\n\n\nFlatTile.prototype.height = function() {\n  var levelHeight = this._level.height();\n  var tileHeight = this._level.tileHeight();\n  if (this.y === this._level.numVerticalTiles() - 1) {\n    var heightRemainder = mod(levelHeight, tileHeight);\n    return heightRemainder || tileHeight;\n  } else {\n    return tileHeight;\n  }\n};\n\n\nFlatTile.prototype.levelWidth = function() {\n  return this._level.width();\n};\n\n\nFlatTile.prototype.levelHeight = function() {\n  return this._level.height();\n};\n\n\nFlatTile.prototype.vertices = function(result) {\n  if (!result) {\n    result = [vec2.create(), vec2.create(), vec2.create(), vec2.create()];\n  }\n\n  var left = this.centerX() - this.scaleX() / 2;\n  var right = this.centerX() + this.scaleX() / 2;\n  var bottom = this.centerY() - this.scaleY() / 2;\n  var top = this.centerY() + this.scaleY() / 2;\n\n  vec2.set(result[0], left, top);\n  vec2.set(result[1], right, top);\n  vec2.set(result[2], right, bottom);\n  vec2.set(result[3], left, bottom);\n\n  return result;\n};\n\n\nFlatTile.prototype.parent = function() {\n\n\n  if (this.z === 0) {\n    return null;\n  }\n\n  var geometry = this._geometry;\n\n  var z = this.z - 1;\n  // TODO: Currently assuming each level is double the size of previous one.\n  // Fix to support other multiples.\n  var x = Math.floor(this.x / 2);\n  var y = Math.floor(this.y / 2);\n\n  return new FlatTile(x, y, z, geometry);\n\n};\n\n\nFlatTile.prototype.children = function(result) {\n  if (this.z === this._geometry.levelList.length - 1) {\n    return null;\n  }\n\n  var geometry = this._geometry;\n  var z = this.z + 1;\n\n  result = result || [];\n\n  // TODO: Currently assuming each level is double the size of previous one.\n  // Fix to support other multiples.\n  result.push(new FlatTile(2*this.x  , 2*this.y  , z, geometry));\n  result.push(new FlatTile(2*this.x  , 2*this.y+1, z, geometry));\n  result.push(new FlatTile(2*this.x+1, 2*this.y  , z, geometry));\n  result.push(new FlatTile(2*this.x+1, 2*this.y+1, z, geometry));\n\n  return result;\n\n};\n\n\nFlatTile.prototype.neighbors = function() {\n\n  var geometry = this._geometry;\n  var cache = geometry._neighborsCache;\n\n  // Satisfy from cache when available.\n  var cachedResult = cache.get(this);\n  if (cachedResult) {\n    return cachedResult;\n  }\n\n  var x = this.x;\n  var y = this.y;\n  var z = this.z;\n  var level = this._level;\n\n  var numX = level.numHorizontalTiles() - 1;\n  var numY = level.numVerticalTiles() - 1;\n\n  var result = [];\n\n  for (var i = 0; i < neighborOffsets.length; i++) {\n    var xOffset = neighborOffsets[i][0];\n    var yOffset = neighborOffsets[i][1];\n\n    var newX = x + xOffset;\n    var newY = y + yOffset;\n    var newZ = z;\n\n    if (0 <= newX && newX <= numX && 0 <= newY && newY <= numY) {\n      result.push(new FlatTile(newX, newY, newZ, geometry));\n    }\n  }\n\n  // Store into cache to satisfy future requests.\n  cache.set(this, result);\n\n  return result;\n\n};\n\n\nFlatTile.prototype.hash = function() {\n  return hash(this.z, this.y, this.x);\n};\n\n\nFlatTile.prototype.equals = function(that) {\n  return (this._geometry === that._geometry &&\n      this.z === that.z && this.y === that.y && this.x === that.x);\n};\n\n\nFlatTile.prototype.cmp = function(that) {\n  return (cmp(this.z, that.z) || cmp(this.y, that.y) || cmp(this.x, that.x));\n};\n\n\nFlatTile.prototype.str = function() {\n  return 'FlatTile(' + tile.x + ', ' + tile.y + ', ' + tile.z + ')';\n};\n\n\nfunction FlatLevel(levelProperties) {\n  this.constructor.super_.call(this, levelProperties);\n\n  this._width = levelProperties.width;\n  this._height = levelProperties.height;\n  this._tileWidth = levelProperties.tileWidth;\n  this._tileHeight = levelProperties.tileHeight;\n}\n\ninherits(FlatLevel, Level);\n\n\nFlatLevel.prototype.width = function() {\n  return this._width;\n};\n\n\nFlatLevel.prototype.height = function() {\n  return this._height;\n};\n\n\nFlatLevel.prototype.tileWidth = function() {\n  return this._tileWidth;\n};\n\n\nFlatLevel.prototype.tileHeight = function() {\n  return this._tileHeight;\n};\n\n\nFlatLevel.prototype._validateWithParentLevel = function(parentLevel) {\n\n  var width = this.width();\n  var height = this.height();\n  var tileWidth = this.tileWidth();\n  var tileHeight = this.tileHeight();\n\n  var parentWidth = parentLevel.width();\n  var parentHeight = parentLevel.height();\n  var parentTileWidth = parentLevel.tileWidth();\n  var parentTileHeight = parentLevel.tileHeight();\n\n  if (width % parentWidth !== 0) {\n    return new Error('Level width must be multiple of parent level: ' +\n                     width + ' vs. ' + parentWidth);\n  }\n\n  if (height % parentHeight !== 0) {\n    return new Error('Level height must be multiple of parent level: ' +\n                     height + ' vs. ' + parentHeight);\n  }\n\n  if (tileWidth % parentTileWidth !== 0) {\n    return new Error('Level tile width must be multiple of parent level: ' +\n                     tileWidth + ' vs. ' + parentTileWidth);\n  }\n\n  if (tileHeight % parentTileHeight !== 0) {\n    return new Error('Level tile height must be multiple of parent level: ' +\n                     tileHeight + ' vs. ' + parentTileHeight);\n  }\n\n};\n\n\n/**\n * @class FlatGeometry\n * @implements Geometry\n * @classdesc\n *\n * A {@link Geometry} implementation suitable for tiled flat images with\n * multiple resolution levels.\n *\n * The following restrictions apply:\n *   - All tiles must be square, except when in the last row or column position,\n *     and must form a rectangular grid;\n *   - The width and height of a level must be multiples of the parent level\n *     width and height.\n *\n * @param {Object[]} levelPropertiesList Level description\n * @param {number} levelPropertiesList[].width Level width in pixels\n * @param {number} levelPropertiesList[].tileWidth Tile width in pixels for\n *                 square tiles\n * @param {number} levelPropertiesList[].height Level height in pixels\n * @param {number} levelPropertiesList[].tileHeight Tile height in pixels for\n *                 square tiles\n */\nfunction FlatGeometry(levelPropertiesList) {\n  if (type(levelPropertiesList) !== 'array') {\n    throw new Error('Level list must be an array');\n  }\n\n  this.levelList = makeLevelList(levelPropertiesList, FlatLevel);\n  this.selectableLevelList = makeSelectableLevelList(this.levelList);\n\n  for (var i = 1; i < this.levelList.length; i++) {\n    this.levelList[i]._validateWithParentLevel(this.levelList[i-1]);\n  }\n\n  this._tileSearcher = new TileSearcher(this);\n\n  this._neighborsCache = new LruMap(neighborsCacheSize);\n\n  this._vec = vec4.create();\n\n  this._viewSize = {};\n}\n\n\nFlatGeometry.prototype.maxTileSize = function() {\n  var maxTileSize = 0;\n  for (var i = 0; i < this.levelList.length; i++) {\n    var level = this.levelList[i];\n    maxTileSize = Math.max(maxTileSize, level.tileWidth, level.tileHeight);\n  }\n  return maxTileSize;\n};\n\n\nFlatGeometry.prototype.levelTiles = function(level, result) {\n\n  var levelIndex = this.levelList.indexOf(level);\n  var maxX = level.numHorizontalTiles() - 1;\n  var maxY = level.numVerticalTiles() - 1;\n\n  if (!result) {\n    result = [];\n  }\n\n  for (var x = 0; x <= maxX; x++) {\n    for (var y = 0; y <= maxY; y++) {\n      result.push(new FlatTile(x, y, levelIndex, this));\n    }\n  }\n\n  return result;\n\n};\n\n\nFlatGeometry.prototype._closestTile = function(view, level) {\n  var ray = this._vec;\n\n  // Compute a view ray into the central screen point.\n  vec4.set(ray, 0, 0, 1, 1);\n  vec4.transformMat4(ray, ray, view.inverseProjection());\n\n  // Compute the image coordinates that the view ray points into.\n  var x = 0.5 + ray[0];\n  var y = 0.5 - ray[1];\n\n  // Get the desired zoom level.\n  var tileZ = this.levelList.indexOf(level);\n  var levelWidth = level.width();\n  var levelHeight = level.height();\n  var tileWidth = level.tileWidth();\n  var tileHeight = level.tileHeight();\n  var numX = level.numHorizontalTiles();\n  var numY = level.numVerticalTiles();\n\n  // Find the coordinates of the tile that the view ray points into.\n  var tileX = clamp(Math.floor(x * levelWidth / tileWidth), 0, numX - 1);\n  var tileY = clamp(Math.floor(y * levelHeight / tileHeight), 0, numY - 1);\n\n  return new FlatTile(tileX, tileY, tileZ, this);\n};\n\n\nFlatGeometry.prototype.visibleTiles = function(view, level, result) {\n  var viewSize = this._viewSize;\n  var tileSearcher = this._tileSearcher;\n\n  result = result || [];\n\n  view.size(viewSize);\n  if (viewSize.width === 0 || viewSize.height === 0) {\n    // No tiles are visible if the viewport is empty.\n    return result;\n  }\n\n  var startingTile = this._closestTile(view, level);\n  var count = tileSearcher.search(view, startingTile, result);\n  if (!count) {\n    throw new Error('Starting tile is not visible');\n  }\n\n  return result;\n};\n\n\nFlatGeometry.Tile = FlatGeometry.prototype.Tile = FlatTile;\nFlatGeometry.type = FlatGeometry.prototype.type = 'flat';\nFlatTile.type = FlatTile.prototype.type = 'flat';\n\n\nmodule.exports = FlatGeometry;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar inherits = require('../util/inherits');\nvar hash = require('../util/hash');\nvar cmp = require('../util/cmp');\nvar common = require('./common');\nvar Level = require('./Level');\nvar type = require('../util/type');\n\n\n/**\n * @class EquirectTile\n * @implements Tile\n * @classdesc\n *\n * A tile in an @{EquirectGeometry}.\n */\nfunction EquirectTile(z, geometry) {\n  this.z = z;\n  this._geometry = geometry;\n  this._level = geometry.levelList[z];\n}\n\n\nEquirectTile.prototype.rotX = function() {\n  return 0;\n};\n\n\nEquirectTile.prototype.rotY = function() {\n  return 0;\n};\n\n\nEquirectTile.prototype.centerX = function() {\n  return 0.5;\n};\n\n\nEquirectTile.prototype.centerY = function() {\n  return 0.5;\n};\n\n\nEquirectTile.prototype.scaleX = function() {\n  return 1;\n};\n\n\nEquirectTile.prototype.scaleY = function() {\n  return 1;\n};\n\n\nEquirectTile.prototype.parent = function() {\n  if (this.z === 0) {\n    return null;\n  }\n  return new EquirectTile(this.z - 1, this._geometry);\n};\n\n\nEquirectTile.prototype.children = function(result) {\n  if (this.z === this._geometry.levelList.length - 1) {\n    return null;\n  }\n  result = result || [];\n  result.push(new EquirectTile(this.z + 1, this._geometry));\n  return result;\n};\n\n\nEquirectTile.prototype.neighbors = function() {\n  return [];\n};\n\n\nEquirectTile.prototype.hash = function() {\n  return hash(this.z);\n};\n\n\nEquirectTile.prototype.equals = function(that) {\n  return this._geometry === that._geometry && this.z === that.z;\n};\n\n\nEquirectTile.prototype.cmp = function(that) {\n  return cmp(this.z, that.z);\n};\n\n\nEquirectTile.prototype.str = function() {\n  return 'EquirectTile(' + tile.z + ')';\n};\n\n\nfunction EquirectLevel(levelProperties) {\n  this.constructor.super_.call(this, levelProperties);\n  this._width = levelProperties.width;\n}\n\ninherits(EquirectLevel, Level);\n\n\nEquirectLevel.prototype.width = function() {\n  return this._width;\n};\n\n\nEquirectLevel.prototype.height = function() {\n  return this._width/2;\n};\n\n\nEquirectLevel.prototype.tileWidth = function() {\n  return this._width;\n};\n\n\nEquirectLevel.prototype.tileHeight = function() {\n  return this._width/2;\n};\n\n\n/**\n * @class EquirectGeometry\n * @implements Geometry\n * @classdesc\n *\n * A {@link Geometry} implementation suitable for equirectangular images with a\n * 2:1 aspect ratio.\n *\n * @param {Object[]} levelPropertiesList Level description\n * @param {number} levelPropertiesList[].width Level width in pixels\n*/\nfunction EquirectGeometry(levelPropertiesList) {\n  if (type(levelPropertiesList) !== 'array') {\n    throw new Error('Level list must be an array');\n  }\n\n  this.levelList = common.makeLevelList(levelPropertiesList, EquirectLevel);\n  this.selectableLevelList = common.makeSelectableLevelList(this.levelList);\n}\n\n\nEquirectGeometry.prototype.maxTileSize = function() {\n  var maxTileSize = 0;\n  for (var i = 0; i < this.levelList.length; i++) {\n    var level = this.levelList[i];\n    maxTileSize = Math.max(maxTileSize, level.tileWidth, level.tileHeight);\n  }\n  return maxTileSize;\n};\n\n\nEquirectGeometry.prototype.levelTiles = function(level, result) {\n  var levelIndex = this.levelList.indexOf(level);\n  result = result || [];\n  result.push(new EquirectTile(levelIndex, this));\n  return result;\n};\n\n\nEquirectGeometry.prototype.visibleTiles = function(view, level, result) {\n  var tile = new EquirectTile(this.levelList.indexOf(level), this);\n  result = result || [];\n  result.length = 0;\n  result.push(tile);\n};\n\n\nEquirectGeometry.Tile = EquirectGeometry.prototype.Tile = EquirectTile;\nEquirectGeometry.type = EquirectGeometry.prototype.type = 'equirect';\nEquirectTile.type = EquirectTile.prototype.type = 'equirect';\n\n\nmodule.exports = EquirectGeometry;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * Convert fov\n *\n * For example, to convert from hfov to vfov one would call \n * `convert(hfov, width, height)`\n *\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction convert(fov, fromDimension, toDimension) {\n  return 2 * Math.atan(toDimension * Math.tan(fov / 2) / fromDimension);\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction htov(fov, width, height) {\n  return convert(fov, width, height);\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction htod(fov, width, height) {\n  return convert(fov, width, Math.sqrt(width * width + height * height));\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction vtoh(fov, width, height) {\n  return convert(fov, height, width);\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction vtod(fov, width, height) {\n  return convert(fov, height, Math.sqrt(width * width + height * height));\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction dtoh(fov, width, height) {\n  return convert(fov, Math.sqrt(width * width + height * height), width);\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction dtov(fov, width, height) {\n  return convert(fov, Math.sqrt(width * width + height * height), height);\n}\n\n/**\n * @namespace util.convertFov\n */\nmodule.exports = {\n  convert: convert,\n  htov: htov,\n  htod: htod,\n  vtoh: vtoh,\n  vtod: vtod,\n  dtoh: dtoh,\n  dtov: dtov\n};\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction real(x) {\n  return typeof x === 'number' && isFinite(x);\n}\n\nmodule.exports = real;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Convert a number to a string in decimal notation.\nfunction decimal(x) {\n  // Double-precision floats have 15 significant decimal digits.\n  return x.toPrecision(15);\n}\n\nmodule.exports = decimal;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n  * Compose multiple functions\n  *\n  * `compose(f, g)` returns `function(x) { return f(g(x)); }`\n  *\n  * @memberof util\n  * @param {Function[]} functions The functions to compose\n  * @return {Function}\n  */\nfunction compose() {\n  var fnList = arguments;\n  return function composed(initialArg) {\n    var ret = initialArg;\n    for (var i = 0; i < fnList.length; i++) {\n      var fn = fnList[i];\n      ret = fn.call(null, ret);\n    }\n    return ret;\n  };\n}\n\nmodule.exports = compose;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar mat4 = require('gl-matrix').mat4;\nvar vec4 = require('gl-matrix').vec4;\nvar pixelRatio = require('../util/pixelRatio');\nvar convertFov = require('../util/convertFov');\nvar mod = require('../util/mod');\nvar real = require('../util/real');\nvar clamp = require('../util/clamp');\nvar decimal = require('../util/decimal');\nvar compose = require('../util/compose');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n// Default viewport dimensions.\n// Start with zero to ensure that those values are handled correctly.\nvar defaultWidth = 0;\nvar defaultHeight = 0;\n\n// Default view parameters.\nvar defaultYaw = 0;\nvar defaultPitch = 0;\nvar defaultRoll = 0;\nvar defaultFov = Math.PI/4;\nvar defaultProjectionCenterX = 0;\nvar defaultProjectionCenterY = 0;\n\n// A fov of exactly 0 or π breaks some computations, so we constrain it to the\n// [fovLimitEpsilon, π - fovLimitEpsilon] interval. We use 6 decimal places for\n// the epsilon value to avoid broken rendering due to loss of precision in\n// floating point computations.\nvar fovLimitEpsilon = 0.000001;\n\n\n/**\n * @interface RectilinearViewParams\n *\n * A camera configuration for a {@link RectilinearView}.\n *\n * @property {number} yaw The yaw angle, in the [-π, π] range.\n *     When `yaw < 0`, the view rotates to the left.\n *     When `yaw > 0`, the view rotates to the right.\n *\n * @property {number} pitch The pitch angle, in the [-π, π] range.\n *     When `pitch < 0`, the view rotates downwards.\n *     When `pitch > 0`, the view rotates upwards.\n *\n * @property {number} roll The roll angle, in the [-π, π] range.\n *     When `roll < 0`, the view rotates clockwise.\n *     When `roll > 0`, the view rotates counter-clockwise.\n *\n * @property {fov} fov The vertical field of view, in the [0, π] range.\n */\n\n\n/**\n * @interface RectilinearViewCoords\n *\n * The position of a point in a 360° image.\n *\n * @property {number} yaw The yaw angle, in the [-π, π] range.\n * @property {number} pitch The pitch angle, in the [-π, π] range.\n */\n\n\n/**\n * @typedef {function} RectilinearViewLimiter\n *\n * View limiter for a {@link RectilinearView}.\n *\n * A view limiter is a function that receives a {@link RectilinearViewParams}\n * object, optionally modifies it in place, and returns it. It can be used to\n * enforce constraints on the view parameters.\n *\n * See {@link RectilinearView.limit} for commonly used limiters. They may be\n * composed together or with user-defined limiters with {@link util.compose}.\n *\n * @param {RectilinearViewParams} params\n * @return {RectilinearViewParams}\n */\n\n/**\n * @class RectilinearView\n * @implements View\n * @classdesc\n *\n * A {@link View} implementing a rectilinear projection for 360° images.\n *\n * @param {RectilinearViewParams=} params The initial view parameters. If\n *     unspecified, defaults to `{yaw: 0, pitch: 0, roll: 0, fov: Math.PI/4 }`.\n * @param {RectilinearViewLimiter=} limiter The view limiter. If unspecified,\n *     no view limiting is applied. See {@link RectilinearView.limit} for\n *     commonly used limiters.\n */\nfunction RectilinearView(params, limiter) {\n  // The initial values for the view parameters.\n  this._yaw = params && params.yaw != null ? params.yaw : defaultYaw;\n  this._pitch = params && params.pitch != null ? params.pitch : defaultPitch;\n  this._roll = params && params.roll != null ? params.roll : defaultRoll;\n  this._fov = params && params.fov != null ? params.fov : defaultFov;\n  this._width = params && params.width != null ?\n    params.width : defaultWidth;\n  this._height = params && params.height != null ?\n    params.height : defaultHeight;\n  this._projectionCenterX = params && params.projectionCenterX != null ?\n    params.projectionCenterX : defaultProjectionCenterX;\n  this._projectionCenterY = params && params.projectionCenterY != null ?\n    params.projectionCenterY : defaultProjectionCenterY;\n\n  // The initial value for the view limiter.\n  this._limiter = limiter || null;\n\n  // The last calculated projection matrix and its inverse.\n  this._projMatrix = mat4.create();\n  this._invProjMatrix = mat4.create();\n\n  // The last calculated view frustum.\n  this._frustum = [\n    vec4.create(), // left\n    vec4.create(), // right\n    vec4.create(), // bottom\n    vec4.create(), // top\n    vec4.create()  // camera\n  ];\n\n  // Whether the projection matrices and the view frustum need to be updated.\n  this._projectionChanged = true;\n\n  // Temporary variables used for calculations.\n  this._params = {};\n  this._fovs = {};\n  this._tmpVec = vec4.create();\n\n  // Force view limiting on initial parameters.\n  this._update();\n}\n\neventEmitter(RectilinearView);\n\n\n/**\n * Destructor.\n */\nRectilinearView.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\n\n/**\n * Get the yaw angle.\n * @return {number}\n */\nRectilinearView.prototype.yaw = function() {\n  return this._yaw;\n};\n\n\n/**\n * Get the pitch angle.\n * @return {number}\n */\nRectilinearView.prototype.pitch = function() {\n  return this._pitch;\n};\n\n\n/**\n * Get the roll angle.\n * @return {number}\n */\nRectilinearView.prototype.roll = function() {\n  return this._roll;\n};\n\n\nRectilinearView.prototype.projectionCenterX = function() {\n  return this._projectionCenterX;\n};\n\n\nRectilinearView.prototype.projectionCenterY = function() {\n  return this._projectionCenterY;\n};\n\n\n/**\n * Get the fov value.\n * @return {number}\n */\nRectilinearView.prototype.fov = function() {\n  return this._fov;\n};\n\n\n/**\n * Get the viewport width.\n * @return {number}\n */\nRectilinearView.prototype.width = function() {\n  return this._width;\n};\n\n\n/**\n * Get the viewport height.\n * @return {number}\n */\nRectilinearView.prototype.height = function() {\n  return this._height;\n};\n\n\n/**\n * Get the viewport dimensions. If an argument is supplied, it is filled in with\n * the result and returned. Otherwise, a fresh object is filled in and returned.\n * @param {Size=} size\n * @return {Size}\n */\nRectilinearView.prototype.size = function(size) {\n  size = size || {};\n  size.width = this._width;\n  size.height = this._height;\n  return size;\n};\n\n\n/**\n * Get the view parameters. If an argument is supplied, it is filled in with the\n * result and returned. Otherwise, a fresh object is filled in and returned.\n * @param {RectilinearViewParams=} obj\n * @return {RectilinearViewParams}\n */\nRectilinearView.prototype.parameters = function(params) {\n  params = params || {};\n  params.yaw = this._yaw;\n  params.pitch = this._pitch;\n  params.roll = this._roll;\n  params.fov = this._fov;\n  return params;\n};\n\n\n/**\n * Get the view limiter, or null if unset.\n * @return {?RectilinearViewLimiter}\n */\nRectilinearView.prototype.limiter = function() {\n  return this._limiter;\n};\n\n\n/**\n * Set the yaw angle.\n * @param {number} yaw\n */\nRectilinearView.prototype.setYaw = function(yaw) {\n  this._resetParams();\n  this._params.yaw = yaw;\n  this._update(this._params);\n};\n\n\n/**\n * Set the pitch angle.\n * @param {number} pitch\n */\nRectilinearView.prototype.setPitch = function(pitch) {\n  this._resetParams();\n  this._params.pitch = pitch;\n  this._update(this._params);\n};\n\n\n/**\n * Set the roll angle.\n * @param {number} roll\n */\nRectilinearView.prototype.setRoll = function(roll) {\n  this._resetParams();\n  this._params.roll = roll;\n  this._update(this._params);\n};\n\n\n/**\n * Set the fov value.\n * @param {number} fov\n */\nRectilinearView.prototype.setFov = function(fov) {\n  this._resetParams();\n  this._params.fov = fov;\n  this._update(this._params);\n};\n\n\nRectilinearView.prototype.setProjectionCenterX = function(projectionCenterX) {\n  this._resetParams();\n  this._params.projectionCenterX = projectionCenterX;\n  this._update(this._params);\n};\n\n\nRectilinearView.prototype.setProjectionCenterY = function(projectionCenterY) {\n  this._resetParams();\n  this._params.projectionCenterY = projectionCenterY;\n  this._update(this._params);\n};\n\n\n/**\n * Add yawOffset to the current yaw value.\n * @param {number} yawOffset\n */\nRectilinearView.prototype.offsetYaw = function(yawOffset) {\n  this.setYaw(this._yaw + yawOffset);\n};\n\n\n/**\n * Add pitchOffset to the current pitch value.\n * @param {number} pitchOffset\n */\nRectilinearView.prototype.offsetPitch = function(pitchOffset) {\n  this.setPitch(this._pitch + pitchOffset);\n};\n\n\n/**\n * Add rollOffset to the current roll value.\n * @param {number} rollOffset\n */\nRectilinearView.prototype.offsetRoll = function(rollOffset) {\n  this.setRoll(this._roll + rollOffset);\n};\n\n\n/**\n * Add fovOffset to the current fov value.\n * @param {number} fovOffset\n */\nRectilinearView.prototype.offsetFov = function(fovOffset) {\n  this.setFov(this._fov + fovOffset);\n};\n\n\n/**\n * Set the viewport dimensions.\n * @param {Size} size\n */\nRectilinearView.prototype.setSize = function(size) {\n  this._resetParams();\n  this._params.width = size.width;\n  this._params.height = size.height;\n  this._update(this._params);\n};\n\n\n/**\n * Set the view parameters. Unspecified parameters are left unchanged.\n * @param {RectilinearViewParameters} params\n */\nRectilinearView.prototype.setParameters = function(params) {\n  this._resetParams();\n  this._params.yaw = params.yaw;\n  this._params.pitch = params.pitch;\n  this._params.roll = params.roll;\n  this._params.fov = params.fov;\n  this._params.projectionCenterX = params.projectionCenterX;\n  this._params.projectionCenterY = params.projectionCenterY;\n  this._update(this._params);\n};\n\n\n/**\n * Set the view limiter.\n * @param {?RectilinearViewLimiter} limiter The new limiter, or null to unset.\n */\nRectilinearView.prototype.setLimiter = function(limiter) {\n  this._limiter = limiter || null;\n  this._update();\n};\n\n\nRectilinearView.prototype._resetParams = function() {\n  var params = this._params;\n  params.yaw = null;\n  params.pitch = null;\n  params.roll = null;\n  params.fov = null;\n  params.width = null;\n  params.height = null;\n};\n\n\nRectilinearView.prototype._update = function(params) {\n\n  // Avoid object allocation when no parameters are supplied.\n  if (params == null) {\n    this._resetParams();\n    params = this._params;\n  }\n\n  // Save old parameters for later comparison.\n  var oldYaw = this._yaw;\n  var oldPitch = this._pitch;\n  var oldRoll = this._roll;\n  var oldFov = this._fov;\n  var oldProjectionCenterX = this._projectionCenterX;\n  var oldProjectionCenterY = this._projectionCenterY;\n  var oldWidth = this._width;\n  var oldHeight = this._height;\n\n  // Fill in object with the new set of parameters to pass into the limiter.\n  params.yaw = params.yaw != null ? params.yaw : oldYaw;\n  params.pitch = params.pitch != null ? params.pitch : oldPitch;\n  params.roll = params.roll != null ? params.roll : oldRoll;\n  params.fov = params.fov != null ? params.fov : oldFov;\n  params.width = params.width != null ? params.width : oldWidth;\n  params.height = params.height != null ? params.height : oldHeight;\n  params.projectionCenterX = params.projectionCenterX != null ?\n    params.projectionCenterX : oldProjectionCenterX;\n  params.projectionCenterY = params.projectionCenterY != null ?\n    params.projectionCenterY : oldProjectionCenterY;\n\n  // Apply view limiting when defined.\n  if (this._limiter) {\n    params = this._limiter(params);\n    if (!params) {\n      throw new Error('Bad view limiter');\n    }\n  }\n\n  // Normalize parameters.\n  params = this._normalize(params);\n\n  // Grab the limited parameters.\n  var newYaw = params.yaw;\n  var newPitch = params.pitch;\n  var newRoll = params.roll;\n  var newFov = params.fov;\n  var newWidth = params.width;\n  var newHeight = params.height;\n  var newProjectionCenterX = params.projectionCenterX;\n  var newProjectionCenterY = params.projectionCenterY;\n\n  // Consistency check.\n  if (!real(newYaw) || !real(newPitch) || !real(newRoll) ||\n      !real(newFov) || !real(newWidth) || !real(newHeight) ||\n      !real(newProjectionCenterX) || !real(newProjectionCenterY)) {\n    throw new Error('Bad view - suspect a broken limiter');\n  }\n\n  // Update parameters.\n  this._yaw = newYaw;\n  this._pitch = newPitch;\n  this._roll = newRoll;\n  this._fov = newFov;\n  this._width = newWidth;\n  this._height = newHeight;\n  this._projectionCenterX = newProjectionCenterX;\n  this._projectionCenterY = newProjectionCenterY;\n\n  // Check whether the parameters changed and emit the corresponding events.\n  if (newYaw !== oldYaw || newPitch !== oldPitch || newRoll !== oldRoll ||\n      newFov !== oldFov || newWidth !== oldWidth || newHeight !== oldHeight ||\n      newProjectionCenterX !== oldProjectionCenterX ||\n      newProjectionCenterY !== oldProjectionCenterY) {\n    this._projectionChanged = true;\n    this.emit('change');\n  }\n  if (newWidth !== oldWidth || newHeight !== oldHeight) {\n    this.emit('resize');\n  }\n\n};\n\n\nRectilinearView.prototype._normalize = function(params) {\n\n  this._normalizeCoordinates(params);\n\n  // Make sure that neither the horizontal nor the vertical fields of view\n  // exceed π - fovLimitEpsilon.\n  var hfovPi = convertFov.htov(Math.PI, params.width, params.height);\n  var maxFov = isNaN(hfovPi) ? Math.PI : Math.min(Math.PI, hfovPi);\n  params.fov = clamp(params.fov, fovLimitEpsilon, maxFov - fovLimitEpsilon);\n\n  return params;\n};\n\n\nRectilinearView.prototype._normalizeCoordinates = function(params) {\n  // Constrain yaw, pitch and roll to the [-π, π] interval.\n  if ('yaw' in params) {\n    params.yaw = mod(params.yaw - Math.PI, -2*Math.PI) + Math.PI;\n  }\n  if ('pitch' in params) {\n    params.pitch = mod(params.pitch - Math.PI, -2*Math.PI) + Math.PI;\n  }\n  if ('roll' in params) {\n    params.roll = mod(params.roll - Math.PI, -2*Math.PI) + Math.PI;\n  }\n  return params;\n};\n\n\n/**\n * Normalize view coordinates so that they are the closest to the current view.\n * Useful for tweening the view through the shortest path. If a result argument\n * is supplied, it is filled in with the result and returned. Otherwise, a fresh\n * object is filled in and returned.\n *\n * @param {RectilinearViewCoords} coords The view coordinates.\n * @param {RectilinearViewCoords} result The result argument for the normalized\n *     view coordinates.\n */\nRectilinearView.prototype.normalizeToClosest = function(coords, result) {\n\n  var viewYaw = this._yaw;\n  var viewPitch = this._pitch;\n\n  var coordYaw = coords.yaw;\n  var coordPitch = coords.pitch;\n\n  // Check if the yaw is closer after subtracting or adding a full circle.\n  var prevYaw = coordYaw - 2*Math.PI;\n  var nextYaw = coordYaw + 2*Math.PI;\n  if (Math.abs(prevYaw - viewYaw) < Math.abs(coordYaw - viewYaw)) {\n    coordYaw = prevYaw;\n  }\n  else if (Math.abs(nextYaw - viewYaw) < Math.abs(coordYaw - viewYaw)) {\n    coordYaw = nextYaw;\n  }\n\n  // Check if the pitch is closer after subtracting or adding a full circle.\n  var prevPitch = coordPitch - 2*Math.PI;\n  var nextPitch = coordPitch + 2*Math.PI;\n  if (Math.abs(prevPitch - viewPitch) < Math.abs(coordPitch - viewPitch)) {\n    coordPitch = prevPitch;\n  }\n  else if (Math.abs(prevPitch - viewPitch) < Math.abs(coordPitch - viewPitch)) {\n    coordPitch = nextPitch;\n  }\n\n  result = result || {};\n  result.yaw = coordYaw;\n  result.pitch = coordPitch;\n  return result;\n\n};\n\n\nRectilinearView.prototype.updateWithControlParameters = function(parameters) {\n  // axisScaledX and axisScaledY are scaled according to their own axis\n  // x and y are scaled by the same value\n\n  // If the viewport dimensions are zero, assume a square viewport\n  // when converting from hfov to vfov.\n  var vfov = this._fov;\n  var hfov = convertFov.vtoh(vfov, this._width, this._height);\n  if (isNaN(hfov)) {\n    hfov = vfov;\n  }\n\n  // TODO: revisit this after we rethink the control parameters.\n  this.offsetYaw(parameters.axisScaledX * hfov + parameters.x * 2 * hfov + parameters.yaw);\n  this.offsetPitch(parameters.axisScaledY * vfov + parameters.y * 2 * hfov + parameters.pitch);\n  this.offsetRoll(-parameters.roll);\n  this.offsetFov(parameters.zoom * vfov);\n};\n\n\nRectilinearView.prototype._updateProjection = function() {\n  var projMatrix = this._projMatrix;\n  var invProjMatrix = this._invProjMatrix;\n  var frustum = this._frustum;\n\n  if (this._projectionChanged) {\n    var width = this._width;\n    var height = this._height;\n\n    var vfov = this._fov;\n    var hfov = convertFov.vtoh(vfov, width, height);\n    var aspect = width / height;\n\n    var projectionCenterX = this._projectionCenterX;\n    var projectionCenterY = this._projectionCenterY;\n\n    if (projectionCenterX !== 0 || projectionCenterY !== 0) {\n      var offsetAngleX = Math.atan(projectionCenterX * 2 * Math.tan(hfov/2));\n      var offsetAngleY = Math.atan(projectionCenterY * 2 * Math.tan(vfov/2));\n      var fovs = this._fovs;\n      fovs.leftDegrees = (hfov/2 + offsetAngleX) * 180/Math.PI;\n      fovs.rightDegrees = (hfov/2 - offsetAngleX) * 180/Math.PI;\n      fovs.upDegrees = (vfov/2 + offsetAngleY) * 180/Math.PI;\n      fovs.downDegrees = (vfov/2 - offsetAngleY) * 180/Math.PI;\n      mat4.perspectiveFromFieldOfView(projMatrix, fovs, -1, 1);\n    } else {\n      mat4.perspective(projMatrix, vfov, aspect, -1, 1);\n    }\n\n    mat4.rotateZ(projMatrix, projMatrix, this._roll);\n    mat4.rotateX(projMatrix, projMatrix, this._pitch);\n    mat4.rotateY(projMatrix, projMatrix, this._yaw);\n\n    mat4.invert(invProjMatrix, projMatrix);\n\n    this._matrixToFrustum(projMatrix, frustum);\n\n    this._projectionChanged = false;\n  }\n};\n\n\nRectilinearView.prototype._matrixToFrustum = function(p, f) {\n  // Extract frustum planes from projection matrix.\n  // http://www8.cs.umu.se/kurser/5DV051/HT12/lab/plane_extraction.pdf\n  vec4.set(f[0], p[3] + p[0], p[7] + p[4], p[11] + p[8],  0); // left\n  vec4.set(f[1], p[3] - p[0], p[7] - p[4], p[11] - p[8],  0); // right\n  vec4.set(f[2], p[3] + p[1], p[7] + p[5], p[11] + p[9],  0); // top\n  vec4.set(f[3], p[3] - p[1], p[7] - p[5], p[11] - p[9],  0); // bottom\n  vec4.set(f[4], p[3] + p[2], p[7] + p[6], p[11] + p[10], 0); // camera\n};\n\n\n/**\n * Returns the projection matrix for the current view.\n * @returns {mat4}\n */\nRectilinearView.prototype.projection = function() {\n  this._updateProjection();\n  return this._projMatrix;\n};\n\n\n/**\n * Returns the inverse projection matrix for the current view.\n * @returns {mat4}\n */\nRectilinearView.prototype.inverseProjection = function() {\n  this._updateProjection();\n  return this._invProjMatrix;\n};\n\n\n/**\n * Return whether the view frustum intersects the given rectangle.\n *\n * This function may return false positives, but never false negatives.\n * It is used for frustum culling, i.e., excluding invisible tiles from the\n * rendering process.\n *\n * @param {vec2[]} rectangle The vertices of the rectangle.\n */\nRectilinearView.prototype.intersects = function(rectangle) {\n  this._updateProjection();\n\n  var frustum = this._frustum;\n  var vertex = this._tmpVec;\n\n  // Check whether the rectangle is on the outer side of any of the frustum\n  // planes. This is a sufficient condition, though not necessary, for the\n  // rectangle to be completely outside the frustum.\n  for (var i = 0; i < frustum.length; i++) {\n    var plane = frustum[i];\n    var inside = false;\n    for (var j = 0; j < rectangle.length; j++) {\n      var corner = rectangle[j];\n      vec4.set(vertex, corner[0], corner[1], corner[2], 0);\n      if (vec4.dot(plane, vertex) >= 0) {\n        inside = true;\n      }\n    }\n    if (!inside) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Select the level that should be used to render the view.\n * @param {Level[]} levelList the list of levels from which to select.\n * @return {Level} the selected level.\n */\nRectilinearView.prototype.selectLevel = function(levelList) {\n\n  // Multiply the viewport width by the device pixel ratio to get the required\n  // horizontal resolution in pixels.\n  //\n  // Calculate the fraction of a cube face that would be visible given the\n  // current vertical field of view. Then, for each level, multiply by the\n  // level height to get the height in pixels of the portion that would be\n  // visible.\n  //\n  // Search for the smallest level that satifies the the required height,\n  // falling back on the largest level if none do.\n\n  var requiredPixels = pixelRatio() * this._height;\n  var coverFactor = Math.tan(0.5 * this._fov);\n\n  for (var i = 0; i < levelList.length; i++) {\n    var level = levelList[i];\n    if (coverFactor * level.height() >= requiredPixels) {\n      return level;\n    }\n  }\n\n  return levelList[levelList.length - 1];\n\n};\n\n\n/**\n * Convert view parameters into screen position. If a result argument is\n * provided, it is filled in and returned. Otherwise, a fresh object is filled\n * in and returned.\n *\n * @param {RectilinearViewCoords} coords The view coordinates.\n * @param {Coords=} result The result argument for the screen coordinates.\n * @return {Coords}\n */\nRectilinearView.prototype.coordinatesToScreen = function(coords, result) {\n  var ray = this._tmpVec;\n\n  if (!result) {\n    result = {};\n  }\n\n  var width = this._width;\n  var height = this._height;\n\n  // Undefined on a null viewport.\n  if (width <= 0 || height <= 0) {\n    result.x = null;\n    result.y = null;\n    return null;\n  }\n\n  // Compute view ray pointing into the (yaw, pitch) direction.\n  var yaw = coords.yaw;\n  var pitch = coords.pitch;\n  var x = Math.sin(yaw) * Math.cos(pitch);\n  var y = -Math.sin(pitch);\n  var z = -Math.cos(yaw) * Math.cos(pitch);\n  vec4.set(ray, x, y, z, 1);\n\n  // Project view ray onto clip space.\n  vec4.transformMat4(ray, ray, this.projection());\n\n  // w in clip space equals -z in camera space.\n  if (ray[3] >= 0) {\n    // Point is in front of camera.\n    // Convert to viewport coordinates.\n    result.x = width * (ray[0] / ray[3] + 1) / 2;\n    result.y = height * (1 - ray[1] / ray[3]) / 2;\n  } else {\n    // Point is behind camera.\n    result.x = null;\n    result.y = null;\n    return null;\n  }\n\n  return result;\n};\n\n\n/**\n * Convert screen coordinates into view coordinates. If a result argument is\n * provided, it is filled in with the result and returned. Otherwise, a fresh\n * object is filled in and returned.\n *\n * @param {Coords} coords The screen coordinates.\n * @param {RectilinearViewCoords=} result The view coordinates.\n * @return {RectilinearViewCoords}\n */\nRectilinearView.prototype.screenToCoordinates = function(coords, result) {\n  var ray = this._tmpVec;\n\n  if (!result) {\n    result = {};\n  }\n\n  var width = this._width;\n  var height = this._height;\n\n  // Convert viewport coordinates to clip space.\n  var vecx = 2 * coords.x / width - 1;\n  var vecy = 1 - 2 * coords.y / height;\n  vec4.set(ray, vecx, vecy, 1, 1);\n\n  // Project back to world space.\n  vec4.transformMat4(ray, ray, this.inverseProjection());\n\n  // Convert to spherical coordinates.\n  var r = Math.sqrt(ray[0] * ray[0] + ray[1] * ray[1] + ray[2] * ray[2]);\n  result.yaw = Math.atan2(ray[0], -ray[2]);\n  result.pitch = Math.acos(ray[1] / r) - Math.PI/2;\n\n  this._normalizeCoordinates(result);\n\n  return result;\n};\n\n\n/**\n * Calculate the perspective transform required to position an element with\n * perspective.\n *\n * @param {RectilinearViewCoords} coords The view coordinates.\n * @param {number} radius Radius of the sphere embedding the element.\n * @param {string} extraTransforms Extra transformations to be applied after\n *     the element is positioned. This may be used to rotate the element.\n * @return {string} The CSS 3D transform to be applied to the element.\n */\nRectilinearView.prototype.coordinatesToPerspectiveTransform = function(\n    coords, radius, extraTransforms) {\n  extraTransforms = extraTransforms || \"\";\n\n  var height = this._height;\n  var width = this._width;\n  var fov = this._fov;\n  var perspective = 0.5 * height / Math.tan(fov / 2);\n\n  var transform = '';\n\n  // Center hotspot in screen.\n  transform += 'translateX(' + decimal(width/2) + 'px) ';\n  transform += 'translateY(' + decimal(height/2) + 'px) ';\n  transform += 'translateX(-50%) translateY(-50%) ';\n\n  // Set the perspective depth.\n  transform += 'perspective(' + decimal(perspective) + 'px) ';\n  transform += 'translateZ(' + decimal(perspective) + 'px) ';\n\n  // Set the camera rotation.\n  transform += 'rotateZ(' + decimal(-this._roll) + 'rad) ';\n  transform += 'rotateX(' + decimal(-this._pitch) + 'rad) ';\n  transform += 'rotateY(' + decimal(this._yaw) + 'rad) ';\n\n  // Set the hotspot rotation.\n  transform += 'rotateY(' + decimal(-coords.yaw) + 'rad) ';\n  transform += 'rotateX(' + decimal(coords.pitch) + 'rad) ';\n\n  // Move back to sphere.\n  transform += 'translateZ(' + decimal(-radius) + 'px) ';\n\n  // Apply the extra transformations\n  transform += extraTransforms + ' ';\n\n  return transform;\n};\n\n\n/**\n * Factory functions for view limiters. See {@link RectilinearViewLimiter}.\n * @namespace\n */\nRectilinearView.limit = {\n\n  /**\n   * Returns a view limiter that constrains the yaw angle.\n   * @param {number} min The minimum yaw value.\n   * @param {number} max The maximum yaw value.\n   * @return {RectilinearViewLimiter}\n   */\n  yaw: function(min, max) {\n    return function limitYaw(params) {\n      params.yaw = clamp(params.yaw, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the pitch angle.\n   * @param {number} min The minimum pitch value.\n   * @param {number} max The maximum pitch value.\n   * @return {RectilinearViewLimiter}\n   */\n  pitch: function(min, max) {\n    return function limitPitch(params) {\n      params.pitch = clamp(params.pitch, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the roll angle.\n   * @param {number} min The minimum roll value.\n   * @param {number} max The maximum roll value.\n   * @return {RectilinearViewLimiter}\n   */\n  roll: function(min, max) {\n    return function limitRoll(params) {\n      params.roll = clamp(params.roll, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the horizontal field of view.\n   * @param {number} min The minimum horizontal field of view.\n   * @param {number} max The maximum horizontal field of view.\n   * @return {RectilinearViewLimiter}\n   */\n  hfov: function(min, max) {\n    return function limitHfov(params) {\n      var width = params.width;\n      var height = params.height;\n      if (width > 0 && height > 0) {\n        var vmin = convertFov.htov(min, width, height);\n        var vmax = convertFov.htov(max, width, height);\n        params.fov = clamp(params.fov, vmin, vmax);\n      }\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the vertical field of view.\n   * @param {number} min The minimum vertical field of view.\n   * @param {number} max The maximum vertical field of view.\n   * @return {RectilinearViewLimiter}\n   */\n  vfov: function(min, max) {\n    return function limitVfov(params) {\n      params.fov = clamp(params.fov, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that prevents zooming in beyond the given\n   * resolution.\n   * @param {number} size The cube face width in pixels or, equivalently, one\n   *     fourth of the equirectangular width in pixels.\n   * @return {RectilinearViewLimiter}\n   */\n  resolution: function(size) {\n    return function limitResolution(params) {\n      var height = params.height;\n      if (height) {\n        var requiredPixels = pixelRatio() * height;\n        var minFov = 2 * Math.atan(requiredPixels / size);\n        params.fov = clamp(params.fov, minFov, Infinity);\n      }\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that limits the horizontal and vertical field of\n   * view, prevents zooming in past the image resolution, and limits the pitch\n   * range to prevent the camera wrapping around at the poles. These are the\n   * most common view constraints for a 360° panorama.\n   * @param {number} maxResolution The cube face width in pixels or,\n   *     equivalently, one fourth of the equirectangular width in pixels.\n   * @param {number} maxVFov The maximum vertical field of view.\n   * @param {number} [maxHFov=maxVFov] The maximum horizontal field of view.\n   * @return {RectilinearViewLimiter}\n   */\n  traditional: function(maxResolution, maxVFov, maxHFov) {\n    maxHFov = maxHFov != null ? maxHFov : maxVFov;\n\n    return compose(\n      RectilinearView.limit.resolution(maxResolution),\n      RectilinearView.limit.vfov(0, maxVFov),\n      RectilinearView.limit.hfov(0, maxHFov),\n      RectilinearView.limit.pitch(-Math.PI/2, Math.PI/2));\n  }\n\n};\n\n\nRectilinearView.type = RectilinearView.prototype.type = 'rectilinear';\n\n\nmodule.exports = RectilinearView;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar mat4 = require('gl-matrix').mat4;\nvar vec4 = require('gl-matrix').vec4;\nvar pixelRatio = require('../util/pixelRatio');\nvar real = require('../util/real');\nvar clamp = require('../util/clamp');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n// Default viewport dimensions.\n// Start with zero to ensure that those values are handled correctly.\nvar defaultWidth = 0;\nvar defaultHeight = 0;\n\n// Default view parameters.\nvar defaultX = 0.5;\nvar defaultY = 0.5;\nvar defaultZoom = 1;\n\n// Constant values used to simplify the frustum culling logic.\n// planeAxes[i] indicates the coordinate value that defines a frustum plane.\n// planeCmp[i] indicates how point and plane coordinates should be compared\n// to determine whether the point is on the outer side of the plane.\nvar planeAxes = [\n  1, // top\n  0, // right\n  1, // bottom\n  0  // left\n];\nvar planeCmp = [\n  -1, // top\n  -1, // right\n   1, // bottom\n   1  // left\n];\n\n// A zoom of exactly 0 breaks some computations, so we force a minimum positive\n// value. We use 6 decimal places for the epsilon value to avoid broken\n// rendering due to loss of precision in floating point computations.\nvar zoomLimitEpsilon = 0.000001;\n\n\n/**\n * @interface FlatViewParams\n *\n * A camera configuration for a {@link FlatView}.\n *\n * @property {number} x The horizontal coordinate of the image point displayed\n *     at the viewport center, in the [0, 1] range.\n *     When `x === 0.5`, the image is centered horizontally.\n *     When `x === 0`, the left edge of the image is at the viewport center.\n *     When `x === 1`, the right edge of the image is at the viewport center.\n * @property {number} y The vertical coordinate of the image point displayed at\n *     the viewport center, in the [0, 1] range.\n *     When `y === 0.5`, the image is centered vertically.\n *     When `y === 0`, the top edge of the image is at the viewport center.\n *     When `y === 1`, the bottom edge of the image is at the viewport center.\n * @property {number} zoom The horizontal zoom, in the [0, ∞) range.\n *     When `zoom === 1`, the viewport is as wide as the image.\n *     When `zoom < 1`, the image is zoomed in.\n *     When `zoom > 1`, the image is zoomed out.\n * @property {number} mediaAspectRatio The image aspect ratio.\n *     When `mediaAspectRatio === 1`, the image width equals its height.\n *     When `mediaAspectRatio < 1`, the image width is less than its height.\n *     When `mediaAspectRatio > 1`, the image height is less than its width.\n */\n\n\n/**\n * @interface FlatViewCoords\n *\n * The position of a point in a flat image.\n *\n * @property {number} x The horizontal coordinate, in the [0, 1] range.\n * @property {number} y The vertical coordinate, in the [0, 1] range.\n */\n\n\n/**\n * @typedef {function} FlatViewLimiter\n *\n * View limiter for a {@link FlatView}.\n *\n * A view limiter is a function that receives a {@link FlatViewParams} object,\n * optionally modifies it in place, and returns it. It can be used to enforce\n * constraints on the view parameters.\n *\n * See {@link FlatView.limit} for commonly used limiters. They may be composed\n * together or with user-defined limiters with {@link util.compose}.\n *\n * @param {FlatViewParams} params\n * @return {FlatViewParams}\n */\n\n\n/**\n * @class FlatView\n * @implements View\n * @classdesc\n *\n * A {@link View} implementing an orthogonal projection for flat images.\n *\n * @param {FlatViewParams} params The initial view parameters. The\n *     `mediaAspectRatio` parameter must always be set. The other parameters\n *     default to `{x: 0.5, y: 0.5, z: 1 }` if unspecified.\n * @param {FlatViewLimiter=} limiter The view limiter. If unspecified, no view\n *     limiting is applied. See {@link FlatView.limit} for commonly used\n *     limiters.\n */\nfunction FlatView(params, limiter) {\n  // Require an aspect ratio to be specified.\n  if (!(params && params.mediaAspectRatio != null)) {\n    throw new Error('mediaAspectRatio must be defined');\n  }\n\n  // The initial values for the view parameters.\n  this._x = params && params.x != null ? params.x : defaultX;\n  this._y = params && params.y != null ? params.y : defaultY;\n  this._zoom = params && params.zoom != null ? params.zoom : defaultZoom;\n  this._mediaAspectRatio = params.mediaAspectRatio;\n  this._width = params && params.width != null ?\n    params.width : defaultWidth;\n  this._height = params && params.height != null ?\n    params.height : defaultHeight;\n\n  // The initial value for the view limiter.\n  this._limiter = limiter || null;\n\n  // The last calculated projection matrix and its inverse.\n  this._projMatrix = mat4.create();\n  this._invProjMatrix = mat4.create();\n\n  // The last calculated view frustum.\n  this._frustum = [\n    0, // top\n    0, // right\n    0, // bottom\n    0  // left\n  ];\n\n  // Whether the projection matrices and view frustum need to be updated.\n  this._projectionChanged = true;\n\n  // Temporary variables used for calculations.\n  this._params = {};\n  this._vec = vec4.create();\n\n  // Force view limiting on initial parameters.\n  this._update();\n}\n\neventEmitter(FlatView);\n\n\n/**\n * Destructor.\n */\nFlatView.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\n\n/**\n * Get the x parameter.\n * @return {number}\n */\nFlatView.prototype.x = function() {\n  return this._x;\n};\n\n\n/**\n * Get the y parameter.\n * @return {number}\n */\nFlatView.prototype.y = function() {\n  return this._y;\n};\n\n\n/**\n * Get the zoom value.\n * @return {number}\n */\nFlatView.prototype.zoom = function() {\n  return this._zoom;\n};\n\n\n/**\n * Get the media aspect ratio.\n * @return {number}\n */\nFlatView.prototype.mediaAspectRatio = function() {\n  return this._mediaAspectRatio;\n};\n\n\n/**\n * Get the viewport width.\n * @return {number}\n */\nFlatView.prototype.width = function() {\n  return this._width;\n};\n\n\n/**\n * Get the viewport height.\n * @return {number}\n */\nFlatView.prototype.height = function() {\n  return this._height;\n};\n\n\n/**\n * Get the viewport dimensions. If an argument is supplied, it is filled in with\n * the result and returned. Otherwise, a fresh object is filled in and returned.\n * @param {Size=} size\n * @return {Size}\n */\nFlatView.prototype.size = function(size) {\n  size = size || {};\n  size.width = this._width;\n  size.height = this._height;\n  return size;\n};\n\n\n/**\n * Get the view parameters. If an argument is supplied, it is filled in with the\n * result and returned. Otherwise, a fresh object is filled in and returned.\n * @param {FlatViewParams=} params\n * @return {FlatViewParams}\n */\nFlatView.prototype.parameters = function(params) {\n  params = params || {};\n  params.x = this._x;\n  params.y = this._y;\n  params.zoom = this._zoom;\n  params.mediaAspectRatio = this._mediaAspectRatio;\n  return params;\n};\n\n\n/**\n * Get the view limiter, or null if unset.\n * @return {?FlatViewLimiter}\n */\nFlatView.prototype.limiter = function() {\n  return this._limiter;\n};\n\n\n/**\n * Set the x parameter.\n * @param {number} x\n */\nFlatView.prototype.setX = function(x) {\n  this._resetParams();\n  this._params.x = x;\n  this._update(this._params);\n};\n\n\n/**\n * Set the y parameter.\n * @param {number} y\n */\nFlatView.prototype.setY = function(y) {\n  this._resetParams();\n  this._params.y = y;\n  this._update(this._params);\n};\n\n\n/**\n * Set the zoom value.\n * @param {number} zoom\n */\nFlatView.prototype.setZoom = function(zoom) {\n  this._resetParams();\n  this._params.zoom = zoom;\n  this._update(this._params);\n};\n\n\n/**\n * Add xOffset to the x parameter.\n * @param {number} xOffset\n */\nFlatView.prototype.offsetX = function(xOffset) {\n  this.setX(this._x + xOffset);\n};\n\n\n/**\n * Add yOffset to the y parameter.\n * @param {number} yOffset\n */\nFlatView.prototype.offsetY = function(yOffset)\n{\n  this.setY(this._y + yOffset);\n};\n\n\n/**\n * Add zoomOffset to the zoom value.\n * @param {number} zoomOffset\n */\nFlatView.prototype.offsetZoom = function(zoomOffset) {\n  this.setZoom(this._zoom + zoomOffset);\n};\n\n\n/**\n * Set the media aspect ratio.\n * @param {number} mediaAspectRatio\n */\nFlatView.prototype.setMediaAspectRatio = function(mediaAspectRatio) {\n  this._resetParams();\n  this._params.mediaAspectRatio = mediaAspectRatio;\n  this._update(this._params);\n};\n\n\n/**\n * Set the viewport dimensions.\n * @param {Size} size\n */\nFlatView.prototype.setSize = function(size) {\n  this._resetParams();\n  this._params.width = size.width;\n  this._params.height = size.height;\n  this._update(this._params);\n};\n\n\n/**\n * Set the view parameters. Unspecified parameters are left unchanged.\n * @param {FlatViewParameters} params\n */\nFlatView.prototype.setParameters = function(params) {\n  this._resetParams();\n  this._params.x = params.x;\n  this._params.y = params.y;\n  this._params.zoom = params.zoom;\n  this._params.mediaAspectRatio = params.mediaAspectRatio;\n  this._update(this._params);\n};\n\n\n/**\n * Set the view limiter.\n * @param {?FlatViewLimiter} limiter The new limiter, or null to unset.\n */\nFlatView.prototype.setLimiter = function(limiter) {\n  this._limiter = limiter || null;\n  this._update();\n};\n\n\nFlatView.prototype._resetParams = function() {\n  var params = this._params;\n  params.x = null;\n  params.y = null;\n  params.zoom = null;\n  params.mediaAspectRatio = null;\n  params.width = null;\n  params.height = null;\n};\n\n\nFlatView.prototype._update = function(params) {\n\n  // Avoid object allocation when no parameters are supplied.\n  if (params == null) {\n    this._resetParams();\n    params = this._params;\n  }\n\n  // Save old parameters for later comparison.\n  var oldX = this._x;\n  var oldY = this._y;\n  var oldZoom = this._zoom;\n  var oldMediaAspectRatio = this._mediaAspectRatio;\n  var oldWidth = this._width;\n  var oldHeight = this._height;\n\n  // Fill in object with the new set of parameters to pass into the limiter.\n  params.x = params.x != null ? params.x : oldX;\n  params.y = params.y != null ? params.y : oldY;\n  params.zoom = params.zoom != null ? params.zoom : oldZoom;\n  params.mediaAspectRatio = params.mediaAspectRatio != null ?\n    params.mediaAspectRatio : oldMediaAspectRatio;\n  params.width = params.width != null ? params.width : oldWidth;\n  params.height = params.height != null ? params.height : oldHeight;\n\n  // Apply view limiting when defined.\n  if (this._limiter) {\n    params = this._limiter(params);\n    if (!params) {\n      throw new Error('Bad view limiter');\n    }\n  }\n\n  // Grab the limited parameters.\n  var newX = params.x;\n  var newY = params.y;\n  var newZoom = params.zoom;\n  var newMediaAspectRatio = params.mediaAspectRatio;\n  var newWidth = params.width;\n  var newHeight = params.height;\n\n  // Consistency check.\n  if (!real(newX) || !real(newY) || !real(newZoom) ||\n      !real(newMediaAspectRatio) || !real(newWidth) || !real(newHeight)) {\n    throw new Error('Bad view - suspect a broken limiter');\n  }\n\n  // Constrain zoom.\n  newZoom = clamp(newZoom, zoomLimitEpsilon, Infinity);\n\n  // Update parameters.\n  this._x = newX;\n  this._y = newY;\n  this._zoom = newZoom;\n  this._mediaAspectRatio = newMediaAspectRatio;\n  this._width = newWidth;\n  this._height = newHeight;\n\n  // Check whether the parameters changed and emit the corresponding events.\n  if (newX !== oldX || newY !== oldY || newZoom !== oldZoom ||\n      newMediaAspectRatio !== oldMediaAspectRatio ||\n      newWidth !== oldWidth || newHeight !== oldHeight) {\n    this._projectionChanged = true;\n    this.emit('change');\n  }\n  if (newWidth !== oldWidth || newHeight !== oldHeight) {\n    this.emit('resize');\n  }\n\n};\n\n\nFlatView.prototype._zoomX = function() {\n  return this._zoom;\n};\n\n\nFlatView.prototype._zoomY = function() {\n  var mediaAspectRatio = this._mediaAspectRatio;\n  var aspect = this._width / this._height;\n  var zoomX = this._zoom;\n  var zoomY = zoomX * mediaAspectRatio / aspect;\n  if (isNaN(zoomY)) {\n    zoomY = zoomX;\n  }\n  return zoomY;\n};\n\n\nFlatView.prototype.updateWithControlParameters = function(parameters) {\n  var scale = this.zoom();\n  var zoomX = this._zoomX();\n  var zoomY = this._zoomY();\n\n  // TODO: should the scale be the same for both axes?\n  this.offsetX(parameters.axisScaledX * zoomX + parameters.x * scale);\n  this.offsetY(parameters.axisScaledY * zoomY + parameters.y * scale);\n  this.offsetZoom(parameters.zoom * scale);\n};\n\n\nFlatView.prototype._updateProjection = function() {\n  var projMatrix = this._projMatrix;\n  var invProjMatrix = this._invProjMatrix;\n  var frustum = this._frustum;\n\n  // Recalculate projection matrix when required.\n  if (this._projectionChanged) {\n    var x = this._x;\n    var y = this._y;\n    var zoomX = this._zoomX();\n    var zoomY = this._zoomY();\n\n    // Recalculate view frustum.\n    var top     = frustum[0] = (0.5 - y) + 0.5 * zoomY;\n    var right   = frustum[1] = (x - 0.5) + 0.5 * zoomX;\n    var bottom  = frustum[2] = (0.5 - y) - 0.5 * zoomY;\n    var left    = frustum[3] = (x - 0.5) - 0.5 * zoomX;\n\n    // Recalculate projection matrix and its inverse.\n    mat4.ortho(projMatrix, left, right, bottom, top, -1, 1);\n    mat4.invert(invProjMatrix, projMatrix);\n\n    this._projectionChanged = false;\n  }\n};\n\n\n/**\n * Returns the projection matrix for the current view.\n * @returns {mat4}\n */\nFlatView.prototype.projection = function() {\n  this._updateProjection();\n  return this._projMatrix;\n};\n\n\n/**\n * Returns the inverse projection matrix for the current view.\n * @returns {mat4}\n */\nFlatView.prototype.inverseProjection = function() {\n  this._updateProjection();\n  return this._invProjMatrix;\n};\n\n\n/**\n * Return whether the view frustum intersects the given rectangle.\n *\n * This function may return false positives, but never false negatives.\n * It is used for frustum culling, i.e., excluding invisible tiles from the\n * rendering process.\n *\n * @param {vec3[]} rectangle The vertices of the rectangle.\n */\nFlatView.prototype.intersects = function(rectangle) {\n  this._updateProjection();\n\n  var frustum = this._frustum;\n\n  // Check whether the rectangle is on the outer side of any of the frustum\n  // planes. This is a sufficient condition, though not necessary, for the\n  // rectangle to be completely outside the fruouter\n  for (var i = 0; i < frustum.length; i++) {\n    var limit = frustum[i];\n    var axis = planeAxes[i];\n    var cmp = planeCmp[i];\n    var inside = false;\n    for (var j = 0; j < rectangle.length; j++) {\n      var vertex = rectangle[j];\n      if (cmp < 0 && vertex[axis] < limit || cmp > 0 && vertex[axis] > limit) {\n        inside = true;\n        break;\n      }\n    }\n    if (!inside) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Select the level that should be used to render the view.\n * @param {Level[]} levelList the list of levels from which to select.\n * @return {Level} the selected level.\n */\nFlatView.prototype.selectLevel = function(levels) {\n\n  // Multiply the viewport width by the device pixel ratio to get the required\n  // horizontal resolution in pixels.\n  //\n  // Calculate the fraction of the image that would be visible at the current\n  // zoom value. Then, for each level, multiply by the level width to get the\n  // width in pixels of the portion that would be visible.\n  //\n  // Search for the smallest level that satifies the the required width,\n  // falling back on the largest level if none do.\n\n  var requiredPixels = pixelRatio() * this.width();\n  var zoomFactor = this._zoom;\n\n  for (var i = 0; i < levels.length; i++) {\n    var level = levels[i];\n    if (zoomFactor * level.width() >= requiredPixels) {\n      return level;\n    }\n  }\n\n  return levels[levels.length - 1];\n\n};\n\n\n/**\n * Convert view coordinates into screen coordinates. If a result argument is\n * provided, it is filled in and returned. Otherwise, a fresh object is filled\n * in and returned.\n *\n * @param {FlatViewCoords} coords The view coordinates.\n * @param {Coords=} result The result argument for the screen coordinates.\n * @return {Coords}\n */\nFlatView.prototype.coordinatesToScreen = function(coords, result) {\n  var ray = this._vec;\n\n  if (!result) {\n    result = {};\n  }\n\n  var width = this._width;\n  var height = this._height;\n\n  // Undefined on a null viewport.\n  if (width <= 0 || height <= 0) {\n    result.x = null;\n    result.y = null;\n    return null;\n  }\n\n  // Extract coordinates from argument, filling in default values.\n  var x = coords && coords.x != null ? coords.x : defaultX;\n  var y = coords && coords.y != null ? coords.y : defaultY;\n\n  // Project view ray onto clip space.\n  vec4.set(ray, x - 0.5, 0.5 - y, -1, 1);\n  vec4.transformMat4(ray, ray, this.projection());\n\n  // Calculate perspective divide.\n  for (var i = 0; i < 3; i++) {\n    ray[i] /= ray[3];\n  }\n\n  // Convert to viewport coordinates and return.\n  result.x = width * (ray[0] + 1) / 2;\n  result.y = height * (1 - ray[1]) / 2;\n\n  return result;\n};\n\n\n/**\n * Convert screen coordinates into view coordinates. If a result argument is\n * provided, it is filled in with the result and returned. Otherwise, a fresh\n * object is filled in and returned.\n *\n * @param {Coords} coords The screen coordinates.\n * @param {FlatViewCoords=} result The result argument for the view coordinates.\n * @return {FlatViewCoords}\n */\nFlatView.prototype.screenToCoordinates = function(coords, result) {\n  var ray = this._vec;\n\n  if (!result) {\n    result = {};\n  }\n\n  var width = this._width;\n  var height = this._height;\n\n  // Convert viewport coordinates to clip space.\n  var vecx = 2 * coords.x / width - 1;\n  var vecy = 1 - 2 * coords.y / height;\n  vec4.set(ray, vecx, vecy, 1, 1);\n\n  // Project back to world space.\n  vec4.transformMat4(ray, ray, this.inverseProjection());\n\n  // Convert to flat coordinates.\n  result.x = 0.5 + ray[0];\n  result.y = 0.5 - ray[1];\n\n  return result;\n};\n\n\n/**\n * Factory functions for view limiters. See {@link FlatViewLimiter}.\n * @namespace\n */\nFlatView.limit = {\n\n  /**\n   * Returns a view limiter that constrains the x parameter.\n   * @param {number} min The minimum x value.\n   * @param {number} max The maximum y value.\n   * @return {FlatViewLimiter}\n   */\n  x: function(min, max) {\n    return function limitX(params) {\n      params.x = clamp(params.x, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Return a view limiter that constrains the y parameter.\n   * @param {number} min The minimum y value.\n   * @param {number} max The maximum y value.\n   * @return {FlatViewLimiter}\n   */\n  y: function(min, max) {\n    return function limitY(params) {\n      params.y = clamp(params.y, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter than constrains the zoom parameter.\n   * @param {number} min The minimum zoom value.\n   * @param {number} max The maximum zoom value.\n   * @return {FlatViewLimiter}\n   */\n  zoom: function(min, max) {\n    return function limitZoom(params) {\n      params.zoom = clamp(params.zoom, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that prevents zooming in beyond the given\n   * resolution.\n   * @param {number} size The image width in pixels.\n   * @return {FlatViewLimiter}\n   */\n  resolution: function(size) {\n    return function limitResolution(params) {\n      if (params.width <= 0 || params.height <= 0) {\n        return params;\n      }\n      var width = params.width;\n      var minZoom = pixelRatio() * width / size;\n      params.zoom = clamp(params.zoom, minZoom, Infinity);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the values of the x parameter that\n   * are inside the viewport.\n   * @param {number} min The minimum x value.\n   * @param {number} max The maximum x value.\n   * @return {FlatViewLimiter}\n   */\n  visibleX: function(min, max) {\n    return function limitVisibleX(params) {\n      // Calculate the zoom value that makes the specified range fully visible.\n      var maxZoom = max - min;\n\n      // Clamp zoom to the maximum value.\n      if (params.zoom > maxZoom) {\n        params.zoom = maxZoom;\n      }\n\n      // Bound X such that the image is visible up to the range edges.\n      var minX = min + 0.5 * params.zoom;\n      var maxX = max - 0.5 * params.zoom;\n      params.x = clamp(params.x, minX, maxX);\n\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the values of the y parameter that\n   * are inside the viewport.\n   * @param {number} min The minimum y value.\n   * @param {number} max The maximum y value.\n   * @return {FlatViewLimiter}\n   */\n  visibleY: function(min, max) {\n    return function limitVisibleY(params) {\n\n      // Do nothing for a null viewport.\n      if (params.width <= 0 || params.height <= 0) {\n        return params;\n      }\n\n      // Calculate the X to Y conversion factor.\n      var viewportAspectRatio = params.width / params.height;\n      var factor = viewportAspectRatio / params.mediaAspectRatio;\n\n      // Calculate the zoom value that makes the specified range fully visible.\n      var maxZoom = (max - min) * factor;\n\n      // Clamp zoom to the maximum value.\n      if (params.zoom > maxZoom) {\n        params.zoom = maxZoom;\n      }\n\n      // Bound Y such that the image is visible up to the range edges.\n      var minY = min + 0.5 * params.zoom / factor;\n      var maxY = max - 0.5 * params.zoom / factor;\n      params.y = clamp(params.y, minY, maxY);\n\n      return params;\n    };\n  },\n\n\n  /**\n   * Returns a view limiter that constrains the zoom parameter such that\n   * zooming out is prevented beyond the point at which the image is fully\n   * visible. Unless the image and the viewport have the same aspect ratio,\n   * this will cause bands to appear around the image.\n   * @return {FlatViewLimiter}\n   */\n  letterbox: function() {\n    return function limitLetterbox(params) {\n      if(params.width <= 0 || params.height <= 0) {\n        return params;\n      }\n      var viewportAspectRatio = params.width / params.height;\n\n      var fullWidthZoom = 1.0;\n      var fullHeightZoom = viewportAspectRatio / params.mediaAspectRatio;\n\n      // If the image is wider than the viewport, limit the horizontal zoom to\n      // the image width.\n      if (params.mediaAspectRatio >= viewportAspectRatio) {\n        params.zoom = Math.min(params.zoom, fullWidthZoom);\n      }\n\n      // If the image is narrower than the viewport, limit the vertical zoom to\n      // the image height.\n      if (params.mediaAspectRatio <= viewportAspectRatio) {\n        params.zoom = Math.min(params.zoom, fullHeightZoom);\n      }\n\n      // If the full image width is visible, limit x to the central point.\n      // Else, bound x such that image is visible up to the horizontal edges.\n      var minX, maxX;\n      if (params.zoom > fullWidthZoom) {\n        minX = maxX = 0.5;\n      } else {\n        minX = 0.0 + 0.5 * params.zoom / fullWidthZoom;\n        maxX = 1.0 - 0.5 * params.zoom / fullWidthZoom;\n      }\n\n      // If the full image height is visible, limit y to the central point.\n      // Else, bound y such that image is visible up to the vertical edges.\n      var minY, maxY;\n      if (params.zoom > fullHeightZoom) {\n        minY = maxY = 0.5;\n      } else {\n        minY = 0.0 + 0.5 * params.zoom / fullHeightZoom;\n        maxY = 1.0 - 0.5 * params.zoom / fullHeightZoom;\n      }\n\n      // Clamp x and y into the calculated bounds.\n      params.x = clamp(params.x, minX, maxX);\n      params.y = clamp(params.y, minY, maxY);\n\n      return params;\n    };\n  }\n\n};\n\n\nFlatView.type = FlatView.prototype.type = 'flat';\n\n\nmodule.exports = FlatView;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WorkQueue = require('./WorkQueue');\nvar mod = require('../util/mod');\n\n\nfunction WorkPool(opts) {\n  this._concurrency = opts && opts.concurrency || 1;\n  this._paused = opts && !!opts.paused || false;\n\n  this._pool = [];\n  for (var i = 0; i < this._concurrency; i++) {\n    this._pool.push(new WorkQueue(opts));\n  }\n\n  this._next = 0;\n}\n\n\nWorkPool.prototype.length = function() {\n  var len = 0;\n  for (var i = 0; i < this._pool.length; i++) {\n    len += this._pool[i].length();\n  }\n  return len;\n};\n\n\nWorkPool.prototype.push = function(fn, cb) {\n  var i = this._next;\n  var cancel = this._pool[i].push(fn, cb);\n  this._next = mod(this._next + 1, this._concurrency);\n  return cancel;\n};\n\n\nWorkPool.prototype.pause = function() {\n  if (!this._paused) {\n    this._paused = true;\n    for (var i = 0; i < this._concurrency; i++) {\n      this._pool[i].pause();\n    }\n  }\n};\n\n\nWorkPool.prototype.resume = function() {\n  if (this._paused) {\n    this._paused = false;\n    for (var i = 0; i < this._concurrency; i++) {\n      this._pool[i].resume();\n    }\n  }\n};\n\n\nmodule.exports = WorkPool;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction noop() {}\n\nmodule.exports = noop;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar noop = require('./noop');\n\n// Return a function that executes its arguments (which should be cancelables)\n// in sequence, so that each of them passes its return values to the next.\n// Execution is aborted if one of the functions returns an error; in that case\n// the last function in the sequence is called with the error.\n// See util/cancelize.js for an explanation of what cancelables are.\nfunction chain() {\n\n  // The list of functions to chain together.\n  var argList = Array.prototype.slice.call(arguments, 0);\n\n  return function chained() {\n\n    // List of remaining functions to be executed.\n    // Make a copy of the original list so we can mutate the former while\n    // preserving the latter intact for future invocations of the chain.\n    var fnList = argList.slice(0);\n\n    // Currently executing function.\n    var fn = null;\n\n    // Cancel method for the currently executing function.\n    var cfn = null;\n\n    // Arguments for the first function.\n    var args = arguments.length ? Array.prototype.slice.call(arguments, 0, arguments.length - 1) : [];\n\n    // Callback for the chain.\n    var done = arguments.length ? arguments[arguments.length - 1] : noop;\n\n    // Execute the next function in the chain.\n    // Receives the error and return values from the previous function.\n    function exec() {\n\n      // Extract error from arguments.\n      var err = arguments[0];\n\n      // Abort chain on error.\n      if (err) {\n        fn = cfn = null;\n        done.apply(null, arguments);\n        return;\n      }\n\n      // Terminate if there are no functions left in the chain.\n      if (!fnList.length) {\n        fn = cfn = null;\n        done.apply(null, arguments);\n        return;\n      }\n\n      // Advance to the next function in the chain.\n      fn = fnList.shift();\n      var _fn = fn;\n\n      // Extract arguments to pass into the next function.\n      var ret = Array.prototype.slice.call(arguments, 1);\n\n      // Call next function with previous return value and call back exec.\n      ret.push(exec);\n      var _cfn = fn.apply(null, ret); // fn(null, ret..., exec)\n\n      // Detect when fn has completed synchronously and do not clobber the\n      // internal state in that case. You're not expected to understand this.\n      if (_fn !== fn) {\n        return;\n      }\n\n      // Remember the cancel method for the currently executing function.\n      // Detect chaining on non-cancellable function.\n      if (typeof _cfn !== 'function') {\n        throw new Error('chain: chaining on non-cancellable function');\n      } else {\n        cfn = _cfn;\n      }\n\n    }\n\n    // Cancel chain execution.\n    function cancel() {\n      if (cfn) {\n        cfn.apply(null, arguments);\n      }\n    }\n\n    // Start chain execution.\n    // We call exec as if linking from a previous function in the chain,\n    // except that the error is always null. As a consequence, chaining on an\n    // empty list yields the identity function.\n    args.unshift(null);\n    exec.apply(null, args); // exec(null, args...)\n\n    return cancel;\n\n  };\n\n}\n\nmodule.exports = chain;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Perform a cancelable delay.\n// See util/cancelize.js for an explanation of what cancelables are.\nfunction delay(ms, done) {\n\n  // Work around IE8 bug whereby a setTimeout callback may still be called\n  // after the corresponding clearTimeout is invoked.\n  var timer = null;\n\n  function finish() {\n    if (timer != null) {\n      timer = null;\n      done(null);\n    }\n  }\n\n  function cancel() {\n    if (timer != null) {\n      clearTimeout(timer);\n      timer = null;\n      done.apply(null, arguments);\n    }\n  }\n\n  timer = setTimeout(finish, ms);\n\n  return cancel;\n\n}\n\nmodule.exports = delay;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar NetworkError = require('../NetworkError');\nvar WorkPool = require('../collections/WorkPool');\nvar chain = require('../util/chain');\nvar delay = require('../util/delay');\nvar now = require('../util/now');\n\n\n// Map template properties to their corresponding tile properties.\nvar templateProperties = {\n  x: 'x',\n  y: 'y',\n  z: 'z',\n  f: 'face'\n};\n\n// Default face order for cube maps.\nvar defaultCubeMapFaceOrder = 'bdflru';\n\n// Default maximum number of concurrent requests.\nvar defaultConcurrency = 4;\n\n// Default milliseconds to wait before retrying failed requests.\nvar defaultRetryDelay = 10000;\n\n\n/**\n * @class ImageUrlSource\n * @implements Source\n * @classdesc\n *\n * A {@link Source} that loads {@link Asset assets} from images given a URL and\n * a crop rectangle.\n *\n * @param {Function} sourceFromTile Function that receives a tile and returns\n * a `{ url, rect }` object, where `url` is an image URL and `rect`, when\n * present, is an `{ x, y, width, height }` object in normalized coordinates\n * denoting the portion of the image to use.\n * @param {Object} opts\n * @param {number} [opts.concurrency=4] Maximum number of tiles to request at\n *     the same time. The limit is per {@link ImageSourceUrl} instance.\n * @param {number} [opts.retryDelay=10000] Time in milliseconds to wait before\n *     retrying a failed request.\n */\nfunction ImageUrlSource(sourceFromTile, opts) {\n\n  opts = opts ? opts : {};\n\n  this._loadPool = new WorkPool({\n    concurrency: opts.concurrency || defaultConcurrency\n  });\n\n  this._retryDelay = opts.retryDelay || defaultRetryDelay;\n  this._retryMap = {};\n\n  this._sourceFromTile = sourceFromTile;\n}\n\neventEmitter(ImageUrlSource);\n\n\nImageUrlSource.prototype.loadAsset = function(stage, tile, done) {\n\n  var self = this;\n\n  var retryDelay = this._retryDelay;\n  var retryMap = this._retryMap;\n\n  var tileSource = this._sourceFromTile(tile);\n  var url = tileSource.url;\n  var rect = tileSource.rect;\n\n  var loadImage = stage.loadImage.bind(stage, url, rect);\n\n  var loadFn = function(done) {\n    // TODO: Deduplicate load requests for the same URL. Although the browser\n    // might be smart enough to avoid duplicate requests, they are still unduly\n    // impacted by the concurrency parameter.\n    return self._loadPool.push(loadImage, function(err, asset) {\n      if (err) {\n        if (err instanceof NetworkError) {\n          // If a network error occurred, wait before retrying.\n          retryMap[url] = now();\n          self.emit('networkError', err, tile);\n        }\n        done(err, tile);\n      } else {\n        // On a successful fetch, forget the previous timeout.\n        delete retryMap[url];\n        done(null, tile, asset);\n      }\n    });\n  };\n\n  // Check whether we are retrying a failed request.\n  var delayAmount;\n  var lastTime = retryMap[url];\n  if (lastTime != null) {\n    var currentTime = now();\n    var elapsed = currentTime - lastTime;\n    if (elapsed < retryDelay) {\n      // Wait before retrying.\n      delayAmount = retryDelay - elapsed;\n    } else {\n      // Retry timeout expired; perform the request at once.\n      delayAmount = 0;\n      delete retryMap[url];\n    }\n  }\n\n  var delayFn = delay.bind(null, delayAmount);\n\n  return chain(delayFn, loadFn)(done);\n};\n\n\n/**\n * Creates an ImageUrlSource from a string template.\n *\n * @param {String} url Tile URL template, which may contain the following\n *    placeholders:\n *    - `{f}` : tile face (one of `b`, `d`, `f`, `l`, `r`, `u`)\n *    - `{z}` : tile level index (0 is the smallest level)\n *    - `{x}` : tile horizontal index\n *    - `{y}` : tile vertical index\n * @param {Object} opts In addition to the options already supported by the\n *     {@link ImageUrlSource} constructor.\n * @param {String} opts.cubeMapPreviewUrl URL to use as the preview level.\n *     This must be a single image containing six cube faces laid out\n *     vertically according to the face order parameter.\n * @param {String} [opts.cubeMapPreviewFaceOrder='bdflru'] Face order within\n *     the preview image.\n */\nImageUrlSource.fromString = function(url, opts) {\n  opts = opts || {};\n\n  var faceOrder = opts && opts.cubeMapPreviewFaceOrder || defaultCubeMapFaceOrder;\n\n  var urlFn = opts.cubeMapPreviewUrl ? withPreview : withoutPreview;\n\n  return new ImageUrlSource(urlFn, opts);\n\n  function withoutPreview(tile) {\n    var tileUrl = url;\n\n    for (var property in templateProperties) {\n      var templateProperty = templateProperties[property];\n      var regExp = propertyRegExp(property);\n      var valueFromTile = tile.hasOwnProperty(templateProperty) ? tile[templateProperty] : '';\n      tileUrl = tileUrl.replace(regExp, valueFromTile);\n    }\n\n    return { url: tileUrl };\n  }\n\n  function withPreview(tile) {\n    if (tile.z === 0) {\n      return cubeMapUrl(tile);\n    }\n    else {\n      return withoutPreview(tile);\n    }\n  }\n\n  function cubeMapUrl(tile) {\n    var y = faceOrder.indexOf(tile.face) / 6;\n    return {\n      url: opts.cubeMapPreviewUrl,\n      rect: { x: 0, y: y, width: 1, height: 1/6 }\n    };\n  }\n};\n\nfunction propertyRegExp(property) {\n  var regExpStr = '\\\\{(' + property + ')\\\\}';\n  return new RegExp(regExpStr, 'g');\n}\n\nmodule.exports = ImageUrlSource;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @class SingleAssetSource\n * @implements Source\n * @classdesc\n *\n * A {@link Source} that always provides the same {@link Asset}.\n *\n * @param {Asset} asset The asset.\n*/\nfunction SingleAssetSource(asset) {\n  this._asset = asset;\n}\n\nSingleAssetSource.prototype.asset = function() {\n  return this._asset;\n};\n\nSingleAssetSource.prototype.loadAsset = function(stage, tile, done) {\n  var self = this;\n\n  var timeout = setTimeout(function() {\n    done(null, tile, self._asset);\n  }, 0);\n\n  function cancel() {\n    clearTimeout(timeout);\n    done.apply(null, arguments);\n  }\n\n  return cancel;\n};\n\nmodule.exports = SingleAssetSource;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar StaticAsset = require('./Static');\nvar inherits = require('../util/inherits');\nvar eventEmitter = require('minimal-event-emitter');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class DynamicAsset\n * @implements Asset\n * @extends StaticAsset\n * @classdesc\n *\n * An {@link Asset} whose pixel contents may change.\n *\n * @param {HTMLImageElement|HTMLCanvasElement|ImageBitmap} element The\n *     underlying pixel source.\n * @throws If the pixel source is unsupported.\n */\nfunction DynamicAsset(element) {\n  this.constructor.super_.call(this, element);\n  this._timestamp = 0;\n}\n\ninherits(DynamicAsset, StaticAsset);\neventEmitter(DynamicAsset);\n\n/**\n * Destructor.\n */\nDynamicAsset.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\nDynamicAsset.prototype.timestamp = function() {\n  return this._timestamp;\n};\n\nDynamicAsset.prototype.isDynamic = function() {\n  return true;\n};\n\n/**\n * Marks the asset dirty, signaling that the contents of the underlying pixel\n * source have changed.\n *\n * @throws If the asset is not dynamic.\n */\nDynamicAsset.prototype.markDirty = function() {\n  this._timestamp++;\n  this.emit('change');\n};\n\nmodule.exports = DynamicAsset;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mod = require('../util/mod');\n\nvar defaultCapacity = 64;\n\n// A map data structure for keys implementing hash() and equals() and arbitrary\n// values. The capacity, if given, is just a hint; the map is allowed to exceed\n// it, but performance may suffer.\nfunction Map(capacity) {\n  if (capacity != null &&\n      (!isFinite(capacity) || Math.floor(capacity) !== capacity || capacity < 1)) {\n    throw new Error('Map: invalid capacity');\n  }\n  this._capacity = capacity || defaultCapacity;\n\n  this._keyBuckets = [];\n  this._valBuckets = [];\n  for (var i = 0; i < this._capacity; i++) {\n    this._keyBuckets.push([]);\n    this._valBuckets.push([]);\n  }\n  this._size = 0;\n}\n\n// Returns the value associated with the specified key, or null if not found.\nMap.prototype.get = function(key) {\n  var h = mod(key.hash(), this._capacity);\n  var keyBucket = this._keyBuckets[h];\n  for (var i = 0; i < keyBucket.length; i++) {\n    var existingKey = keyBucket[i];\n    if (key.equals(existingKey)) {\n      var valBucket = this._valBuckets[h];\n      var existingValue = valBucket[i];\n      return existingValue;\n    }\n  }\n  return null;\n};\n\n// Associates the specified value with the specified key, possibly replacing the\n// currently associated value.\n// Returns the replaced value, or null if no value was replaced.\nMap.prototype.set = function(key, val) {\n  var h = mod(key.hash(), this._capacity);\n  var keyBucket = this._keyBuckets[h];\n  var valBucket = this._valBuckets[h];\n  for (var i = 0; i < keyBucket.length; i++) {\n    var existingKey = keyBucket[i];\n    if (key.equals(existingKey)) {\n      var existingValue = valBucket[i];\n      keyBucket[i] = key;\n      valBucket[i] = val;\n      return existingValue;\n    }\n  }\n  keyBucket.push(key);\n  valBucket.push(val);\n  this._size++;\n  return null;\n};\n\n// Removes the key-value pair associated with the specified key.\n// Returns the removed value, or null if not found.\nMap.prototype.del = function(key) {\n  var h = mod(key.hash(), this._capacity);\n  var keyBucket = this._keyBuckets[h];\n  var valBucket = this._valBuckets[h];\n  for (var i = 0; i < keyBucket.length; i++) {\n    var existingKey = keyBucket[i];\n    if (key.equals(existingKey)) {\n      var existingValue = valBucket[i];\n      // Splice manually to avoid Array#splice return value allocation.\n      for (var j = i; j < keyBucket.length - 1; j++) {\n        keyBucket[j] = keyBucket[j+1];\n        valBucket[j] = valBucket[j+1];\n      }\n      keyBucket.length = keyBucket.length - 1;\n      valBucket.length = valBucket.length - 1;\n      this._size--;\n      return existingValue;\n    }\n  }\n  return null;\n};\n\n// Returns whether there is a value associated with the specified key.\nMap.prototype.has = function(key) {\n  var h = mod(key.hash(), this._capacity);\n  var keyBucket = this._keyBuckets[h];\n  for (var i = 0; i < keyBucket.length; i++) {\n    var existingKey = keyBucket[i];\n    if (key.equals(existingKey)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n// Returns the number of key-value pairs in the map.\nMap.prototype.size = function() {\n  return this._size;\n};\n\n// Removes all key-value pairs from the map.\nMap.prototype.clear = function() {\n  for (var i = 0; i < this._capacity; i++) {\n    this._keyBuckets[i].length = 0;\n    this._valBuckets[i].length = 0;\n  }\n  this._size = 0;\n};\n\n// Calls fn(key, value) for each key-value pair in the map, in an unspecified\n// order. Returns the number of times fn was called.\n// The result is unspecified if the map is mutated during iteration.\nMap.prototype.forEach = function(fn) {\n  var count = 0;\n  for (var i = 0; i < this._capacity; i++) {\n    var keyBucket = this._keyBuckets[i];\n    var valBucket = this._valBuckets[i];\n    for (var j = 0; j < keyBucket.length; j++) {\n      fn(keyBucket[j], valBucket[j]);\n      count += 1;\n    }\n  }\n  return count;\n};\n\nmodule.exports = Map;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mod = require('../util/mod');\n\n// An LruSet holds up to a maximum number of elements, ordered by their time of\n// insertion. When the addition of an element would cause the capacity to be\n// exceeded, the oldest element in the set is evicted. As a special case, an\n// LruSet with zero capacity always rejects the insertion of an element.\n//\n// Elements must implement hash() and equals(). Note that the implementation\n// doesn't currently use hash(), but a future version might.\nfunction LruSet(capacity) {\n  if (!isFinite(capacity) || Math.floor(capacity) !== capacity || capacity < 0) {\n    throw new Error('LruSet: invalid capacity');\n  }\n  this._capacity = capacity;\n\n  // Elements are stored in a circular array ordered by decreasing age.\n  // Start is the index of the oldest element and size is the number of valid\n  // elements; the region containing valid elements may wrap around.\n  this._elements = new Array(this._capacity);\n  this._start = 0;\n  this._size = 0;\n}\n\nLruSet.prototype._index = function(i) {\n  return mod(this._start + i, this._capacity);\n};\n\n// Adds an element into the set, possibly replacing an equal element already in\n// the set. The element becomes the newest. If the set is at capacity, the\n// oldest element is removed. Returns the removed element if it does not equal\n// the inserted element, or null otherwise. If the capacity is zero, does\n// nothing and returns the element.\nLruSet.prototype.add = function(element) {\n  if (this._capacity === 0) {\n    return element;\n  }\n  this.remove(element);\n  var evictedElement =\n      this._size === this._capacity ? this._elements[this._index(0)] : null;\n  this._elements[this._index(this._size)] = element;\n  if (this._size < this._capacity) {\n    this._size++;\n  } else {\n    this._start = this._index(1);\n  }\n  return evictedElement;\n};\n\n// Removes an element from the set.\n// Returns the removed element, or null if the element was not found.\nLruSet.prototype.remove = function(element) {\n  for (var i = 0; i < this._size; i++) {\n    var existingElement = this._elements[this._index(i)];\n    if (element.equals(existingElement)) {\n      for (var j = i; j < this._size - 1; j++) {\n        this._elements[this._index(j)] = this._elements[this._index(j + 1)];\n      }\n      this._size--;\n      return existingElement;\n    }\n  }\n  return null;\n};\n\n// Returns whether an element is in the set.\nLruSet.prototype.has = function(element) {\n  for (var i = 0; i < this._size; i++) {\n    if (element.equals(this._elements[this._index(i)])) {\n      return true;\n    }\n  }\n  return false;\n};\n\n// Returns the number of elements in the set.\nLruSet.prototype.size = function() {\n  return this._size;\n};\n\n// Removes all elements from the set.\nLruSet.prototype.clear = function() {\n  this._elements.length = 0;\n  this._start = 0;\n  this._size = 0;\n};\n\n// Calls fn(element) for each element in the set, in an unspecified order.\n// Returns the number of times fn was called.\n// The result is unspecified if the set is mutated during iteration.\nLruSet.prototype.forEach = function(fn) {\n  var count = 0;\n  for (var i = 0; i < this._size; i++) {\n    fn(this._elements[this._index(i)]);\n    count += 1;\n  }\n  return count;\n};\n\nmodule.exports = LruSet;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction defaults(obj, defaultsObj) {\n  for (var key in defaultsObj) {\n    if (!(key in obj)) {\n      obj[key] = defaultsObj[key];\n    }\n  }\n  return obj;\n}\n\nmodule.exports = defaults;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar noop = require('./noop');\n\n// Return a cancelable function that executes fn in a loop until it returns\n// successfully.\nfunction retry(fn) {\n\n  return function retried() {\n\n    var args = arguments.length ? Array.prototype.slice.call(arguments, 0, arguments.length - 1) : [];\n    var done = arguments.length ? arguments[arguments.length - 1] : noop;\n\n    var cfn = null;\n    var canceled = false;\n\n    function exec() {\n      var err = arguments[0];\n      if (!err || canceled) {\n        done.apply(null, arguments);\n      } else {\n        cfn = fn.apply(null, args);\n      }\n    }\n\n    args.push(exec);\n    exec(true);\n\n    return function cancel() {\n      canceled = true;\n      cfn.apply(null, arguments);\n    };\n\n  };\n\n}\n\nmodule.exports = retry;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Map = require('./collections/Map');\nvar Set = require('./collections/Set');\nvar LruSet = require('./collections/LruSet');\nvar eventEmitter = require('minimal-event-emitter');\nvar defaults = require('./util/defaults');\nvar retry = require('./util/retry');\nvar chain = require('./util/chain');\nvar inherits = require('./util/inherits');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\nvar debug = typeof MARZIPANODEBUG !== 'undefined' && MARZIPANODEBUG.textureStore;\n\n\n// A Stage informs the TextureStore about the set of visible tiles during a\n// frame by calling startFrame, markTile and endFrame. In a particular frame,\n// TextureStore expects one or more calls to startFrame, followed by zero or\n// more calls to markTile, followed by one or more calls to endFrame. The\n// number of calls to startFrame and endFrame must match. Calls to other\n// TextureStore methods may be freely interleaved with this sequence.\n//\n// At any given time, TextureStore is in one of four states. The START state\n// corresponds to the interval between the first startFrame and the first\n// markTile of a frame. The MARK state corresponds to the interval between the\n// first markTile and the first endFrame. The END state corresponds to the\n// interval between the first and the last endFrame. At any other time, the\n// TextureStore is in the IDLE state.\nvar State = {\n  IDLE: 0,\n  START: 1,\n  MARK: 2,\n  END: 3\n};\n\n\nvar defaultOptions = {\n  // Maximum number of cached textures for previously visible tiles.\n  previouslyVisibleCacheSize: 512\n};\n\n\n// Assign an id to each operation so we can track its state.\n// We actually only need this in debug mode, but the code is less convoluted\n// if we track unconditionally, and the performance hit is minimal anyway.\nvar nextId = 0;\n\n\n// Distinguishes a cancellation from other kinds of errors.\nfunction CancelError() {}\ninherits(CancelError, Error);\n\n\n/**\n * @class TextureStoreItem\n * @classdesc\n *\n * An item saved in a {@link TextureStore}.\n *\n * Clients do not need to instantiate this. It is automatically instantiated by\n * a {@link TextureStore} to manage the lifetime of a stored item: loading,\n * refreshing, unloading and emitting associated events.\n *\n * @param {TextureStore} store The underlying {@link TextureStore}.\n * @param {Tile} tile The underlying tile.\n */\nfunction TextureStoreItem(store, tile) {\n\n  var self = this;\n\n  var id = nextId++;\n\n  self._id = id;\n  self._store = store;\n  self._tile = tile;\n\n  self._asset = null;\n  self._texture = null;\n\n  self._changeHandler = function() {\n    store.emit('textureInvalid', tile);\n  };\n\n  var source = store.source();\n  var stage = store.stage();\n\n  var loadAsset = source.loadAsset.bind(source);\n  var createTexture = stage.createTexture.bind(stage);\n\n  // Retry loading the asset until it succeeds, then create the texture from it.\n  // This process may be canceled at any point by calling the destroy() method.\n  var fn = chain(retry(loadAsset), createTexture);\n\n  store.emit('textureStartLoad', tile);\n  if (debug) {\n    console.log('loading', id, tile);\n  }\n\n  self._cancel = fn(stage, tile, function(err, _tile, asset, texture) {\n\n    // Make sure we do not call cancel after the operation is complete.\n    self._cancel = null;\n\n    if (err) {\n      // The loading process was interrupted by an error.\n      // This could either be because the texture creation failed, or because\n      // the operation was canceled before the loading was complete.\n\n      // Destroy the asset and texture, if they exist.\n      if (asset) {\n        asset.destroy();\n      }\n      if (texture) {\n        texture.destroy();\n      }\n\n      // Emit events.\n      if (err instanceof CancelError) {\n        store.emit('textureCancel', tile);\n        if (debug) {\n          console.log('cancel', id, tile);\n        }\n      } else {\n        store.emit('textureError', tile, err);\n        if (debug) {\n          console.log('error', id, tile);\n        }\n      }\n\n      return;\n    }\n\n    // Save a local reference to the texture.\n    self._texture = texture;\n\n    // If the asset is dynamic, save a local reference to it and set up a\n    // handler to be called whenever it changes. Otherwise, destroy the asset\n    // as we won't be needing it any longer.\n    if (asset.isDynamic()) {\n      self._asset = asset;\n      asset.addEventListener('change', self._changeHandler);\n    } else {\n      asset.destroy();\n    }\n\n    // Emit event.\n    store.emit('textureLoad', tile);\n    if (debug) {\n      console.log('load', id, tile);\n    }\n  });\n\n}\n\n\nTextureStoreItem.prototype.asset = function() {\n  return this._asset;\n};\n\n\nTextureStoreItem.prototype.texture = function() {\n  return this._texture;\n};\n\n\nTextureStoreItem.prototype.destroy = function() {\n  var id = this._id;\n  var store = this._store;\n  var tile = this._tile;\n  var asset = this._asset;\n  var texture = this._texture;\n  var cancel = this._cancel;\n\n  if (cancel) {\n    // The texture is still loading, so cancel it.\n    cancel(new CancelError('Texture load cancelled'));\n    return;\n  }\n\n  // Destroy asset.\n  if (asset) {\n    asset.removeEventListener('change', this._changeHandler);\n    asset.destroy();\n  }\n\n  // Destroy texture.\n  if (texture) {\n    texture.destroy();\n  }\n\n  // Emit event.\n  store.emit('textureUnload', tile);\n  if (debug) {\n    console.log('unload', id, tile);\n  }\n\n  clearOwnProperties(this);\n};\n\neventEmitter(TextureStoreItem);\n\n/**\n * Signals that a texture has started to load.\n *\n * This event is followed by either {@link TextureStore#textureLoad},\n * {@link TextureStore#textureError} or {@link TextureStore#textureCancel}.\n *\n * @event TextureStore#textureStartLoad\n * @param {Tile} tile The tile for which the texture has started to load.\n */\n\n/**\n * Signals that a texture has been loaded.\n *\n * @event TextureStore#textureLoad\n * @param {Tile} tile The tile for which the texture was loaded.\n */\n\n/**\n * Signals that a texture has been unloaded.\n *\n * @event TextureStore#textureUnload\n * @param {Tile} tile The tile for which the texture was unloaded.\n */\n\n/**\n * Signals that a texture has been invalidated.\n *\n * This event may be raised for a texture with an underlying dynamic asset. It\n * may only occur while the texture is loaded, i.e., in between\n * {@link TextureStore#textureLoad} and {@link TextureStore#textureUnload}.\n *\n * @event TextureStore#textureInvalid\n * @param {Tile} tile The tile for which the texture was invalidated.\n */\n\n/**\n * Signals that loading a texture has been cancelled.\n *\n * This event may follow {@link TextureStore#textureStartLoad} if the texture\n * becomes unnecessary before it finishes loading.\n *\n * @event TextureStore#textureCancel\n * @param {Tile} tile The tile for which the texture loading was cancelled.\n */\n\n/**\n * Signals that loading a texture has failed.\n *\n * This event may follow {@link TextureStore#textureStartLoad} if the texture\n * fails to load.\n *\n * @event TextureStore#textureError\n * @param {Tile} tile The tile for which the texture loading has failed.\n */\n\n/**\n * @class TextureStore\n * @classdesc\n *\n * A TextureStore maintains a cache of textures used to render a {@link Layer}.\n *\n * A {@link Stage} communicates with the TextureStore through the startFrame(),\n * markTile() and endFrame() methods, which indicate the tiles that are visible\n * in the current frame. Textures for visible tiles are loaded and retained\n * as long as the tiles remain visible. A limited amount of textures whose\n * tiles were previously visible are cached according to an LRU policy. Tiles\n * may be pinned to keep their respective textures cached even when they are\n * invisible; these textures do not count towards the previously visible limit.\n *\n * Multiple layers belonging to the same underlying {@link WebGlStage} may\n * share the same TextureStore. Layers belonging to distinct {@link WebGlStage}\n * instances may not do so due to restrictions on the use of textures across\n * stages.\n *\n * @param {Source} source The underlying source.\n * @param {Stage} stage The underlying stage.\n * @param {Object} opts Options.\n * @param {Number} [opts.previouslyVisibleCacheSize=32] The maximum number of\n *     previously visible textures to cache according to an LRU policy.\n */\nfunction TextureStore(source, stage, opts) {\n  opts = defaults(opts || {}, defaultOptions);\n\n  this._source = source;\n  this._stage = stage;\n\n  // The current state.\n  this._state = State.IDLE;\n\n  // The number of startFrame calls yet to be matched by endFrame calls during\n  // the current frame.\n  this._delimCount = 0;\n\n  // The cache proper: map cached tiles to their respective textures/assets.\n  this._itemMap = new Map();\n\n  // The subset of cached tiles that are currently visible.\n  this._visible = new Set();\n\n  // The subset of cached tiles that were visible recently, but are not\n  // visible right now. Newly inserted tiles replace older ones.\n  this._previouslyVisible = new LruSet(opts.previouslyVisibleCacheSize);\n\n  // The subset of cached tiles that should never be evicted from the cache.\n  // A tile may be pinned more than once; map each tile into a reference count.\n  this._pinMap = new Map();\n\n  // Temporary variables.\n  this._newVisible = new Set();\n  this._noLongerVisible = [];\n  this._visibleAgain = [];\n  this._evicted = [];\n}\n\neventEmitter(TextureStore);\n\n\n/**\n * Destructor.\n */\nTextureStore.prototype.destroy = function() {\n  this.clear();\n  clearOwnProperties(this);\n};\n\n\n/**\n * Return the underlying {@link Stage}.\n * @return {Stage}\n */\nTextureStore.prototype.stage = function() {\n  return this._stage;\n};\n\n\n/**\n * Return the underlying {@link Source}.\n * @return {Source}\n */\nTextureStore.prototype.source = function() {\n  return this._source;\n};\n\n\n/**\n * Remove all textures from the TextureStore, including pinned textures.\n */\nTextureStore.prototype.clear = function() {\n  var self = this;\n\n  // Collect list of tiles to be evicted.\n  self._evicted.length = 0;\n  self._itemMap.forEach(function(tile) {\n    self._evicted.push(tile);\n  });\n\n  // Evict tiles.\n  self._evicted.forEach(function(tile) {\n    self._unloadTile(tile);\n  });\n\n  // Clear all internal state.\n  self._itemMap.clear();\n  self._visible.clear();\n  self._previouslyVisible.clear();\n  self._pinMap.clear();\n  self._newVisible.clear();\n  self._noLongerVisible.length = 0;\n  self._visibleAgain.length = 0;\n  self._evicted.length = 0;\n};\n\n\n/**\n * Remove all textures in the TextureStore, excluding unpinned textures.\n */\nTextureStore.prototype.clearNotPinned = function() {\n  var self = this;\n\n  // Collect list of tiles to be evicted.\n  self._evicted.length = 0;\n  self._itemMap.forEach(function(tile) {\n    if (!self._pinMap.has(tile)) {\n      self._evicted.push(tile);\n    }\n  });\n\n  // Evict tiles.\n  self._evicted.forEach(function(tile) {\n    self._unloadTile(tile);\n  });\n\n  // Clear all caches except the pinned set.\n  self._visible.clear();\n  self._previouslyVisible.clear();\n\n  // Clear temporary variables.\n  self._evicted.length = 0;\n};\n\n\n/**\n * Signal the beginning of a frame. Called from {@link Stage}.\n */\nTextureStore.prototype.startFrame = function() {\n  // Check that we are in an appropriate state.\n  if (this._state !== State.IDLE && this._state !== State.START) {\n    throw new Error('TextureStore: startFrame called out of sequence');\n  }\n\n  // Enter the START state, if not already there.\n  this._state = State.START;\n\n  // Expect one more endFrame call.\n  this._delimCount++;\n};\n\n\n/**\n * Mark a tile as visible within the current frame. Called from {@link Stage}.\n * @param {Tile} tile The tile to mark.\n */\nTextureStore.prototype.markTile = function(tile) {\n  // Check that we are in an appropriate state.\n  if (this._state !== State.START && this._state !== State.MARK) {\n    throw new Error('TextureStore: markTile called out of sequence');\n  }\n\n  // Enter the MARK state, if not already there.\n  this._state = State.MARK;\n\n  // Refresh texture for dynamic assets.\n  var item = this._itemMap.get(tile);\n  var texture = item && item.texture();\n  var asset = item && item.asset();\n  if (texture && asset) {\n    texture.refresh(tile, asset);\n  }\n\n  // Add tile to the visible set.\n  this._newVisible.add(tile);\n};\n\n\n/**\n * Signal the end of a frame. Called from {@link Stage}.\n */\nTextureStore.prototype.endFrame = function() {\n  // Check that we are in an appropriate state.\n  if (this._state !== State.START && this._state !== State.MARK && this._state !== State.END) {\n    throw new Error('TextureStore: endFrame called out of sequence');\n  }\n\n  // Enter the END state, if not already there.\n  this._state = State.END;\n\n  // Expect one less call to endFrame.\n  this._delimCount--;\n\n  // If no further calls are expected, process frame and enter the IDLE state.\n  if (!this._delimCount) {\n    this._update();\n    this._state = State.IDLE;\n  }\n};\n\n\nTextureStore.prototype._update = function() {\n  var self = this;\n\n  // Calculate the set of tiles that used to be visible but no longer are.\n  self._noLongerVisible.length = 0;\n  self._visible.forEach(function(tile) {\n    if (!self._newVisible.has(tile)) {\n      self._noLongerVisible.push(tile);\n    }\n  });\n\n  // Calculate the set of tiles that were visible recently and have become\n  // visible again.\n  self._visibleAgain.length = 0;\n  self._newVisible.forEach(function(tile) {\n    if (self._previouslyVisible.has(tile)) {\n      self._visibleAgain.push(tile);\n    }\n  });\n\n  // Remove tiles that have become visible again from the list of previously\n  // visible tiles.\n  self._visibleAgain.forEach(function(tile) {\n    self._previouslyVisible.remove(tile);\n  });\n\n  // Cancel loading of tiles that are no longer visible.\n  // Move no longer visible tiles with a loaded texture into the previously\n  // visible set, and collect the tiles evicted from the latter.\n  self._evicted.length = 0;\n  self._noLongerVisible.forEach(function(tile) {\n    var item = self._itemMap.get(tile);\n    var texture = item && item.texture();\n    if (texture) {\n      var otherTile = self._previouslyVisible.add(tile);\n      if (otherTile != null) {\n        self._evicted.push(otherTile);\n      }\n    } else if (item) {\n      self._unloadTile(tile);\n    }\n  });\n\n  // Unload evicted tiles, unless they are pinned.\n  self._evicted.forEach(function(tile) {\n    if (!self._pinMap.has(tile)) {\n      self._unloadTile(tile);\n    }\n  });\n\n  // Load visible tiles that are not already in the store.\n  // Refresh texture on visible tiles for dynamic assets.\n  self._newVisible.forEach(function(tile) {\n    var item = self._itemMap.get(tile);\n    if (!item) {\n      self._loadTile(tile);\n    }\n  });\n\n  // Swap the old visible set with the new one.\n  var tmp = self._visible;\n  self._visible = self._newVisible;\n  self._newVisible = tmp;\n\n  // Clear the new visible set.\n  self._newVisible.clear();\n\n  // Clear temporary variables.\n  self._noLongerVisible.length = 0;\n  self._visibleAgain.length = 0;\n  self._evicted.length = 0;\n};\n\n\nTextureStore.prototype._loadTile = function(tile) {\n  if (this._itemMap.has(tile)) {\n    throw new Error('TextureStore: loading texture already in cache');\n  }\n  var item = new TextureStoreItem(this, tile);\n  this._itemMap.set(tile, item);\n};\n\n\nTextureStore.prototype._unloadTile = function(tile) {\n  var item = this._itemMap.del(tile);\n  if (!item) {\n    throw new Error('TextureStore: unloading texture not in cache');\n  }\n  item.destroy();\n};\n\n\nTextureStore.prototype.asset = function(tile) {\n  var item = this._itemMap.get(tile);\n  if (item) {\n    return item.asset();\n  }\n  return null;\n};\n\n\nTextureStore.prototype.texture = function(tile) {\n  var item = this._itemMap.get(tile);\n  if (item) {\n    return item.texture();\n  }\n  return null;\n};\n\n\n/**\n * Pin a tile. Textures for pinned tiles are never evicted from the store.\n * Upon pinning, the texture is created if not already present. Pins are\n * reference-counted; a tile may be pinned multiple times and must be unpinned\n * the corresponding number of times. Pinning is useful e.g. to ensure that\n * the lowest-resolution level of an image is always available to fall back\n * onto.\n * @param {Tile} tile the tile to pin\n * @returns {number} the pin reference count.\n */\nTextureStore.prototype.pin = function(tile) {\n  // Increment reference count.\n  var count = (this._pinMap.get(tile) || 0) + 1;\n  this._pinMap.set(tile, count);\n  // If the texture for the tile is not present, load it now.\n  if (!this._itemMap.has(tile)) {\n    this._loadTile(tile);\n  }\n  return count;\n};\n\n\n/**\n * Unpin a tile. Pins are reference-counted; a tile may be pinned multiple\n * times and must be unpinned the corresponding number of times.\n * @param {Tile} tile the tile to unpin\n * @returns {number} the pin reference count.\n */\nTextureStore.prototype.unpin = function(tile) {\n  var count = this._pinMap.get(tile);\n  // Consistency check.\n  if (!count) {\n    throw new Error('TextureStore: unpin when not pinned');\n  } else {\n    // Decrement reference count.\n    count--;\n    if (count > 0) {\n      this._pinMap.set(tile, count);\n    } else {\n      this._pinMap.del(tile);\n      // If the tile does not belong to either the visible or previously\n      // visible sets, evict it from the cache.\n      if (!this._visible.has(tile) && !this._previouslyVisible.has(tile)) {\n        this._unloadTile(tile);\n      }\n    }\n  }\n  return count;\n};\n\n\n/**\n * Return type for {@link TextureStore#query}.\n * @typedef {Object} TileState\n * @property {boolean} visible Whether the tile is in the visible set.\n * @property {boolean} previouslyVisible Whether the tile is in the previously\n *     visible set.\n * @property {boolean} hasAsset Whether the asset for the tile is present.\n * @property {boolean} hasTexture Whether the texture for the tile is present.\n * @property {boolean} pinned Whether the tile is in the pinned set.\n * @property {number} pinCount The pin reference count for the tile.\n */\n\n\n/**\n * Return the state of a tile.\n * @param {Tile} tile The tile to query.\n * @return {TileState}\n */\nTextureStore.prototype.query = function(tile) {\n  var item = this._itemMap.get(tile);\n  var pinCount = this._pinMap.get(tile) || 0;\n  return {\n    visible: this._visible.has(tile),\n    previouslyVisible: this._previouslyVisible.has(tile),\n    hasAsset: item != null && item.asset() != null,\n    hasTexture: item != null && item.texture() != null,\n    pinned: pinCount !== 0,\n    pinCount: pinCount\n  };\n};\n\n\nmodule.exports = TextureStore;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction extend(obj, sourceObj) {\n  for (var key in sourceObj) {\n    obj[key] = sourceObj[key];\n  }\n  return obj;\n}\n\nmodule.exports = extend;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n\nvar eventEmitter = require('minimal-event-emitter');\nvar extend = require('./util/extend');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that the layer has been rendered.\n *\n * @param {boolean} stable Whether all tiles were successfully rendered without\n *     missing textures or resorting to fallbacks.\n * @event Layer#renderComplete\n */\n\n/**\n * @class Layer\n * @classdesc\n *\n * A Layer is a combination of {@link Source}, {@link Geometry}, {@link View}\n * and {@link TextureStore} that may be added into a {@link Stage} and rendered\n * with {@link Effects}.\n *\n * @param {Source} source\n * @param {Geometry} geometry\n * @param {View} view\n * @param {TextureStore} textureStore\n * @param {Object} opts\n * @param {Effects} opts.effects\n*/\nfunction Layer(source, geometry, view, textureStore, opts) {\n  opts = opts || {};\n\n  var self = this;\n\n  this._source = source;\n  this._geometry = geometry;\n  this._view = view;\n  this._textureStore = textureStore;\n\n  this._effects = opts.effects || {};\n\n  this._fixedLevelIndex = null;\n\n  this._viewChangeHandler = function() {\n    self.emit('viewChange', self.view());\n  };\n\n  this._view.addEventListener('change', this._viewChangeHandler);\n\n  this._textureStoreChangeHandler = function() {\n    self.emit('textureStoreChange', self.textureStore());\n  };\n\n  this._textureStore.addEventListener('textureLoad',\n    this._textureStoreChangeHandler);\n  this._textureStore.addEventListener('textureError',\n    this._textureStoreChangeHandler);\n  this._textureStore.addEventListener('textureInvalid',\n    this._textureStoreChangeHandler);\n}\n\neventEmitter(Layer);\n\n\n/**\n * Destructor.\n */\nLayer.prototype.destroy = function() {\n  this._view.removeEventListener('change', this._viewChangeHandler);\n  this._textureStore.removeEventListener('textureLoad',\n    this._textureStoreChangeHandler);\n  this._textureStore.removeEventListener('textureError',\n    this._textureStoreChangeHandler);\n  this._textureStore.removeEventListener('textureInvalid',\n    this._textureStoreChangeHandler);\n  clearOwnProperties(this);\n};\n\n\n/**\n * Returns the underlying {@link Source source}.\n * @return {Source}\n */\nLayer.prototype.source = function() {\n  return this._source;\n};\n\n\n/**\n * Returns the underlying {@link Geometry geometry}.\n * @return {Geometry}\n */\nLayer.prototype.geometry = function() {\n  return this._geometry;\n};\n\n\n/**\n * Returns the underlying {@link View view}.\n * @return {View}\n */\nLayer.prototype.view = function() {\n  return this._view;\n};\n\n\n/**\n * Returns the underlying {@link TextureStore texture store}.\n * @return {TextureStore}\n */\nLayer.prototype.textureStore = function() {\n  return this._textureStore;\n};\n\n\n/**\n * Returns the currently set {@link Effects effects}.\n * @return {Effects}\n */\nLayer.prototype.effects = function() {\n  return this._effects;\n};\n\n\n/**\n * Sets the {@link Effects effects}.\n * @param {Effects} effects\n */\nLayer.prototype.setEffects = function(effects) {\n  this._effects = effects;\n  this.emit('effectsChange', this._effects);\n};\n\n\n/**\n * Merges effects into the currently set ones. The merge is non-recursive; for\n * instance, if current effects are `{ rect: { relativeWidth: 0.5 } }`,\n * calling this method with `{ rect: { relativeX: 0.5 }}` will reset\n * `rect.relativeWidth`.\n *\n * @param {Effects} effects\n */\nLayer.prototype.mergeEffects = function(effects) {\n  extend(this._effects, effects);\n  this.emit('effectsChange', this._effects);\n};\n\n\n/**\n * Returns the fixed level index.\n * @return {(number|null)}\n */\nLayer.prototype.fixedLevel = function() {\n  return this._fixedLevelIndex;\n};\n\n\n/**\n * Sets the fixed level index. When set, the corresponding level will be\n * used regardless of the view parameters. Unset with a null argument.\n *\n * @param {(number|null)} levelIndex\n * @throws An error if the level index is out of range.\n */\nLayer.prototype.setFixedLevel = function(levelIndex) {\n  if (levelIndex !== this._fixedLevelIndex) {\n    if (levelIndex != null && (levelIndex >= this._geometry.levelList.length ||\n        levelIndex < 0)) {\n      throw new Error(\"Level index out of range: \" + levelIndex);\n    }\n    this._fixedLevelIndex = levelIndex;\n    this.emit('fixedLevelChange', this._fixedLevelIndex);\n  }\n};\n\n\nLayer.prototype._selectLevel = function() {\n  var level;\n  if (this._fixedLevelIndex != null) {\n    level = this._geometry.levelList[this._fixedLevelIndex];\n  } else {\n    level = this._view.selectLevel(this._geometry.selectableLevelList);\n  }\n  return level;\n};\n\n\nLayer.prototype.visibleTiles = function(result) {\n  var level = this._selectLevel();\n  return this._geometry.visibleTiles(this._view, level, result);\n};\n\n\n/**\n * Pin a whole level into the texture store.\n * @param {Number} levelIndex\n */\nLayer.prototype.pinLevel = function(levelIndex) {\n  var level = this._geometry.levelList[levelIndex];\n  var tiles = this._geometry.levelTiles(level);\n  for (var i = 0; i < tiles.length; i++) {\n    this._textureStore.pin(tiles[i]);\n  }\n};\n\n\n/**\n * Unpin a whole level from the texture store.\n * @param {Number} levelIndex\n */\nLayer.prototype.unpinLevel = function(levelIndex) {\n  var level = this._geometry.levelList[levelIndex];\n  var tiles = this._geometry.levelTiles(level);\n  for (var i = 0; i < tiles.length; i++) {\n    this._textureStore.unpin(tiles[i]);\n  }\n};\n\n\n/**\n * Pin the first level. Equivalent to `pinLevel(0)`.\n */\nLayer.prototype.pinFirstLevel = function() {\n  return this.pinLevel(0);\n};\n\n\n/**\n * Unpin the first level. Equivalent to `unpinLevel(0)`.\n */\nLayer.prototype.unpinFirstLevel = function() {\n  return this.unpinLevel(0);\n};\n\n\nmodule.exports = Layer;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that {@link Stage#render} is about to be called.\n * @event RenderLoop#beforeRender\n */\n\n/**\n * Signals that {@link Stage#render} has just been called.\n * @event RenderLoop#afterRender\n */\n\n/**\n * @class RenderLoop\n * @classdesc\n *\n * A RenderLoop wraps a {@link Stage} and calls {@link Stage#render} on the next\n * frame whenever it fires {@link Stage#renderInvalid}. It may be started and\n * stopped, and is initially in the stopped state, in which no call to\n * {@link Stage#render} occurs.\n *\n * @listens Stage#renderInvalid\n *\n * @param {Stage} stage\n */\nfunction RenderLoop(stage) {\n\n  var self = this;\n\n  // The stage wrapped by the loop.\n  this._stage = stage;\n\n  // Whether the loop is running.\n  this._running = false;\n\n  // Whether the loop is currently rendering.\n  this._rendering = false;\n\n  // The current requestAnimationFrame handle.\n  this._requestHandle = null;\n\n  // The callback passed into requestAnimationFrame.\n  this._boundLoop = this._loop.bind(this);\n\n  // Handler for renderInvalid events emitted by the stage.\n  this._renderInvalidHandler = function() {\n    // If we are already rendering, there's no need to schedule a new render\n    // on the next frame.\n    if (!self._rendering) {\n      self.renderOnNextFrame();\n    }\n  };\n\n  // Handle renderInvalid events emitted by the stage.\n  this._stage.addEventListener('renderInvalid', this._renderInvalidHandler);\n\n}\n\neventEmitter(RenderLoop);\n\n\n/**\n * Destructor.\n */\nRenderLoop.prototype.destroy = function() {\n  this.stop();\n  this._stage.removeEventListener('renderInvalid', this._renderInvalidHandler);\n  clearOwnProperties(this);\n};\n\n\n/**\n * Returns the underlying stage.\n * @return {Stage}\n */\nRenderLoop.prototype.stage = function() {\n  return this._stage;\n};\n\n\n/**\n * Starts the render loop.\n */\nRenderLoop.prototype.start = function() {\n  this._running = true;\n  this.renderOnNextFrame();\n};\n\n\n/**\n * Stops the render loop.\n */\nRenderLoop.prototype.stop = function() {\n  if (this._requestHandle) {\n    window.cancelAnimationFrame(this._requestHandle);\n    this._requestHandle = null;\n  }\n  this._running = false;\n};\n\n\n/**\n * Forces the stage to render on the next frame, even if its contents remain\n * valid. Does nothing if the loop is stopped.\n */\nRenderLoop.prototype.renderOnNextFrame = function() {\n  if (this._running && !this._requestHandle) {\n    this._requestHandle = window.requestAnimationFrame(this._boundLoop);\n  }\n};\n\n\nRenderLoop.prototype._loop = function() {\n  if (!this._running) {\n    throw new Error('Render loop running while in stopped state');\n  }\n  this._requestHandle = null;\n  this._rendering = true;\n  this.emit('beforeRender');\n  this._rendering = false;\n  this._stage.render();\n  this.emit('afterRender');\n};\n\n\nmodule.exports = RenderLoop;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @class Dynamics\n * @classdesc\n *\n * Represents how a control parameter changes. Used in the events emitted by\n * {@link ControlMethod}.\n *\n * @property {number} offset Parameter changed by a fixed value\n * @property {number} velocity Parameter is changing at this velocity\n * @property {number} friction The velocity will decrease at this rate\n */\nfunction Dynamics() {\n  this.velocity = null;\n  this.friction = null;\n  this.offset = null;\n}\n\nDynamics.equals = function(d1, d2) {\n  return d1.velocity === d2.velocity && d1.friction === d2.friction && d1.offset === d2.offset;\n};\n\nDynamics.prototype.equals = function(other) {\n  return Dynamics.equals(this, other);\n};\n\nDynamics.prototype.update = function(other, elapsed) {\n  if (other.offset) {\n    // If other has an offset, make this.offset a number instead of null\n    this.offset = this.offset || 0;\n    this.offset += other.offset;\n  }\n\n  var offsetFromVelocity = this.offsetFromVelocity(elapsed);\n  if (offsetFromVelocity) {\n    // If there is an offset to add from the velocity, make this offset a number instead of null\n    this.offset = this.offset || 0;\n    this.offset += offsetFromVelocity;\n  }\n\n  this.velocity = other.velocity;\n  this.friction = other.friction;\n};\n\nDynamics.prototype.reset = function() {\n  this.velocity = null;\n  this.friction = null;\n  this.offset = null;\n};\n\n\nDynamics.prototype.velocityAfter = function(elapsed) {\n  if (!this.velocity) {\n    return null;\n  }\n  if (this.friction) {\n    return decreaseAbs(this.velocity, this.friction *elapsed);\n  }\n  return this.velocity;\n};\n\nDynamics.prototype.offsetFromVelocity = function(elapsed) {\n  elapsed = Math.min(elapsed, this.nullVelocityTime());\n\n  var velocityEnd = this.velocityAfter(elapsed);\n  var averageVelocity = (this.velocity + velocityEnd) / 2;\n\n  return averageVelocity * elapsed;\n};\n\n\nDynamics.prototype.nullVelocityTime = function() {\n  if (this.velocity == null) {\n    return 0;\n  }\n  if (this.velocity && !this.friction) {\n    return Infinity;\n  }\n  return Math.abs(this.velocity / this.friction);\n};\n\nfunction decreaseAbs(num, dec) {\n  if (num < 0) {\n    return Math.min(0, num + dec);\n  }\n  if (num > 0) {\n    return Math.max(0, num - dec);\n  }\n  return 0;\n}\n\nmodule.exports = Dynamics;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class KeyControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Sets the velocity and friction of a single parameter by pressing and\n * unpressing a key.\n *\n * @param {number} keyCode Key which activates the method when pressed\n * @param {string} parameter The parameter to be controlled (e.g. `x`, `y` or `zoom`)\n * @param {number} velocity Velocity at which the parameter changes. Use a\n * negative number for opposite direction\n * @param {number} friction Friction at which the parameter stops\n * @param {Element} [element=document] DOM element where the key events are listened to\n */\nfunction KeyControlMethod(keyCode, parameter, velocity, friction, element) {\n  if(!keyCode) {\n    throw new Error(\"KeyControlMethod: keyCode must be defined\");\n  }\n  if(!parameter) {\n    throw new Error(\"KeyControlMethod: parameter must be defined\");\n  }\n  if(!velocity) {\n    throw new Error(\"KeyControlMethod: velocity must be defined\");\n  }\n  if(!friction) {\n    throw new Error(\"KeyControlMethod: friction must be defined\");\n  }\n\n  element = element || document;\n\n  this._keyCode = keyCode;\n  this._parameter = parameter;\n  this._velocity = velocity;\n  this._friction = friction;\n  this._element = element;\n\n  this._keydownHandler = this._handlePress.bind(this);\n  this._keyupHandler = this._handleRelease.bind(this);\n  this._blurHandler = this._handleBlur.bind(this);\n\n  this._element.addEventListener('keydown', this._keydownHandler);\n  this._element.addEventListener('keyup', this._keyupHandler);\n  window.addEventListener('blur', this._blurHandler);\n\n  this._dynamics = new Dynamics();\n  this._pressing = false;\n}\neventEmitter(KeyControlMethod);\n\n/**\n * Destructor.\n */\nKeyControlMethod.prototype.destroy = function() {\n  this._element.removeEventListener('keydown', this._keydownHandler);\n  this._element.removeEventListener('keyup', this._keyupHandler);\n  window.removeEventListener('blur', this._blurHandler);\n  clearOwnProperties(this);\n};\n\nKeyControlMethod.prototype._handlePress = function(e) {\n  if(e.keyCode !== this._keyCode) { return; }\n\n  this._pressing = true;\n\n  this._dynamics.velocity = this._velocity;\n  this._dynamics.friction = 0;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n  this.emit('active');\n};\n\nKeyControlMethod.prototype._handleRelease = function(e) {\n  if(e.keyCode !== this._keyCode) { return; }\n\n  if(this._pressing) {\n    this._dynamics.friction = this._friction;\n    this.emit('parameterDynamics', this._parameter, this._dynamics);\n    this.emit('inactive');\n  }\n\n  this._pressing = false;\n};\n\nKeyControlMethod.prototype._handleBlur = function() {\n  this._dynamics.velocity = 0;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n  this.emit('inactive');\n\n  this._pressing = false;\n};\n\nmodule.exports = KeyControlMethod;\n", "/*! Hammer.JS - v2.0.4 - 2014-09-28\r\n * http://hammerjs.github.io/\r\n *\r\n * Copyright (c) 2014 Jorik Tangelder;\r\n * Licensed under the MIT license */\r\n(function(window, document, exportName, undefined) {\r\n  'use strict';\r\n\r\nvar VENDOR_PREFIXES = ['', 'webkit', 'moz', 'MS', 'ms', 'o'];\r\nvar TEST_ELEMENT = document.createElement('div');\r\n\r\nvar TYPE_FUNCTION = 'function';\r\n\r\nvar round = Math.round;\r\nvar abs = Math.abs;\r\nvar now = Date.now;\r\n\r\n/**\r\n * set a timeout with a given scope\r\n * @param {Function} fn\r\n * @param {Number} timeout\r\n * @param {Object} context\r\n * @returns {number}\r\n */\r\nfunction setTimeoutContext(fn, timeout, context) {\r\n    return setTimeout(bindFn(fn, context), timeout);\r\n}\r\n\r\n/**\r\n * if the argument is an array, we want to execute the fn on each entry\r\n * if it aint an array we don't want to do a thing.\r\n * this is used by all the methods that accept a single and array argument.\r\n * @param {*|Array} arg\r\n * @param {String} fn\r\n * @param {Object} [context]\r\n * @returns {Boolean}\r\n */\r\nfunction invokeArrayArg(arg, fn, context) {\r\n    if (Array.isArray(arg)) {\r\n        each(arg, context[fn], context);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * walk objects and arrays\r\n * @param {Object} obj\r\n * @param {Function} iterator\r\n * @param {Object} context\r\n */\r\nfunction each(obj, iterator, context) {\r\n    var i;\r\n\r\n    if (!obj) {\r\n        return;\r\n    }\r\n\r\n    if (obj.forEach) {\r\n        obj.forEach(iterator, context);\r\n    } else if (obj.length !== undefined) {\r\n        i = 0;\r\n        while (i < obj.length) {\r\n            iterator.call(context, obj[i], i, obj);\r\n            i++;\r\n        }\r\n    } else {\r\n        for (i in obj) {\r\n            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * extend object.\r\n * means that properties in dest will be overwritten by the ones in src.\r\n * @param {Object} dest\r\n * @param {Object} src\r\n * @param {Boolean} [merge]\r\n * @returns {Object} dest\r\n */\r\nfunction extend(dest, src, merge) {\r\n    var keys = Object.keys(src);\r\n    var i = 0;\r\n    while (i < keys.length) {\r\n        if (!merge || (merge && dest[keys[i]] === undefined)) {\r\n            dest[keys[i]] = src[keys[i]];\r\n        }\r\n        i++;\r\n    }\r\n    return dest;\r\n}\r\n\r\n/**\r\n * merge the values from src in the dest.\r\n * means that properties that exist in dest will not be overwritten by src\r\n * @param {Object} dest\r\n * @param {Object} src\r\n * @returns {Object} dest\r\n */\r\nfunction merge(dest, src) {\r\n    return extend(dest, src, true);\r\n}\r\n\r\n/**\r\n * simple class inheritance\r\n * @param {Function} child\r\n * @param {Function} base\r\n * @param {Object} [properties]\r\n */\r\nfunction inherit(child, base, properties) {\r\n    var baseP = base.prototype,\r\n        childP;\r\n\r\n    childP = child.prototype = Object.create(baseP);\r\n    childP.constructor = child;\r\n    childP._super = baseP;\r\n\r\n    if (properties) {\r\n        extend(childP, properties);\r\n    }\r\n}\r\n\r\n/**\r\n * simple function bind\r\n * @param {Function} fn\r\n * @param {Object} context\r\n * @returns {Function}\r\n */\r\nfunction bindFn(fn, context) {\r\n    return function boundFn() {\r\n        return fn.apply(context, arguments);\r\n    };\r\n}\r\n\r\n/**\r\n * let a boolean value also be a function that must return a boolean\r\n * this first item in args will be used as the context\r\n * @param {Boolean|Function} val\r\n * @param {Array} [args]\r\n * @returns {Boolean}\r\n */\r\nfunction boolOrFn(val, args) {\r\n    if (typeof val == TYPE_FUNCTION) {\r\n        return val.apply(args ? args[0] || undefined : undefined, args);\r\n    }\r\n    return val;\r\n}\r\n\r\n/**\r\n * use the val2 when val1 is undefined\r\n * @param {*} val1\r\n * @param {*} val2\r\n * @returns {*}\r\n */\r\nfunction ifUndefined(val1, val2) {\r\n    return (val1 === undefined) ? val2 : val1;\r\n}\r\n\r\n/**\r\n * addEventListener with multiple events at once\r\n * @param {EventTarget} target\r\n * @param {String} types\r\n * @param {Function} handler\r\n */\r\nfunction addEventListeners(target, types, handler) {\r\n    each(splitStr(types), function(type) {\r\n        target.addEventListener(type, handler, false);\r\n    });\r\n}\r\n\r\n/**\r\n * removeEventListener with multiple events at once\r\n * @param {EventTarget} target\r\n * @param {String} types\r\n * @param {Function} handler\r\n */\r\nfunction removeEventListeners(target, types, handler) {\r\n    each(splitStr(types), function(type) {\r\n        target.removeEventListener(type, handler, false);\r\n    });\r\n}\r\n\r\n/**\r\n * find if a node is in the given parent\r\n * @method hasParent\r\n * @param {HTMLElement} node\r\n * @param {HTMLElement} parent\r\n * @return {Boolean} found\r\n */\r\nfunction hasParent(node, parent) {\r\n    while (node) {\r\n        if (node == parent) {\r\n            return true;\r\n        }\r\n        node = node.parentNode;\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * small indexOf wrapper\r\n * @param {String} str\r\n * @param {String} find\r\n * @returns {Boolean} found\r\n */\r\nfunction inStr(str, find) {\r\n    return str.indexOf(find) > -1;\r\n}\r\n\r\n/**\r\n * split string on whitespace\r\n * @param {String} str\r\n * @returns {Array} words\r\n */\r\nfunction splitStr(str) {\r\n    return str.trim().split(/\\s+/g);\r\n}\r\n\r\n/**\r\n * find if a array contains the object using indexOf or a simple polyFill\r\n * @param {Array} src\r\n * @param {String} find\r\n * @param {String} [findByKey]\r\n * @return {Boolean|Number} false when not found, or the index\r\n */\r\nfunction inArray(src, find, findByKey) {\r\n    if (src.indexOf && !findByKey) {\r\n        return src.indexOf(find);\r\n    } else {\r\n        var i = 0;\r\n        while (i < src.length) {\r\n            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\r\n                return i;\r\n            }\r\n            i++;\r\n        }\r\n        return -1;\r\n    }\r\n}\r\n\r\n/**\r\n * convert array-like objects to real arrays\r\n * @param {Object} obj\r\n * @returns {Array}\r\n */\r\nfunction toArray(obj) {\r\n    return Array.prototype.slice.call(obj, 0);\r\n}\r\n\r\n/**\r\n * unique array with objects based on a key (like 'id') or just by the array's value\r\n * @param {Array} src [{id:1},{id:2},{id:1}]\r\n * @param {String} [key]\r\n * @param {Boolean} [sort=False]\r\n * @returns {Array} [{id:1},{id:2}]\r\n */\r\nfunction uniqueArray(src, key, sort) {\r\n    var results = [];\r\n    var values = [];\r\n    var i = 0;\r\n\r\n    while (i < src.length) {\r\n        var val = key ? src[i][key] : src[i];\r\n        if (inArray(values, val) < 0) {\r\n            results.push(src[i]);\r\n        }\r\n        values[i] = val;\r\n        i++;\r\n    }\r\n\r\n    if (sort) {\r\n        if (!key) {\r\n            results = results.sort();\r\n        } else {\r\n            results = results.sort(function sortUniqueArray(a, b) {\r\n                return a[key] > b[key];\r\n            });\r\n        }\r\n    }\r\n\r\n    return results;\r\n}\r\n\r\n/**\r\n * get the prefixed property\r\n * @param {Object} obj\r\n * @param {String} property\r\n * @returns {String|Undefined} prefixed\r\n */\r\nfunction prefixed(obj, property) {\r\n    var prefix, prop;\r\n    var camelProp = property[0].toUpperCase() + property.slice(1);\r\n\r\n    var i = 0;\r\n    while (i < VENDOR_PREFIXES.length) {\r\n        prefix = VENDOR_PREFIXES[i];\r\n        prop = (prefix) ? prefix + camelProp : property;\r\n\r\n        if (prop in obj) {\r\n            return prop;\r\n        }\r\n        i++;\r\n    }\r\n    return undefined;\r\n}\r\n\r\n/**\r\n * get a unique id\r\n * @returns {number} uniqueId\r\n */\r\nvar _uniqueId = 1;\r\nfunction uniqueId() {\r\n    return _uniqueId++;\r\n}\r\n\r\n/**\r\n * get the window object of an element\r\n * @param {HTMLElement} element\r\n * @returns {DocumentView|Window}\r\n */\r\nfunction getWindowForElement(element) {\r\n    var doc = element.ownerDocument;\r\n    return (doc.defaultView || doc.parentWindow);\r\n}\r\n\r\nvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\r\n\r\nvar SUPPORT_TOUCH = ('ontouchstart' in window);\r\nvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\r\nvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\r\n\r\nvar INPUT_TYPE_TOUCH = 'touch';\r\nvar INPUT_TYPE_PEN = 'pen';\r\nvar INPUT_TYPE_MOUSE = 'mouse';\r\nvar INPUT_TYPE_KINECT = 'kinect';\r\n\r\nvar COMPUTE_INTERVAL = 25;\r\n\r\nvar INPUT_START = 1;\r\nvar INPUT_MOVE = 2;\r\nvar INPUT_END = 4;\r\nvar INPUT_CANCEL = 8;\r\n\r\nvar DIRECTION_NONE = 1;\r\nvar DIRECTION_LEFT = 2;\r\nvar DIRECTION_RIGHT = 4;\r\nvar DIRECTION_UP = 8;\r\nvar DIRECTION_DOWN = 16;\r\n\r\nvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\r\nvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\r\nvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\r\n\r\nvar PROPS_XY = ['x', 'y'];\r\nvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\r\n\r\n/**\r\n * create new input type manager\r\n * @param {Manager} manager\r\n * @param {Function} callback\r\n * @returns {Input}\r\n * @constructor\r\n */\r\nfunction Input(manager, callback) {\r\n    var self = this;\r\n    this.manager = manager;\r\n    this.callback = callback;\r\n    this.element = manager.element;\r\n    this.target = manager.options.inputTarget;\r\n\r\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\r\n    // so when disabled the input events are completely bypassed.\r\n    this.domHandler = function(ev) {\r\n        if (boolOrFn(manager.options.enable, [manager])) {\r\n            self.handler(ev);\r\n        }\r\n    };\r\n\r\n    this.init();\r\n\r\n}\r\n\r\nInput.prototype = {\r\n    /**\r\n     * should handle the inputEvent data and trigger the callback\r\n     * @virtual\r\n     */\r\n    handler: function() { },\r\n\r\n    /**\r\n     * bind the events\r\n     */\r\n    init: function() {\r\n        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\r\n        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\r\n        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\r\n    },\r\n\r\n    /**\r\n     * unbind the events\r\n     */\r\n    destroy: function() {\r\n        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\r\n        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\r\n        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\r\n    }\r\n};\r\n\r\n/**\r\n * create new input type manager\r\n * called by the Manager constructor\r\n * @param {Hammer} manager\r\n * @returns {Input}\r\n */\r\nfunction createInputInstance(manager) {\r\n    var Type;\r\n    var inputClass = manager.options.inputClass;\r\n\r\n    if (inputClass) {\r\n        Type = inputClass;\r\n    } else if (SUPPORT_POINTER_EVENTS) {\r\n        Type = PointerEventInput;\r\n    } else if (SUPPORT_ONLY_TOUCH) {\r\n        Type = TouchInput;\r\n    } else if (!SUPPORT_TOUCH) {\r\n        Type = MouseInput;\r\n    } else {\r\n        Type = TouchMouseInput;\r\n    }\r\n    return new (Type)(manager, inputHandler);\r\n}\r\n\r\n/**\r\n * handle input events\r\n * @param {Manager} manager\r\n * @param {String} eventType\r\n * @param {Object} input\r\n */\r\nfunction inputHandler(manager, eventType, input) {\r\n    var pointersLen = input.pointers.length;\r\n    var changedPointersLen = input.changedPointers.length;\r\n    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\r\n    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\r\n\r\n    input.isFirst = !!isFirst;\r\n    input.isFinal = !!isFinal;\r\n\r\n    if (isFirst) {\r\n        manager.session = {};\r\n    }\r\n\r\n    // source event is the normalized value of the domEvents\r\n    // like 'touchstart, mouseup, pointerdown'\r\n    input.eventType = eventType;\r\n\r\n    // compute scale, rotation etc\r\n    computeInputData(manager, input);\r\n\r\n    // emit secret event\r\n    manager.emit('hammer.input', input);\r\n\r\n    manager.recognize(input);\r\n    manager.session.prevInput = input;\r\n}\r\n\r\n/**\r\n * extend the data with some usable properties like scale, rotate, velocity etc\r\n * @param {Object} manager\r\n * @param {Object} input\r\n */\r\nfunction computeInputData(manager, input) {\r\n    var session = manager.session;\r\n    var pointers = input.pointers;\r\n    var pointersLength = pointers.length;\r\n\r\n    // store the first input to calculate the distance and direction\r\n    if (!session.firstInput) {\r\n        session.firstInput = simpleCloneInputData(input);\r\n    }\r\n\r\n    // to compute scale and rotation we need to store the multiple touches\r\n    if (pointersLength > 1 && !session.firstMultiple) {\r\n        session.firstMultiple = simpleCloneInputData(input);\r\n    } else if (pointersLength === 1) {\r\n        session.firstMultiple = false;\r\n    }\r\n\r\n    var firstInput = session.firstInput;\r\n    var firstMultiple = session.firstMultiple;\r\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\r\n\r\n    var center = input.center = getCenter(pointers);\r\n    input.timeStamp = now();\r\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\r\n\r\n    input.angle = getAngle(offsetCenter, center);\r\n    input.distance = getDistance(offsetCenter, center);\r\n\r\n    computeDeltaXY(session, input);\r\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\r\n\r\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\r\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\r\n\r\n    computeIntervalInputData(session, input);\r\n\r\n    // find the correct target\r\n    var target = manager.element;\r\n    if (hasParent(input.srcEvent.target, target)) {\r\n        target = input.srcEvent.target;\r\n    }\r\n    input.target = target;\r\n}\r\n\r\nfunction computeDeltaXY(session, input) {\r\n    var center = input.center;\r\n    var offset = session.offsetDelta || {};\r\n    var prevDelta = session.prevDelta || {};\r\n    var prevInput = session.prevInput || {};\r\n\r\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\r\n        prevDelta = session.prevDelta = {\r\n            x: prevInput.deltaX || 0,\r\n            y: prevInput.deltaY || 0\r\n        };\r\n\r\n        offset = session.offsetDelta = {\r\n            x: center.x,\r\n            y: center.y\r\n        };\r\n    }\r\n\r\n    input.deltaX = prevDelta.x + (center.x - offset.x);\r\n    input.deltaY = prevDelta.y + (center.y - offset.y);\r\n}\r\n\r\n/**\r\n * velocity is calculated every x ms\r\n * @param {Object} session\r\n * @param {Object} input\r\n */\r\nfunction computeIntervalInputData(session, input) {\r\n    var last = session.lastInterval || input,\r\n        deltaTime = input.timeStamp - last.timeStamp,\r\n        velocity, velocityX, velocityY, direction;\r\n\r\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\r\n        var deltaX = last.deltaX - input.deltaX;\r\n        var deltaY = last.deltaY - input.deltaY;\r\n\r\n        var v = getVelocity(deltaTime, deltaX, deltaY);\r\n        velocityX = v.x;\r\n        velocityY = v.y;\r\n        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\r\n        direction = getDirection(deltaX, deltaY);\r\n\r\n        session.lastInterval = input;\r\n    } else {\r\n        // use latest velocity info if it doesn't overtake a minimum period\r\n        velocity = last.velocity;\r\n        velocityX = last.velocityX;\r\n        velocityY = last.velocityY;\r\n        direction = last.direction;\r\n    }\r\n\r\n    input.velocity = velocity;\r\n    input.velocityX = velocityX;\r\n    input.velocityY = velocityY;\r\n    input.direction = direction;\r\n}\r\n\r\n/**\r\n * create a simple clone from the input used for storage of firstInput and firstMultiple\r\n * @param {Object} input\r\n * @returns {Object} clonedInputData\r\n */\r\nfunction simpleCloneInputData(input) {\r\n    // make a simple copy of the pointers because we will get a reference if we don't\r\n    // we only need clientXY for the calculations\r\n    var pointers = [];\r\n    var i = 0;\r\n    while (i < input.pointers.length) {\r\n        pointers[i] = {\r\n            clientX: round(input.pointers[i].clientX),\r\n            clientY: round(input.pointers[i].clientY)\r\n        };\r\n        i++;\r\n    }\r\n\r\n    return {\r\n        timeStamp: now(),\r\n        pointers: pointers,\r\n        center: getCenter(pointers),\r\n        deltaX: input.deltaX,\r\n        deltaY: input.deltaY\r\n    };\r\n}\r\n\r\n/**\r\n * get the center of all the pointers\r\n * @param {Array} pointers\r\n * @return {Object} center contains `x` and `y` properties\r\n */\r\nfunction getCenter(pointers) {\r\n    var pointersLength = pointers.length;\r\n\r\n    // no need to loop when only one touch\r\n    if (pointersLength === 1) {\r\n        return {\r\n            x: round(pointers[0].clientX),\r\n            y: round(pointers[0].clientY)\r\n        };\r\n    }\r\n\r\n    var x = 0, y = 0, i = 0;\r\n    while (i < pointersLength) {\r\n        x += pointers[i].clientX;\r\n        y += pointers[i].clientY;\r\n        i++;\r\n    }\r\n\r\n    return {\r\n        x: round(x / pointersLength),\r\n        y: round(y / pointersLength)\r\n    };\r\n}\r\n\r\n/**\r\n * calculate the velocity between two points. unit is in px per ms.\r\n * @param {Number} deltaTime\r\n * @param {Number} x\r\n * @param {Number} y\r\n * @return {Object} velocity `x` and `y`\r\n */\r\nfunction getVelocity(deltaTime, x, y) {\r\n    return {\r\n        x: x / deltaTime || 0,\r\n        y: y / deltaTime || 0\r\n    };\r\n}\r\n\r\n/**\r\n * get the direction between two points\r\n * @param {Number} x\r\n * @param {Number} y\r\n * @return {Number} direction\r\n */\r\nfunction getDirection(x, y) {\r\n    if (x === y) {\r\n        return DIRECTION_NONE;\r\n    }\r\n\r\n    if (abs(x) >= abs(y)) {\r\n        return x > 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\r\n    }\r\n    return y > 0 ? DIRECTION_UP : DIRECTION_DOWN;\r\n}\r\n\r\n/**\r\n * calculate the absolute distance between two points\r\n * @param {Object} p1 {x, y}\r\n * @param {Object} p2 {x, y}\r\n * @param {Array} [props] containing x and y keys\r\n * @return {Number} distance\r\n */\r\nfunction getDistance(p1, p2, props) {\r\n    if (!props) {\r\n        props = PROPS_XY;\r\n    }\r\n    var x = p2[props[0]] - p1[props[0]],\r\n        y = p2[props[1]] - p1[props[1]];\r\n\r\n    return Math.sqrt((x * x) + (y * y));\r\n}\r\n\r\n/**\r\n * calculate the angle between two coordinates\r\n * @param {Object} p1\r\n * @param {Object} p2\r\n * @param {Array} [props] containing x and y keys\r\n * @return {Number} angle\r\n */\r\nfunction getAngle(p1, p2, props) {\r\n    if (!props) {\r\n        props = PROPS_XY;\r\n    }\r\n    var x = p2[props[0]] - p1[props[0]],\r\n        y = p2[props[1]] - p1[props[1]];\r\n    return Math.atan2(y, x) * 180 / Math.PI;\r\n}\r\n\r\n/**\r\n * calculate the rotation degrees between two pointersets\r\n * @param {Array} start array of pointers\r\n * @param {Array} end array of pointers\r\n * @return {Number} rotation\r\n */\r\nfunction getRotation(start, end) {\r\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) - getAngle(start[1], start[0], PROPS_CLIENT_XY);\r\n}\r\n\r\n/**\r\n * calculate the scale factor between two pointersets\r\n * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\r\n * @param {Array} start array of pointers\r\n * @param {Array} end array of pointers\r\n * @return {Number} scale\r\n */\r\nfunction getScale(start, end) {\r\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\r\n}\r\n\r\nvar MOUSE_INPUT_MAP = {\r\n    mousedown: INPUT_START,\r\n    mousemove: INPUT_MOVE,\r\n    mouseup: INPUT_END\r\n};\r\n\r\nvar MOUSE_ELEMENT_EVENTS = 'mousedown';\r\nvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\r\n\r\n/**\r\n * Mouse events input\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction MouseInput() {\r\n    this.evEl = MOUSE_ELEMENT_EVENTS;\r\n    this.evWin = MOUSE_WINDOW_EVENTS;\r\n\r\n    this.allow = true; // used by Input.TouchMouse to disable mouse events\r\n    this.pressed = false; // mousedown state\r\n\r\n    Input.apply(this, arguments);\r\n}\r\n\r\ninherit(MouseInput, Input, {\r\n    /**\r\n     * handle mouse events\r\n     * @param {Object} ev\r\n     */\r\n    handler: function MEhandler(ev) {\r\n        var eventType = MOUSE_INPUT_MAP[ev.type];\r\n\r\n        // on start we want to have the left mouse button down\r\n        if (eventType & INPUT_START && ev.button === 0) {\r\n            this.pressed = true;\r\n        }\r\n\r\n        if (eventType & INPUT_MOVE && ev.which !== 1) {\r\n            eventType = INPUT_END;\r\n        }\r\n\r\n        // mouse must be down, and mouse events are allowed (see the TouchMouse input)\r\n        if (!this.pressed || !this.allow) {\r\n            return;\r\n        }\r\n\r\n        if (eventType & INPUT_END) {\r\n            this.pressed = false;\r\n        }\r\n\r\n        this.callback(this.manager, eventType, {\r\n            pointers: [ev],\r\n            changedPointers: [ev],\r\n            pointerType: INPUT_TYPE_MOUSE,\r\n            srcEvent: ev\r\n        });\r\n    }\r\n});\r\n\r\nvar POINTER_INPUT_MAP = {\r\n    pointerdown: INPUT_START,\r\n    pointermove: INPUT_MOVE,\r\n    pointerup: INPUT_END,\r\n    pointercancel: INPUT_CANCEL,\r\n    pointerout: INPUT_CANCEL\r\n};\r\n\r\n// in IE10 the pointer types is defined as an enum\r\nvar IE10_POINTER_TYPE_ENUM = {\r\n    2: INPUT_TYPE_TOUCH,\r\n    3: INPUT_TYPE_PEN,\r\n    4: INPUT_TYPE_MOUSE,\r\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\r\n};\r\n\r\nvar POINTER_ELEMENT_EVENTS = 'pointerdown';\r\nvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\r\n\r\n// IE10 has prefixed support, and case-sensitive\r\nif (window.MSPointerEvent) {\r\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\r\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\r\n}\r\n\r\n/**\r\n * Pointer events input\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction PointerEventInput() {\r\n    this.evEl = POINTER_ELEMENT_EVENTS;\r\n    this.evWin = POINTER_WINDOW_EVENTS;\r\n\r\n    Input.apply(this, arguments);\r\n\r\n    this.store = (this.manager.session.pointerEvents = []);\r\n}\r\n\r\ninherit(PointerEventInput, Input, {\r\n    /**\r\n     * handle mouse events\r\n     * @param {Object} ev\r\n     */\r\n    handler: function PEhandler(ev) {\r\n        var store = this.store;\r\n        var removePointer = false;\r\n\r\n        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\r\n        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\r\n        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\r\n\r\n        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\r\n\r\n        // get index of the event in the store\r\n        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\r\n\r\n        // start and mouse must be down\r\n        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\r\n            if (storeIndex < 0) {\r\n                store.push(ev);\r\n                storeIndex = store.length - 1;\r\n            }\r\n        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\r\n            removePointer = true;\r\n        }\r\n\r\n        // it not found, so the pointer hasn't been down (so it's probably a hover)\r\n        if (storeIndex < 0) {\r\n            return;\r\n        }\r\n\r\n        // update the event in the store\r\n        store[storeIndex] = ev;\r\n\r\n        this.callback(this.manager, eventType, {\r\n            pointers: store,\r\n            changedPointers: [ev],\r\n            pointerType: pointerType,\r\n            srcEvent: ev\r\n        });\r\n\r\n        if (removePointer) {\r\n            // remove from the store\r\n            store.splice(storeIndex, 1);\r\n        }\r\n    }\r\n});\r\n\r\nvar SINGLE_TOUCH_INPUT_MAP = {\r\n    touchstart: INPUT_START,\r\n    touchmove: INPUT_MOVE,\r\n    touchend: INPUT_END,\r\n    touchcancel: INPUT_CANCEL\r\n};\r\n\r\nvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\r\nvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\r\n\r\n/**\r\n * Touch events input\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction SingleTouchInput() {\r\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\r\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\r\n    this.started = false;\r\n\r\n    Input.apply(this, arguments);\r\n}\r\n\r\ninherit(SingleTouchInput, Input, {\r\n    handler: function TEhandler(ev) {\r\n        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\r\n\r\n        // should we handle the touch events?\r\n        if (type === INPUT_START) {\r\n            this.started = true;\r\n        }\r\n\r\n        if (!this.started) {\r\n            return;\r\n        }\r\n\r\n        var touches = normalizeSingleTouches.call(this, ev, type);\r\n\r\n        // when done, reset the started state\r\n        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\r\n            this.started = false;\r\n        }\r\n\r\n        this.callback(this.manager, type, {\r\n            pointers: touches[0],\r\n            changedPointers: touches[1],\r\n            pointerType: INPUT_TYPE_TOUCH,\r\n            srcEvent: ev\r\n        });\r\n    }\r\n});\r\n\r\n/**\r\n * @this {TouchInput}\r\n * @param {Object} ev\r\n * @param {Number} type flag\r\n * @returns {undefined|Array} [all, changed]\r\n */\r\nfunction normalizeSingleTouches(ev, type) {\r\n    var all = toArray(ev.touches);\r\n    var changed = toArray(ev.changedTouches);\r\n\r\n    if (type & (INPUT_END | INPUT_CANCEL)) {\r\n        all = uniqueArray(all.concat(changed), 'identifier', true);\r\n    }\r\n\r\n    return [all, changed];\r\n}\r\n\r\nvar TOUCH_INPUT_MAP = {\r\n    touchstart: INPUT_START,\r\n    touchmove: INPUT_MOVE,\r\n    touchend: INPUT_END,\r\n    touchcancel: INPUT_CANCEL\r\n};\r\n\r\nvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\r\n\r\n/**\r\n * Multi-user touch events input\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction TouchInput() {\r\n    this.evTarget = TOUCH_TARGET_EVENTS;\r\n    this.targetIds = {};\r\n\r\n    Input.apply(this, arguments);\r\n}\r\n\r\ninherit(TouchInput, Input, {\r\n    handler: function MTEhandler(ev) {\r\n        var type = TOUCH_INPUT_MAP[ev.type];\r\n        var touches = getTouches.call(this, ev, type);\r\n        if (!touches) {\r\n            return;\r\n        }\r\n\r\n        this.callback(this.manager, type, {\r\n            pointers: touches[0],\r\n            changedPointers: touches[1],\r\n            pointerType: INPUT_TYPE_TOUCH,\r\n            srcEvent: ev\r\n        });\r\n    }\r\n});\r\n\r\n/**\r\n * @this {TouchInput}\r\n * @param {Object} ev\r\n * @param {Number} type flag\r\n * @returns {undefined|Array} [all, changed]\r\n */\r\nfunction getTouches(ev, type) {\r\n    var allTouches = toArray(ev.touches);\r\n    var targetIds = this.targetIds;\r\n\r\n    // when there is only one touch, the process can be simplified\r\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\r\n        targetIds[allTouches[0].identifier] = true;\r\n        return [allTouches, allTouches];\r\n    }\r\n\r\n    var i,\r\n        targetTouches,\r\n        changedTouches = toArray(ev.changedTouches),\r\n        changedTargetTouches = [],\r\n        target = this.target;\r\n\r\n    // get target touches from touches\r\n    targetTouches = allTouches.filter(function(touch) {\r\n        return hasParent(touch.target, target);\r\n    });\r\n\r\n    // collect touches\r\n    if (type === INPUT_START) {\r\n        i = 0;\r\n        while (i < targetTouches.length) {\r\n            targetIds[targetTouches[i].identifier] = true;\r\n            i++;\r\n        }\r\n    }\r\n\r\n    // filter changed touches to only contain touches that exist in the collected target ids\r\n    i = 0;\r\n    while (i < changedTouches.length) {\r\n        if (targetIds[changedTouches[i].identifier]) {\r\n            changedTargetTouches.push(changedTouches[i]);\r\n        }\r\n\r\n        // cleanup removed touches\r\n        if (type & (INPUT_END | INPUT_CANCEL)) {\r\n            delete targetIds[changedTouches[i].identifier];\r\n        }\r\n        i++;\r\n    }\r\n\r\n    if (!changedTargetTouches.length) {\r\n        return;\r\n    }\r\n\r\n    return [\r\n        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\r\n        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\r\n        changedTargetTouches\r\n    ];\r\n}\r\n\r\n/**\r\n * Combined touch and mouse input\r\n *\r\n * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\r\n * This because touch devices also emit mouse events while doing a touch.\r\n *\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction TouchMouseInput() {\r\n    Input.apply(this, arguments);\r\n\r\n    var handler = bindFn(this.handler, this);\r\n    this.touch = new TouchInput(this.manager, handler);\r\n    this.mouse = new MouseInput(this.manager, handler);\r\n}\r\n\r\ninherit(TouchMouseInput, Input, {\r\n    /**\r\n     * handle mouse and touch events\r\n     * @param {Hammer} manager\r\n     * @param {String} inputEvent\r\n     * @param {Object} inputData\r\n     */\r\n    handler: function TMEhandler(manager, inputEvent, inputData) {\r\n        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\r\n            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\r\n\r\n        // when we're in a touch event, so  block all upcoming mouse events\r\n        // most mobile browser also emit mouseevents, right after touchstart\r\n        if (isTouch) {\r\n            this.mouse.allow = false;\r\n        } else if (isMouse && !this.mouse.allow) {\r\n            return;\r\n        }\r\n\r\n        // reset the allowMouse when we're done\r\n        if (inputEvent & (INPUT_END | INPUT_CANCEL)) {\r\n            this.mouse.allow = true;\r\n        }\r\n\r\n        this.callback(manager, inputEvent, inputData);\r\n    },\r\n\r\n    /**\r\n     * remove the event listeners\r\n     */\r\n    destroy: function destroy() {\r\n        this.touch.destroy();\r\n        this.mouse.destroy();\r\n    }\r\n});\r\n\r\nvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\r\nvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\r\n\r\n// magical touchAction value\r\nvar TOUCH_ACTION_COMPUTE = 'compute';\r\nvar TOUCH_ACTION_AUTO = 'auto';\r\nvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\r\nvar TOUCH_ACTION_NONE = 'none';\r\nvar TOUCH_ACTION_PAN_X = 'pan-x';\r\nvar TOUCH_ACTION_PAN_Y = 'pan-y';\r\n\r\n/**\r\n * Touch Action\r\n * sets the touchAction property or uses the js alternative\r\n * @param {Manager} manager\r\n * @param {String} value\r\n * @constructor\r\n */\r\nfunction TouchAction(manager, value) {\r\n    this.manager = manager;\r\n    this.set(value);\r\n}\r\n\r\nTouchAction.prototype = {\r\n    /**\r\n     * set the touchAction value on the element or enable the polyfill\r\n     * @param {String} value\r\n     */\r\n    set: function(value) {\r\n        // find out the touch-action by the event handlers\r\n        if (value == TOUCH_ACTION_COMPUTE) {\r\n            value = this.compute();\r\n        }\r\n\r\n        if (NATIVE_TOUCH_ACTION) {\r\n            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\r\n        }\r\n        this.actions = value.toLowerCase().trim();\r\n    },\r\n\r\n    /**\r\n     * just re-set the touchAction value\r\n     */\r\n    update: function() {\r\n        this.set(this.manager.options.touchAction);\r\n    },\r\n\r\n    /**\r\n     * compute the value for the touchAction property based on the recognizer's settings\r\n     * @returns {String} value\r\n     */\r\n    compute: function() {\r\n        var actions = [];\r\n        each(this.manager.recognizers, function(recognizer) {\r\n            if (boolOrFn(recognizer.options.enable, [recognizer])) {\r\n                actions = actions.concat(recognizer.getTouchAction());\r\n            }\r\n        });\r\n        return cleanTouchActions(actions.join(' '));\r\n    },\r\n\r\n    /**\r\n     * this method is called on each input cycle and provides the preventing of the browser behavior\r\n     * @param {Object} input\r\n     */\r\n    preventDefaults: function(input) {\r\n        // not needed with native support for the touchAction property\r\n        if (NATIVE_TOUCH_ACTION) {\r\n            return;\r\n        }\r\n\r\n        var srcEvent = input.srcEvent;\r\n        var direction = input.offsetDirection;\r\n\r\n        // if the touch action did prevented once this session\r\n        if (this.manager.session.prevented) {\r\n            srcEvent.preventDefault();\r\n            return;\r\n        }\r\n\r\n        var actions = this.actions;\r\n        var hasNone = inStr(actions, TOUCH_ACTION_NONE);\r\n        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\r\n        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\r\n\r\n        if (hasNone ||\r\n            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\r\n            (hasPanX && direction & DIRECTION_VERTICAL)) {\r\n            return this.preventSrc(srcEvent);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\r\n     * @param {Object} srcEvent\r\n     */\r\n    preventSrc: function(srcEvent) {\r\n        this.manager.session.prevented = true;\r\n        srcEvent.preventDefault();\r\n    }\r\n};\r\n\r\n/**\r\n * when the touchActions are collected they are not a valid value, so we need to clean things up. *\r\n * @param {String} actions\r\n * @returns {*}\r\n */\r\nfunction cleanTouchActions(actions) {\r\n    // none\r\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\r\n        return TOUCH_ACTION_NONE;\r\n    }\r\n\r\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\r\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\r\n\r\n    // pan-x and pan-y can be combined\r\n    if (hasPanX && hasPanY) {\r\n        return TOUCH_ACTION_PAN_X + ' ' + TOUCH_ACTION_PAN_Y;\r\n    }\r\n\r\n    // pan-x OR pan-y\r\n    if (hasPanX || hasPanY) {\r\n        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\r\n    }\r\n\r\n    // manipulation\r\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\r\n        return TOUCH_ACTION_MANIPULATION;\r\n    }\r\n\r\n    return TOUCH_ACTION_AUTO;\r\n}\r\n\r\n/**\r\n * Recognizer flow explained; *\r\n * All recognizers have the initial state of POSSIBLE when a input session starts.\r\n * The definition of a input session is from the first input until the last input, with all it's movement in it. *\r\n * Example session for mouse-input: mousedown -> mousemove -> mouseup\r\n *\r\n * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\r\n * which determines with state it should be.\r\n *\r\n * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\r\n * POSSIBLE to give it another change on the next cycle.\r\n *\r\n *               Possible\r\n *                  |\r\n *            +-----+---------------+\r\n *            |                     |\r\n *      +-----+-----+               |\r\n *      |           |               |\r\n *   Failed      Cancelled          |\r\n *                          +-------+------+\r\n *                          |              |\r\n *                      Recognized       Began\r\n *                                         |\r\n *                                      Changed\r\n *                                         |\r\n *                                  Ended/Recognized\r\n */\r\nvar STATE_POSSIBLE = 1;\r\nvar STATE_BEGAN = 2;\r\nvar STATE_CHANGED = 4;\r\nvar STATE_ENDED = 8;\r\nvar STATE_RECOGNIZED = STATE_ENDED;\r\nvar STATE_CANCELLED = 16;\r\nvar STATE_FAILED = 32;\r\n\r\n/**\r\n * Recognizer\r\n * Every recognizer needs to extend from this class.\r\n * @constructor\r\n * @param {Object} options\r\n */\r\nfunction Recognizer(options) {\r\n    this.id = uniqueId();\r\n\r\n    this.manager = null;\r\n    this.options = merge(options || {}, this.defaults);\r\n\r\n    // default is enable true\r\n    this.options.enable = ifUndefined(this.options.enable, true);\r\n\r\n    this.state = STATE_POSSIBLE;\r\n\r\n    this.simultaneous = {};\r\n    this.requireFail = [];\r\n}\r\n\r\nRecognizer.prototype = {\r\n    /**\r\n     * @virtual\r\n     * @type {Object}\r\n     */\r\n    defaults: {},\r\n\r\n    /**\r\n     * set options\r\n     * @param {Object} options\r\n     * @return {Recognizer}\r\n     */\r\n    set: function(options) {\r\n        extend(this.options, options);\r\n\r\n        // also update the touchAction, in case something changed about the directions/enabled state\r\n        this.manager && this.manager.touchAction.update();\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * recognize simultaneous with an other recognizer.\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Recognizer} this\r\n     */\r\n    recognizeWith: function(otherRecognizer) {\r\n        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\r\n            return this;\r\n        }\r\n\r\n        var simultaneous = this.simultaneous;\r\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\r\n        if (!simultaneous[otherRecognizer.id]) {\r\n            simultaneous[otherRecognizer.id] = otherRecognizer;\r\n            otherRecognizer.recognizeWith(this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Recognizer} this\r\n     */\r\n    dropRecognizeWith: function(otherRecognizer) {\r\n        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\r\n            return this;\r\n        }\r\n\r\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\r\n        delete this.simultaneous[otherRecognizer.id];\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * recognizer can only run when an other is failing\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Recognizer} this\r\n     */\r\n    requireFailure: function(otherRecognizer) {\r\n        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\r\n            return this;\r\n        }\r\n\r\n        var requireFail = this.requireFail;\r\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\r\n        if (inArray(requireFail, otherRecognizer) === -1) {\r\n            requireFail.push(otherRecognizer);\r\n            otherRecognizer.requireFailure(this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Recognizer} this\r\n     */\r\n    dropRequireFailure: function(otherRecognizer) {\r\n        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\r\n            return this;\r\n        }\r\n\r\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\r\n        var index = inArray(this.requireFail, otherRecognizer);\r\n        if (index > -1) {\r\n            this.requireFail.splice(index, 1);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * has require failures boolean\r\n     * @returns {boolean}\r\n     */\r\n    hasRequireFailures: function() {\r\n        return this.requireFail.length > 0;\r\n    },\r\n\r\n    /**\r\n     * if the recognizer can recognize simultaneous with an other recognizer\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Boolean}\r\n     */\r\n    canRecognizeWith: function(otherRecognizer) {\r\n        return !!this.simultaneous[otherRecognizer.id];\r\n    },\r\n\r\n    /**\r\n     * You should use `tryEmit` instead of `emit` directly to check\r\n     * that all the needed recognizers has failed before emitting.\r\n     * @param {Object} input\r\n     */\r\n    emit: function(input) {\r\n        var self = this;\r\n        var state = this.state;\r\n\r\n        function emit(withState) {\r\n            self.manager.emit(self.options.event + (withState ? stateStr(state) : ''), input);\r\n        }\r\n\r\n        // 'panstart' and 'panmove'\r\n        if (state < STATE_ENDED) {\r\n            emit(true);\r\n        }\r\n\r\n        emit(); // simple 'eventName' events\r\n\r\n        // panend and pancancel\r\n        if (state >= STATE_ENDED) {\r\n            emit(true);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check that all the require failure recognizers has failed,\r\n     * if true, it emits a gesture event,\r\n     * otherwise, setup the state to FAILED.\r\n     * @param {Object} input\r\n     */\r\n    tryEmit: function(input) {\r\n        if (this.canEmit()) {\r\n            return this.emit(input);\r\n        }\r\n        // it's failing anyway\r\n        this.state = STATE_FAILED;\r\n    },\r\n\r\n    /**\r\n     * can we emit?\r\n     * @returns {boolean}\r\n     */\r\n    canEmit: function() {\r\n        var i = 0;\r\n        while (i < this.requireFail.length) {\r\n            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\r\n                return false;\r\n            }\r\n            i++;\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * update the recognizer\r\n     * @param {Object} inputData\r\n     */\r\n    recognize: function(inputData) {\r\n        // make a new copy of the inputData\r\n        // so we can change the inputData without messing up the other recognizers\r\n        var inputDataClone = extend({}, inputData);\r\n\r\n        // is is enabled and allow recognizing?\r\n        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\r\n            this.reset();\r\n            this.state = STATE_FAILED;\r\n            return;\r\n        }\r\n\r\n        // reset when we've reached the end\r\n        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\r\n            this.state = STATE_POSSIBLE;\r\n        }\r\n\r\n        this.state = this.process(inputDataClone);\r\n\r\n        // the recognizer has recognized a gesture\r\n        // so trigger an event\r\n        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\r\n            this.tryEmit(inputDataClone);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * return the state of the recognizer\r\n     * the actual recognizing happens in this method\r\n     * @virtual\r\n     * @param {Object} inputData\r\n     * @returns {Const} STATE\r\n     */\r\n    process: function(inputData) { }, // jshint ignore:line\r\n\r\n    /**\r\n     * return the preferred touch-action\r\n     * @virtual\r\n     * @returns {Array}\r\n     */\r\n    getTouchAction: function() { },\r\n\r\n    /**\r\n     * called when the gesture isn't allowed to recognize\r\n     * like when another is being recognized or it is disabled\r\n     * @virtual\r\n     */\r\n    reset: function() { }\r\n};\r\n\r\n/**\r\n * get a usable string, used as event postfix\r\n * @param {Const} state\r\n * @returns {String} state\r\n */\r\nfunction stateStr(state) {\r\n    if (state & STATE_CANCELLED) {\r\n        return 'cancel';\r\n    } else if (state & STATE_ENDED) {\r\n        return 'end';\r\n    } else if (state & STATE_CHANGED) {\r\n        return 'move';\r\n    } else if (state & STATE_BEGAN) {\r\n        return 'start';\r\n    }\r\n    return '';\r\n}\r\n\r\n/**\r\n * direction cons to string\r\n * @param {Const} direction\r\n * @returns {String}\r\n */\r\nfunction directionStr(direction) {\r\n    if (direction == DIRECTION_DOWN) {\r\n        return 'down';\r\n    } else if (direction == DIRECTION_UP) {\r\n        return 'up';\r\n    } else if (direction == DIRECTION_LEFT) {\r\n        return 'left';\r\n    } else if (direction == DIRECTION_RIGHT) {\r\n        return 'right';\r\n    }\r\n    return '';\r\n}\r\n\r\n/**\r\n * get a recognizer by name if it is bound to a manager\r\n * @param {Recognizer|String} otherRecognizer\r\n * @param {Recognizer} recognizer\r\n * @returns {Recognizer}\r\n */\r\nfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\r\n    var manager = recognizer.manager;\r\n    if (manager) {\r\n        return manager.get(otherRecognizer);\r\n    }\r\n    return otherRecognizer;\r\n}\r\n\r\n/**\r\n * This recognizer is just used as a base for the simple attribute recognizers.\r\n * @constructor\r\n * @extends Recognizer\r\n */\r\nfunction AttrRecognizer() {\r\n    Recognizer.apply(this, arguments);\r\n}\r\n\r\ninherit(AttrRecognizer, Recognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof AttrRecognizer\r\n     */\r\n    defaults: {\r\n        /**\r\n         * @type {Number}\r\n         * @default 1\r\n         */\r\n        pointers: 1\r\n    },\r\n\r\n    /**\r\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\r\n     * @memberof AttrRecognizer\r\n     * @param {Object} input\r\n     * @returns {Boolean} recognized\r\n     */\r\n    attrTest: function(input) {\r\n        var optionPointers = this.options.pointers;\r\n        return optionPointers === 0 || input.pointers.length === optionPointers;\r\n    },\r\n\r\n    /**\r\n     * Process the input and return the state for the recognizer\r\n     * @memberof AttrRecognizer\r\n     * @param {Object} input\r\n     * @returns {*} State\r\n     */\r\n    process: function(input) {\r\n        var state = this.state;\r\n        var eventType = input.eventType;\r\n\r\n        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\r\n        var isValid = this.attrTest(input);\r\n\r\n        // on cancel input and we've recognized before, return STATE_CANCELLED\r\n        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\r\n            return state | STATE_CANCELLED;\r\n        } else if (isRecognized || isValid) {\r\n            if (eventType & INPUT_END) {\r\n                return state | STATE_ENDED;\r\n            } else if (!(state & STATE_BEGAN)) {\r\n                return STATE_BEGAN;\r\n            }\r\n            return state | STATE_CHANGED;\r\n        }\r\n        return STATE_FAILED;\r\n    }\r\n});\r\n\r\n/**\r\n * Pan\r\n * Recognized when the pointer is down and moved in the allowed direction.\r\n * @constructor\r\n * @extends AttrRecognizer\r\n */\r\nfunction PanRecognizer() {\r\n    AttrRecognizer.apply(this, arguments);\r\n\r\n    this.pX = null;\r\n    this.pY = null;\r\n}\r\n\r\ninherit(PanRecognizer, AttrRecognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof PanRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'pan',\r\n        threshold: 10,\r\n        pointers: 1,\r\n        direction: DIRECTION_ALL\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        var direction = this.options.direction;\r\n        var actions = [];\r\n        if (direction & DIRECTION_HORIZONTAL) {\r\n            actions.push(TOUCH_ACTION_PAN_Y);\r\n        }\r\n        if (direction & DIRECTION_VERTICAL) {\r\n            actions.push(TOUCH_ACTION_PAN_X);\r\n        }\r\n        return actions;\r\n    },\r\n\r\n    directionTest: function(input) {\r\n        var options = this.options;\r\n        var hasMoved = true;\r\n        var distance = input.distance;\r\n        var direction = input.direction;\r\n        var x = input.deltaX;\r\n        var y = input.deltaY;\r\n\r\n        // lock to axis?\r\n        if (!(direction & options.direction)) {\r\n            if (options.direction & DIRECTION_HORIZONTAL) {\r\n                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\r\n                hasMoved = x != this.pX;\r\n                distance = Math.abs(input.deltaX);\r\n            } else {\r\n                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\r\n                hasMoved = y != this.pY;\r\n                distance = Math.abs(input.deltaY);\r\n            }\r\n        }\r\n        input.direction = direction;\r\n        return hasMoved && distance > options.threshold && direction & options.direction;\r\n    },\r\n\r\n    attrTest: function(input) {\r\n        return AttrRecognizer.prototype.attrTest.call(this, input) &&\r\n            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\r\n    },\r\n\r\n    emit: function(input) {\r\n        this.pX = input.deltaX;\r\n        this.pY = input.deltaY;\r\n\r\n        var direction = directionStr(input.direction);\r\n        if (direction) {\r\n            this.manager.emit(this.options.event + direction, input);\r\n        }\r\n\r\n        this._super.emit.call(this, input);\r\n    }\r\n});\r\n\r\n/**\r\n * Pinch\r\n * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\r\n * @constructor\r\n * @extends AttrRecognizer\r\n */\r\nfunction PinchRecognizer() {\r\n    AttrRecognizer.apply(this, arguments);\r\n}\r\n\r\ninherit(PinchRecognizer, AttrRecognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof PinchRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'pinch',\r\n        threshold: 0,\r\n        pointers: 2\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return [TOUCH_ACTION_NONE];\r\n    },\r\n\r\n    attrTest: function(input) {\r\n        return this._super.attrTest.call(this, input) &&\r\n            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\r\n    },\r\n\r\n    emit: function(input) {\r\n        this._super.emit.call(this, input);\r\n        if (input.scale !== 1) {\r\n            var inOut = input.scale < 1 ? 'in' : 'out';\r\n            this.manager.emit(this.options.event + inOut, input);\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * Press\r\n * Recognized when the pointer is down for x ms without any movement.\r\n * @constructor\r\n * @extends Recognizer\r\n */\r\nfunction PressRecognizer() {\r\n    Recognizer.apply(this, arguments);\r\n\r\n    this._timer = null;\r\n    this._input = null;\r\n}\r\n\r\ninherit(PressRecognizer, Recognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof PressRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'press',\r\n        pointers: 1,\r\n        time: 500, // minimal time of the pointer to be pressed\r\n        threshold: 5 // a minimal movement is ok, but keep it low\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return [TOUCH_ACTION_AUTO];\r\n    },\r\n\r\n    process: function(input) {\r\n        var options = this.options;\r\n        var validPointers = input.pointers.length === options.pointers;\r\n        var validMovement = input.distance < options.threshold;\r\n        var validTime = input.deltaTime > options.time;\r\n\r\n        this._input = input;\r\n\r\n        // we only allow little movement\r\n        // and we've reached an end event, so a tap is possible\r\n        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\r\n            this.reset();\r\n        } else if (input.eventType & INPUT_START) {\r\n            this.reset();\r\n            this._timer = setTimeoutContext(function() {\r\n                this.state = STATE_RECOGNIZED;\r\n                this.tryEmit();\r\n            }, options.time, this);\r\n        } else if (input.eventType & INPUT_END) {\r\n            return STATE_RECOGNIZED;\r\n        }\r\n        return STATE_FAILED;\r\n    },\r\n\r\n    reset: function() {\r\n        clearTimeout(this._timer);\r\n    },\r\n\r\n    emit: function(input) {\r\n        if (this.state !== STATE_RECOGNIZED) {\r\n            return;\r\n        }\r\n\r\n        if (input && (input.eventType & INPUT_END)) {\r\n            this.manager.emit(this.options.event + 'up', input);\r\n        } else {\r\n            this._input.timeStamp = now();\r\n            this.manager.emit(this.options.event, this._input);\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * Rotate\r\n * Recognized when two or more pointer are moving in a circular motion.\r\n * @constructor\r\n * @extends AttrRecognizer\r\n */\r\nfunction RotateRecognizer() {\r\n    AttrRecognizer.apply(this, arguments);\r\n}\r\n\r\ninherit(RotateRecognizer, AttrRecognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof RotateRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'rotate',\r\n        threshold: 0,\r\n        pointers: 2\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return [TOUCH_ACTION_NONE];\r\n    },\r\n\r\n    attrTest: function(input) {\r\n        return this._super.attrTest.call(this, input) &&\r\n            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\r\n    }\r\n});\r\n\r\n/**\r\n * Swipe\r\n * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\r\n * @constructor\r\n * @extends AttrRecognizer\r\n */\r\nfunction SwipeRecognizer() {\r\n    AttrRecognizer.apply(this, arguments);\r\n}\r\n\r\ninherit(SwipeRecognizer, AttrRecognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof SwipeRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'swipe',\r\n        threshold: 10,\r\n        velocity: 0.65,\r\n        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\r\n        pointers: 1\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return PanRecognizer.prototype.getTouchAction.call(this);\r\n    },\r\n\r\n    attrTest: function(input) {\r\n        var direction = this.options.direction;\r\n        var velocity;\r\n\r\n        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\r\n            velocity = input.velocity;\r\n        } else if (direction & DIRECTION_HORIZONTAL) {\r\n            velocity = input.velocityX;\r\n        } else if (direction & DIRECTION_VERTICAL) {\r\n            velocity = input.velocityY;\r\n        }\r\n\r\n        return this._super.attrTest.call(this, input) &&\r\n            direction & input.direction &&\r\n            input.distance > this.options.threshold &&\r\n            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\r\n    },\r\n\r\n    emit: function(input) {\r\n        var direction = directionStr(input.direction);\r\n        if (direction) {\r\n            this.manager.emit(this.options.event + direction, input);\r\n        }\r\n\r\n        this.manager.emit(this.options.event, input);\r\n    }\r\n});\r\n\r\n/**\r\n * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\r\n * between the given interval and position. The delay option can be used to recognize multi-taps without firing\r\n * a single tap.\r\n *\r\n * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\r\n * multi-taps being recognized.\r\n * @constructor\r\n * @extends Recognizer\r\n */\r\nfunction TapRecognizer() {\r\n    Recognizer.apply(this, arguments);\r\n\r\n    // previous time and center,\r\n    // used for tap counting\r\n    this.pTime = false;\r\n    this.pCenter = false;\r\n\r\n    this._timer = null;\r\n    this._input = null;\r\n    this.count = 0;\r\n}\r\n\r\ninherit(TapRecognizer, Recognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof PinchRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'tap',\r\n        pointers: 1,\r\n        taps: 1,\r\n        interval: 300, // max time between the multi-tap taps\r\n        time: 250, // max time of the pointer to be down (like finger on the screen)\r\n        threshold: 2, // a minimal movement is ok, but keep it low\r\n        posThreshold: 10 // a multi-tap can be a bit off the initial position\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return [TOUCH_ACTION_MANIPULATION];\r\n    },\r\n\r\n    process: function(input) {\r\n        var options = this.options;\r\n\r\n        var validPointers = input.pointers.length === options.pointers;\r\n        var validMovement = input.distance < options.threshold;\r\n        var validTouchTime = input.deltaTime < options.time;\r\n\r\n        this.reset();\r\n\r\n        if ((input.eventType & INPUT_START) && (this.count === 0)) {\r\n            return this.failTimeout();\r\n        }\r\n\r\n        // we only allow little movement\r\n        // and we've reached an end event, so a tap is possible\r\n        if (validMovement && validTouchTime && validPointers) {\r\n            if (input.eventType != INPUT_END) {\r\n                return this.failTimeout();\r\n            }\r\n\r\n            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\r\n            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\r\n\r\n            this.pTime = input.timeStamp;\r\n            this.pCenter = input.center;\r\n\r\n            if (!validMultiTap || !validInterval) {\r\n                this.count = 1;\r\n            } else {\r\n                this.count += 1;\r\n            }\r\n\r\n            this._input = input;\r\n\r\n            // if tap count matches we have recognized it,\r\n            // else it has began recognizing...\r\n            var tapCount = this.count % options.taps;\r\n            if (tapCount === 0) {\r\n                // no failing requirements, immediately trigger the tap event\r\n                // or wait as long as the multitap interval to trigger\r\n                if (!this.hasRequireFailures()) {\r\n                    return STATE_RECOGNIZED;\r\n                } else {\r\n                    this._timer = setTimeoutContext(function() {\r\n                        this.state = STATE_RECOGNIZED;\r\n                        this.tryEmit();\r\n                    }, options.interval, this);\r\n                    return STATE_BEGAN;\r\n                }\r\n            }\r\n        }\r\n        return STATE_FAILED;\r\n    },\r\n\r\n    failTimeout: function() {\r\n        this._timer = setTimeoutContext(function() {\r\n            this.state = STATE_FAILED;\r\n        }, this.options.interval, this);\r\n        return STATE_FAILED;\r\n    },\r\n\r\n    reset: function() {\r\n        clearTimeout(this._timer);\r\n    },\r\n\r\n    emit: function() {\r\n        if (this.state == STATE_RECOGNIZED ) {\r\n            this._input.tapCount = this.count;\r\n            this.manager.emit(this.options.event, this._input);\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * Simple way to create an manager with a default set of recognizers.\r\n * @param {HTMLElement} element\r\n * @param {Object} [options]\r\n * @constructor\r\n */\r\nfunction Hammer(element, options) {\r\n    options = options || {};\r\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\r\n    return new Manager(element, options);\r\n}\r\n\r\n/**\r\n * @const {string}\r\n */\r\nHammer.VERSION = '2.0.4';\r\n\r\n/**\r\n * default settings\r\n * @namespace\r\n */\r\nHammer.defaults = {\r\n    /**\r\n     * set if DOM events are being triggered.\r\n     * But this is slower and unused by simple implementations, so disabled by default.\r\n     * @type {Boolean}\r\n     * @default false\r\n     */\r\n    domEvents: false,\r\n\r\n    /**\r\n     * The value for the touchAction property/fallback.\r\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\r\n     * @type {String}\r\n     * @default compute\r\n     */\r\n    touchAction: TOUCH_ACTION_COMPUTE,\r\n\r\n    /**\r\n     * @type {Boolean}\r\n     * @default true\r\n     */\r\n    enable: true,\r\n\r\n    /**\r\n     * EXPERIMENTAL FEATURE -- can be removed/changed\r\n     * Change the parent input target element.\r\n     * If Null, then it is being set the to main element.\r\n     * @type {Null|EventTarget}\r\n     * @default null\r\n     */\r\n    inputTarget: null,\r\n\r\n    /**\r\n     * force an input class\r\n     * @type {Null|Function}\r\n     * @default null\r\n     */\r\n    inputClass: null,\r\n\r\n    /**\r\n     * Default recognizer setup when calling `Hammer()`\r\n     * When creating a new Manager these will be skipped.\r\n     * @type {Array}\r\n     */\r\n    preset: [\r\n        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\r\n        [RotateRecognizer, { enable: false }],\r\n        [PinchRecognizer, { enable: false }, ['rotate']],\r\n        [SwipeRecognizer,{ direction: DIRECTION_HORIZONTAL }],\r\n        [PanRecognizer, { direction: DIRECTION_HORIZONTAL }, ['swipe']],\r\n        [TapRecognizer],\r\n        [TapRecognizer, { event: 'doubletap', taps: 2 }, ['tap']],\r\n        [PressRecognizer]\r\n    ],\r\n\r\n    /**\r\n     * Some CSS properties can be used to improve the working of Hammer.\r\n     * Add them to this method and they will be set when creating a new Manager.\r\n     * @namespace\r\n     */\r\n    cssProps: {\r\n        /**\r\n         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        userSelect: 'none',\r\n\r\n        /**\r\n         * Disable the Windows Phone grippers when pressing an element.\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        touchSelect: 'none',\r\n\r\n        /**\r\n         * Disables the default callout shown when you touch and hold a touch target.\r\n         * On iOS, when you touch and hold a touch target such as a link, Safari displays\r\n         * a callout containing information about the link. This property allows you to disable that callout.\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        touchCallout: 'none',\r\n\r\n        /**\r\n         * Specifies whether zooming is enabled. Used by IE10>\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        contentZooming: 'none',\r\n\r\n        /**\r\n         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        userDrag: 'none',\r\n\r\n        /**\r\n         * Overrides the highlight color shown when the user taps a link or a JavaScript\r\n         * clickable element in iOS. This property obeys the alpha value, if specified.\r\n         * @type {String}\r\n         * @default 'rgba(0,0,0,0)'\r\n         */\r\n        tapHighlightColor: 'rgba(0,0,0,0)'\r\n    }\r\n};\r\n\r\nvar STOP = 1;\r\nvar FORCED_STOP = 2;\r\n\r\n/**\r\n * Manager\r\n * @param {HTMLElement} element\r\n * @param {Object} [options]\r\n * @constructor\r\n */\r\nfunction Manager(element, options) {\r\n    options = options || {};\r\n\r\n    this.options = merge(options, Hammer.defaults);\r\n    this.options.inputTarget = this.options.inputTarget || element;\r\n\r\n    this.handlers = {};\r\n    this.session = {};\r\n    this.recognizers = [];\r\n\r\n    this.element = element;\r\n    this.input = createInputInstance(this);\r\n    this.touchAction = new TouchAction(this, this.options.touchAction);\r\n\r\n    toggleCssProps(this, true);\r\n\r\n    each(options.recognizers, function(item) {\r\n        var recognizer = this.add(new (item[0])(item[1]));\r\n        item[2] && recognizer.recognizeWith(item[2]);\r\n        item[3] && recognizer.requireFailure(item[3]);\r\n    }, this);\r\n}\r\n\r\nManager.prototype = {\r\n    /**\r\n     * set options\r\n     * @param {Object} options\r\n     * @returns {Manager}\r\n     */\r\n    set: function(options) {\r\n        extend(this.options, options);\r\n\r\n        // Options that need a little more setup\r\n        if (options.touchAction) {\r\n            this.touchAction.update();\r\n        }\r\n        if (options.inputTarget) {\r\n            // Clean up existing event listeners and reinitialize\r\n            this.input.destroy();\r\n            this.input.target = options.inputTarget;\r\n            this.input.init();\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * stop recognizing for this session.\r\n     * This session will be discarded, when a new [input]start event is fired.\r\n     * When forced, the recognizer cycle is stopped immediately.\r\n     * @param {Boolean} [force]\r\n     */\r\n    stop: function(force) {\r\n        this.session.stopped = force ? FORCED_STOP : STOP;\r\n    },\r\n\r\n    /**\r\n     * run the recognizers!\r\n     * called by the inputHandler function on every movement of the pointers (touches)\r\n     * it walks through all the recognizers and tries to detect the gesture that is being made\r\n     * @param {Object} inputData\r\n     */\r\n    recognize: function(inputData) {\r\n        var session = this.session;\r\n        if (session.stopped) {\r\n            return;\r\n        }\r\n\r\n        // run the touch-action polyfill\r\n        this.touchAction.preventDefaults(inputData);\r\n\r\n        var recognizer;\r\n        var recognizers = this.recognizers;\r\n\r\n        // this holds the recognizer that is being recognized.\r\n        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\r\n        // if no recognizer is detecting a thing, it is set to `null`\r\n        var curRecognizer = session.curRecognizer;\r\n\r\n        // reset when the last recognizer is recognized\r\n        // or when we're in a new session\r\n        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\r\n            curRecognizer = session.curRecognizer = null;\r\n        }\r\n\r\n        var i = 0;\r\n        while (i < recognizers.length) {\r\n            recognizer = recognizers[i];\r\n\r\n            // find out if we are allowed try to recognize the input for this one.\r\n            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\r\n            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\r\n            //      that is being recognized.\r\n            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\r\n            //      this can be setup with the `recognizeWith()` method on the recognizer.\r\n            if (session.stopped !== FORCED_STOP && ( // 1\r\n                    !curRecognizer || recognizer == curRecognizer || // 2\r\n                    recognizer.canRecognizeWith(curRecognizer))) { // 3\r\n                recognizer.recognize(inputData);\r\n            } else {\r\n                recognizer.reset();\r\n            }\r\n\r\n            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\r\n            // current active recognizer. but only if we don't already have an active recognizer\r\n            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\r\n                curRecognizer = session.curRecognizer = recognizer;\r\n            }\r\n            i++;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * get a recognizer by its event name.\r\n     * @param {Recognizer|String} recognizer\r\n     * @returns {Recognizer|Null}\r\n     */\r\n    get: function(recognizer) {\r\n        if (recognizer instanceof Recognizer) {\r\n            return recognizer;\r\n        }\r\n\r\n        var recognizers = this.recognizers;\r\n        for (var i = 0; i < recognizers.length; i++) {\r\n            if (recognizers[i].options.event == recognizer) {\r\n                return recognizers[i];\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * add a recognizer to the manager\r\n     * existing recognizers with the same event name will be removed\r\n     * @param {Recognizer} recognizer\r\n     * @returns {Recognizer|Manager}\r\n     */\r\n    add: function(recognizer) {\r\n        if (invokeArrayArg(recognizer, 'add', this)) {\r\n            return this;\r\n        }\r\n\r\n        // remove existing\r\n        var existing = this.get(recognizer.options.event);\r\n        if (existing) {\r\n            this.remove(existing);\r\n        }\r\n\r\n        this.recognizers.push(recognizer);\r\n        recognizer.manager = this;\r\n\r\n        this.touchAction.update();\r\n        return recognizer;\r\n    },\r\n\r\n    /**\r\n     * remove a recognizer by name or instance\r\n     * @param {Recognizer|String} recognizer\r\n     * @returns {Manager}\r\n     */\r\n    remove: function(recognizer) {\r\n        if (invokeArrayArg(recognizer, 'remove', this)) {\r\n            return this;\r\n        }\r\n\r\n        var recognizers = this.recognizers;\r\n        recognizer = this.get(recognizer);\r\n        recognizers.splice(inArray(recognizers, recognizer), 1);\r\n\r\n        this.touchAction.update();\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * bind event\r\n     * @param {String} events\r\n     * @param {Function} handler\r\n     * @returns {EventEmitter} this\r\n     */\r\n    on: function(events, handler) {\r\n        var handlers = this.handlers;\r\n        each(splitStr(events), function(event) {\r\n            handlers[event] = handlers[event] || [];\r\n            handlers[event].push(handler);\r\n        });\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * unbind event, leave emit blank to remove all handlers\r\n     * @param {String} events\r\n     * @param {Function} [handler]\r\n     * @returns {EventEmitter} this\r\n     */\r\n    off: function(events, handler) {\r\n        var handlers = this.handlers;\r\n        each(splitStr(events), function(event) {\r\n            if (!handler) {\r\n                delete handlers[event];\r\n            } else {\r\n                handlers[event].splice(inArray(handlers[event], handler), 1);\r\n            }\r\n        });\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * emit event to the listeners\r\n     * @param {String} event\r\n     * @param {Object} data\r\n     */\r\n    emit: function(event, data) {\r\n        // we also want to trigger dom events\r\n        if (this.options.domEvents) {\r\n            triggerDomEvent(event, data);\r\n        }\r\n\r\n        // no handlers, so skip it all\r\n        var handlers = this.handlers[event] && this.handlers[event].slice();\r\n        if (!handlers || !handlers.length) {\r\n            return;\r\n        }\r\n\r\n        data.type = event;\r\n        data.preventDefault = function() {\r\n            data.srcEvent.preventDefault();\r\n        };\r\n\r\n        var i = 0;\r\n        while (i < handlers.length) {\r\n            handlers[i](data);\r\n            i++;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * destroy the manager and unbinds all events\r\n     * it doesn't unbind dom events, that is the user own responsibility\r\n     */\r\n    destroy: function() {\r\n        this.element && toggleCssProps(this, false);\r\n\r\n        this.handlers = {};\r\n        this.session = {};\r\n        this.input.destroy();\r\n        this.element = null;\r\n    }\r\n};\r\n\r\n/**\r\n * add/remove the css properties as defined in manager.options.cssProps\r\n * @param {Manager} manager\r\n * @param {Boolean} add\r\n */\r\nfunction toggleCssProps(manager, add) {\r\n    var element = manager.element;\r\n    each(manager.options.cssProps, function(value, name) {\r\n        element.style[prefixed(element.style, name)] = add ? value : '';\r\n    });\r\n}\r\n\r\n/**\r\n * trigger dom event\r\n * @param {String} event\r\n * @param {Object} data\r\n */\r\nfunction triggerDomEvent(event, data) {\r\n    var gestureEvent = document.createEvent('Event');\r\n    gestureEvent.initEvent(event, true, true);\r\n    gestureEvent.gesture = data;\r\n    data.target.dispatchEvent(gestureEvent);\r\n}\r\n\r\nextend(Hammer, {\r\n    INPUT_START: INPUT_START,\r\n    INPUT_MOVE: INPUT_MOVE,\r\n    INPUT_END: INPUT_END,\r\n    INPUT_CANCEL: INPUT_CANCEL,\r\n\r\n    STATE_POSSIBLE: STATE_POSSIBLE,\r\n    STATE_BEGAN: STATE_BEGAN,\r\n    STATE_CHANGED: STATE_CHANGED,\r\n    STATE_ENDED: STATE_ENDED,\r\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\r\n    STATE_CANCELLED: STATE_CANCELLED,\r\n    STATE_FAILED: STATE_FAILED,\r\n\r\n    DIRECTION_NONE: DIRECTION_NONE,\r\n    DIRECTION_LEFT: DIRECTION_LEFT,\r\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\r\n    DIRECTION_UP: DIRECTION_UP,\r\n    DIRECTION_DOWN: DIRECTION_DOWN,\r\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\r\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\r\n    DIRECTION_ALL: DIRECTION_ALL,\r\n\r\n    Manager: Manager,\r\n    Input: Input,\r\n    TouchAction: TouchAction,\r\n\r\n    TouchInput: TouchInput,\r\n    MouseInput: MouseInput,\r\n    PointerEventInput: PointerEventInput,\r\n    TouchMouseInput: TouchMouseInput,\r\n    SingleTouchInput: SingleTouchInput,\r\n\r\n    Recognizer: Recognizer,\r\n    AttrRecognizer: AttrRecognizer,\r\n    Tap: TapRecognizer,\r\n    Pan: PanRecognizer,\r\n    Swipe: SwipeRecognizer,\r\n    Pinch: PinchRecognizer,\r\n    Rotate: RotateRecognizer,\r\n    Press: PressRecognizer,\r\n\r\n    on: addEventListeners,\r\n    off: removeEventListeners,\r\n    each: each,\r\n    merge: merge,\r\n    extend: extend,\r\n    inherit: inherit,\r\n    bindFn: bindFn,\r\n    prefixed: prefixed\r\n});\r\n\r\nif (typeof define == TYPE_FUNCTION && define.amd) {\r\n    define(function() {\r\n        return Hammer;\r\n    });\r\n} else if (typeof module != 'undefined' && module.exports) {\r\n    module.exports = Hammer;\r\n} else {\r\n    window[exportName] = Hammer;\r\n}\r\n\r\n})(window, document, 'Hammer');\r\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Hammer = require('hammerjs');\n\nvar nextId = 1;\nvar idProperty = 'MarzipanoHammerElementId';\nfunction getKeyForElementAndType(element, type) {\n  if (!element[idProperty]) {\n    element[idProperty] = nextId++;\n  }\n  return type + element[idProperty];\n}\n\n\n/**\n * @class HammerGestures\n * @classdesc\n *\n * Manages Hammer.js instances. One instance is created for each combination of\n * DOM element and pointer type.\n */\nfunction HammerGestures() {\n  this._managers = {};\n  this._refCount = {};\n}\n\n\nHammerGestures.prototype.get = function(element, type) {\n  var key = getKeyForElementAndType(element, type);\n  if (!this._managers[key]) {\n    this._managers[key] = this._createManager(element, type);\n    this._refCount[key] = 0;\n  }\n  this._refCount[key]++;\n  return new HammerGesturesHandle(this, this._managers[key], element, type);\n};\n\n\nHammerGestures.prototype._createManager = function(element, type) {\n  var manager = new Hammer.Manager(element);\n\n  // Managers are created with different parameters for different pointer\n  // types.\n  if (type === 'mouse') {\n    manager.add(new Hammer.Pan({ direction: Hammer.DIRECTION_ALL, threshold: 0 }));\n  }\n  else if (type === 'touch' || type === 'pen' || type === 'kinect') {\n    // On touch one wants to have both panning and pinching. The panning\n    // recognizer needs a threshold to allow the pinch to be recognized.\n    manager.add(new Hammer.Pan({ direction: Hammer.DIRECTION_ALL, threshold: 20, pointers: 1 }));\n    manager.add(new Hammer.Pinch());\n  }\n\n  return manager;\n};\n\n\nHammerGestures.prototype._releaseHandle = function(element, type) {\n  var key = getKeyForElementAndType(element, type);\n  if (this._refCount[key]) {\n    this._refCount[key]--;\n    if (!this._refCount[key]) {\n      this._managers[key].destroy();\n      delete this._managers[key];\n      delete this._refCount[key];\n    }\n  }\n};\n\n\nfunction HammerGesturesHandle(hammerGestures, manager, element, type) {\n  this._manager = manager;\n  this._element = element;\n  this._type = type;\n  this._hammerGestures = hammerGestures;\n  this._eventHandlers = [];\n}\n\n\nHammerGesturesHandle.prototype.on = function(events, handler) {\n  var type = this._type;\n  var handlerFilteredEvents = function(e) {\n    if (type === e.pointerType) {\n      handler(e);\n    }\n  };\n\n  this._eventHandlers.push({ events: events, handler: handlerFilteredEvents });\n  this._manager.on(events, handlerFilteredEvents);\n};\n\n\nHammerGesturesHandle.prototype.release = function() {\n  for (var i = 0; i < this._eventHandlers.length; i++) {\n    var eventHandler = this._eventHandlers[i];\n    this._manager.off(eventHandler.events, eventHandler.handler);\n  }\n\n  this._hammerGestures._releaseHandle(this._element, this._type);\n  this._manager = null;\n  this._element = null;\n  this._type = null;\n  this._hammerGestures = null;\n};\n\n\nHammerGesturesHandle.prototype.manager = function() {\n  return this._manager;\n};\n\n\nmodule.exports = new HammerGestures();\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction maxFriction(friction, velocityX, velocityY, maxFrictionTime, result) {\n  var velocity = Math.sqrt(Math.pow(velocityX,2) + Math.pow(velocityY,2));\n  friction = Math.max(friction, velocity/maxFrictionTime);\n  changeVectorNorm(velocityX, velocityY, friction, result);\n  result[0] = Math.abs(result[0]);\n  result[1] = Math.abs(result[1]);\n}\n\nfunction changeVectorNorm(x, y, n, result) {\n  var theta = Math.atan(y/x);\n  result[0] = n * Math.cos(theta);\n  result[1] = n * Math.sin(theta);\n}\n\nmodule.exports = {\n  maxFriction: maxFriction,\n  changeVectorNorm: changeVectorNorm\n};", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar HammerGestures = require('./HammerGestures');\nvar defaults = require('../util/defaults');\nvar maxFriction = require('./util').maxFriction;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar defaultOptions = {\n  friction: 6,\n  maxFrictionTime: 0.3,\n  hammerEvent: 'pan'\n};\n\nvar debug = typeof MARZIPANODEBUG !== 'undefined' && MARZIPANODEBUG.controls;\n\n/**\n * @class DragControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Controls the view by clicking/tapping and dragging.\n *\n * @param {Element} element Element to listen for events.\n * @param {string} pointerType Which Hammer.js pointer type to use (e.g.\n * `mouse` or `touch`).\n * @param {Object} opts\n * @param {number} opts.friction\n * @param {number} opts.maxFrictionTime\n * @param {'pan'|'pinch'} opts.hammerEvent\n */\nfunction DragControlMethod(element, pointerType, opts) {\n  this._element = element;\n\n  this._opts = defaults(opts || {}, defaultOptions);\n\n  this._startEvent = null;\n  this._lastEvent = null;\n\n  this._active = false;\n\n  this._dynamics = {\n    x: new Dynamics(),\n    y: new Dynamics()\n  };\n\n  this._hammer = HammerGestures.get(element, pointerType);\n\n  this._hammer.on(\"hammer.input\", this._handleHammerEvent.bind(this));\n\n  if (this._opts.hammerEvent != 'pan' && this._opts.hammerEvent != 'pinch') {\n    throw new Error(this._opts.hammerEvent + ' is not a hammerEvent managed in DragControlMethod');\n  }\n\n  this._hammer.on(this._opts.hammerEvent + 'start', this._handleStart.bind(this));\n  this._hammer.on(this._opts.hammerEvent + 'move', this._handleMove.bind(this));\n  this._hammer.on(this._opts.hammerEvent + 'end', this._handleEnd.bind(this));\n  this._hammer.on(this._opts.hammerEvent + 'cancel', this._handleEnd.bind(this));\n}\n\neventEmitter(DragControlMethod);\n\n/**\n * Destructor.\n */\nDragControlMethod.prototype.destroy = function() {\n  this._hammer.release();\n  clearOwnProperties(this);\n};\n\nDragControlMethod.prototype._handleHammerEvent = function(e) {\n  if (e.isFirst) {\n    if (debug && this._active) {\n      throw new Error('DragControlMethod active detected when already active');\n    }\n    this._active = true;\n    this.emit('active');\n  }\n  if (e.isFinal) {\n    if (debug && !this._active) {\n      throw new Error('DragControlMethod inactive detected when already inactive');\n    }\n    this._active = false;\n    this.emit('inactive');\n  }\n};\n\nDragControlMethod.prototype._handleStart = function(e) {\n  // Prevent this event from dragging other DOM elements, causing\n  // unexpected behavior on Chrome.\n  e.preventDefault();\n\n  this._startEvent = e;\n};\n\n\nDragControlMethod.prototype._handleMove = function(e) {\n  // Prevent this event from dragging other DOM elements, causing\n  // unexpected behavior on Chrome.\n  e.preventDefault();\n\n  if (this._startEvent) {\n    this._updateDynamicsMove(e);\n    this.emit('parameterDynamics', 'axisScaledX', this._dynamics.x);\n    this.emit('parameterDynamics', 'axisScaledY', this._dynamics.y);\n  }\n};\n\n\nDragControlMethod.prototype._handleEnd = function(e) {\n  // Prevent this event from dragging other DOM elements, causing\n  // unexpected behavior on Chrome.\n  e.preventDefault();\n\n  if (this._startEvent) {\n    this._updateDynamicsRelease(e);\n    this.emit('parameterDynamics', 'axisScaledX', this._dynamics.x);\n    this.emit('parameterDynamics', 'axisScaledY', this._dynamics.y);\n  }\n\n  this._startEvent = false;\n  this._lastEvent = false;\n};\n\n\nDragControlMethod.prototype._updateDynamicsMove = function(e) {\n  var x = e.deltaX;\n  var y = e.deltaY;\n\n  // When a second finger touches the screen, panstart sometimes has a large\n  // offset at start; subtract that offset to prevent a sudden jump.\n  var eventToSubtract = this._lastEvent || this._startEvent;\n\n  if (eventToSubtract) {\n    x -= eventToSubtract.deltaX;\n    y -= eventToSubtract.deltaY;\n  }\n\n  var elementRect = this._element.getBoundingClientRect();\n  var width = elementRect.right - elementRect.left;\n  var height = elementRect.bottom - elementRect.top;\n\n  x /= width;\n  y /= height;\n\n  this._dynamics.x.reset();\n  this._dynamics.y.reset();\n  this._dynamics.x.offset = -x;\n  this._dynamics.y.offset = -y;\n\n  this._lastEvent = e;\n};\n\n\nvar tmpReleaseFriction = [ null, null ];\nDragControlMethod.prototype._updateDynamicsRelease = function(e) {\n  var elementRect = this._element.getBoundingClientRect();\n  var width = elementRect.right - elementRect.left;\n  var height = elementRect.bottom - elementRect.top;\n\n  var x = 1000 * e.velocityX / width;\n  var y = 1000 * e.velocityY / height;\n\n  this._dynamics.x.reset();\n  this._dynamics.y.reset();\n  this._dynamics.x.velocity = x;\n  this._dynamics.y.velocity = y;\n\n  maxFriction(this._opts.friction, this._dynamics.x.velocity, this._dynamics.y.velocity, this._opts.maxFrictionTime, tmpReleaseFriction);\n  this._dynamics.x.friction = tmpReleaseFriction[0];\n  this._dynamics.y.friction = tmpReleaseFriction[1];\n};\n\n\nmodule.exports = DragControlMethod;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar HammerGestures = require('./HammerGestures');\nvar defaults = require('../util/defaults');\nvar maxFriction = require('./util').maxFriction;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n\nvar defaultOptions = {\n  speed: 8,\n  friction: 6,\n  maxFrictionTime: 0.3\n};\n\n\n/**\n * @class QtvrControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Controls the view by holding the mouse button down and moving it.\n * Also known as \"QTVR\" control mode.\n *\n * @param {Element} element Element to listen for events.\n * @param {string} pointerType Which Hammer.js pointer type to use (e.g.\n * `mouse` or `touch`).\n * @param {Object} opts\n * @param {number} opts.speed\n * @param {number} opts.friction\n * @param {number} opts.maxFrictionTime\n */\n// TODO: allow speed not change linearly with distance to click spot.\n// Quadratic or other would allow a larger speed range.\nfunction QtvrControlMethod(element, pointerType, opts) {\n  this._element = element;\n\n  this._opts = defaults(opts || {}, defaultOptions);\n\n  this._active = false;\n\n  this._hammer = HammerGestures.get(element, pointerType);\n\n  this._dynamics = {\n    x: new Dynamics(),\n    y: new Dynamics()\n  };\n\n  this._hammer.on('panstart', this._handleStart.bind(this));\n  this._hammer.on('panmove', this._handleMove.bind(this));\n  this._hammer.on('panend', this._handleRelease.bind(this));\n  this._hammer.on('pancancel', this._handleRelease.bind(this));\n}\n\neventEmitter(QtvrControlMethod);\n\n/**\n * Destructor.\n */\nQtvrControlMethod.prototype.destroy = function() {\n  this._hammer.release();\n  clearOwnProperties(this);\n};\n\n\nQtvrControlMethod.prototype._handleStart = function(e) {\n  // Prevent event dragging other DOM elements and causing strange behavior on Chrome\n  e.preventDefault();\n\n  if (!this._active) {\n    this._active = true;\n    this.emit('active');\n  }\n};\n\n\nQtvrControlMethod.prototype._handleMove = function(e) {\n  // Prevent event dragging other DOM elements and causing strange behavior on Chrome\n  e.preventDefault();\n\n  this._updateDynamics(e, false);\n};\n\n\nQtvrControlMethod.prototype._handleRelease = function(e) {\n  // Prevent event dragging other DOM elements and causing strange behavior on Chrome\n  e.preventDefault();\n\n  this._updateDynamics(e, true);\n\n  if (this._active) {\n    this._active = false;\n    this.emit('inactive');\n  }\n};\n\n\nvar tmpReleaseFriction = [ null, null ];\nQtvrControlMethod.prototype._updateDynamics = function(e, release) {\n  var elementRect = this._element.getBoundingClientRect();\n  var width = elementRect.right - elementRect.left;\n  var height = elementRect.bottom - elementRect.top;\n  var maxDim = Math.max(width, height);\n\n  var x = e.deltaX / maxDim * this._opts.speed;\n  var y = e.deltaY / maxDim * this._opts.speed;\n\n  this._dynamics.x.reset();\n  this._dynamics.y.reset();\n  this._dynamics.x.velocity = x;\n  this._dynamics.y.velocity = y;\n\n  if (release) {\n    maxFriction(this._opts.friction, this._dynamics.x.velocity, this._dynamics.y.velocity, this._opts.maxFrictionTime, tmpReleaseFriction);\n    this._dynamics.x.friction = tmpReleaseFriction[0];\n    this._dynamics.y.friction = tmpReleaseFriction[1];\n  }\n\n  this.emit('parameterDynamics', 'x', this._dynamics.x);\n  this.emit('parameterDynamics', 'y', this._dynamics.y);\n};\n\n\nmodule.exports = QtvrControlMethod;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar defaults = require('../util/defaults');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar defaultOptions = {\n  frictionTime: 0.2,\n  zoomDelta: 0.001\n};\n\n/**\n * @class ScrollZoomControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Controls the fov/zoom through the mouse wheel.\n *\n * @param {Element} element Element to listen for events.\n * @param {Object} opts\n * @param {number} [opts.frictionTime=0.2]\n * @param {number} [opts.zoomDelta=0.001]\n */\nfunction ScrollZoomControlMethod(element, opts) {\n  this._element = element;\n  this._opts = defaults(opts || {}, defaultOptions);\n  this._dynamics = new Dynamics();\n  this._eventList = [];\n\n  var fn = this._opts.frictionTime ? this.withSmoothing : this.withoutSmoothing;\n  this._wheelListener = fn.bind(this);\n  \n  element.addEventListener('wheel', this._wheelListener);\n}\n\neventEmitter(ScrollZoomControlMethod);\n\n/**\n * Destructor.\n */\nScrollZoomControlMethod.prototype.destroy = function() {\n  this._element.removeEventListener('wheel', this._wheelListener);\n  clearOwnProperties(this);\n};\n\n\nScrollZoomControlMethod.prototype.withoutSmoothing = function(e) {\n  this._dynamics.offset = wheelEventDelta(e) * this._opts.zoomDelta;\n  this.emit('parameterDynamics', 'zoom', this._dynamics);\n\n  e.preventDefault();\n\n  this.emit('active');\n  this.emit('inactive');\n};\n\n\nScrollZoomControlMethod.prototype.withSmoothing = function(e) {\n  var currentTime = e.timeStamp;\n\n  // Record event.\n  this._eventList.push(e);\n\n  // Remove events whose smoothing has already expired.\n  while (this._eventList[0].timeStamp < currentTime - this._opts.frictionTime*1000) {\n    this._eventList.shift(0);\n  }\n\n  // Get the current velocity from the recorded events.\n  // Each wheel movement causes a velocity of change/frictionTime during frictionTime.\n  var velocity = 0;\n  for (var i = 0; i < this._eventList.length; i++) {\n    var zoomChangeFromEvent = wheelEventDelta(this._eventList[i]) * this._opts.zoomDelta;\n    velocity += zoomChangeFromEvent / this._opts.frictionTime;\n  }\n\n  this._dynamics.velocity = velocity;\n  this._dynamics.friction = Math.abs(velocity) / this._opts.frictionTime;\n\n  this.emit('parameterDynamics', 'zoom', this._dynamics);\n\n  e.preventDefault();\n\n  this.emit('active');\n  this.emit('inactive');\n};\n\n\nfunction wheelEventDelta(e) {\n  var multiplier = e.deltaMode == 1 ? 20 : 1;\n  return e.deltaY * multiplier;\n}\n\n\nmodule.exports = ScrollZoomControlMethod;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar HammerGestures = require('./HammerGestures');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class PinchZoomControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Control the view fov/zoom by pinching with two fingers.\n *\n * @param {Element} element Element to listen for events.\n * @param {string} pointerType Which Hammer.js pointer type to use\n * @param {Object} opts\n */\nfunction PinchZoomControlMethod(element, pointerType, opts) {\n  this._hammer = HammerGestures.get(element, pointerType);\n\n  this._lastEvent = null;\n\n  this._active = false;\n\n  this._dynamics = new Dynamics();\n\n  this._hammer.on('pinchstart', this._handleStart.bind(this));\n  this._hammer.on('pinch', this._handleEvent.bind(this));\n  this._hammer.on('pinchend', this._handleEnd.bind(this));\n  this._hammer.on('pinchcancel', this._handleEnd.bind(this));\n}\n\neventEmitter(PinchZoomControlMethod);\n\n/**\n * Destructor.\n */\nPinchZoomControlMethod.prototype.destroy = function() {\n  this._hammer.release();\n  clearOwnProperties(this);\n};\n\n\nPinchZoomControlMethod.prototype._handleStart = function() {\n  if (!this._active) {\n    this._active = true;\n    this.emit('active');\n  }\n};\n\n\nPinchZoomControlMethod.prototype._handleEnd = function() {\n  this._lastEvent = null;\n\n  if (this._active) {\n    this._active = false;\n    this.emit('inactive');\n  }\n};\n\n\nPinchZoomControlMethod.prototype._handleEvent = function(e) {\n  var scale = e.scale;\n\n  if (this._lastEvent) {\n    scale /= this._lastEvent.scale;\n  }\n\n  this._dynamics.offset = (scale - 1) * -1;\n  this.emit('parameterDynamics', 'zoom', this._dynamics);\n\n  this._lastEvent = e;\n};\n\n\nmodule.exports = PinchZoomControlMethod;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class VelocityControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Sets the velocity and friction of a single parameter.\n *\n * The user should emit 'active' and 'inactive' events if required.\n *\n * @param {String} parameter The parameter to be controlled (e.g. `x`, `y` or `zoom`)\n*/\nfunction VelocityControlMethod(parameter) {\n  if(!parameter) {\n    throw new Error(\"VelocityControlMethod: parameter must be defined\");\n  }\n\n  this._parameter = parameter;\n  this._dynamics = new Dynamics();\n}\neventEmitter(VelocityControlMethod);\n\n/**\n * Destructor.\n */\nVelocityControlMethod.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\n/**\n * Set the parameter's velocity.\n * @param {Number} velocity\n */\nVelocityControlMethod.prototype.setVelocity = function(velocity) {\n  this._dynamics.velocity = velocity;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n};\n\n/**\n * Set the parameter's friction.\n * @param {Number} friction\n */\nVelocityControlMethod.prototype.setFriction = function(friction) {\n  this._dynamics.friction = friction;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n};\n\nmodule.exports = VelocityControlMethod;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class ElementPressControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Sets the velocity and friction of a single parameter by pressing and\n * unpressing a DOM element.\n *\n * @param {Element} element Element which activates the method when pressed\n * @param {string} parameter The parameter to be controlled (e.g. `x`, `y` or `zoom`)\n * @param {number} velocity Velocity at which the parameter changes. Use a\n * negative number for opposite direction\n * @param {number} friction Friction at which the parameter stops\n*/\nfunction ElementPressControlMethod(element, parameter, velocity, friction) {\n  if(!element) {\n    throw new Error(\"ElementPressControlMethod: element must be defined\");\n  }\n  if(!parameter) {\n    throw new Error(\"ElementPressControlMethod: parameter must be defined\");\n  }\n  if(!velocity) {\n    throw new Error(\"ElementPressControlMethod: velocity must be defined\");\n  }\n  if(!friction) {\n    throw new Error(\"ElementPressControlMethod: friction must be defined\");\n  }\n\n  this._element = element;\n\n  this._pressHandler = this._handlePress.bind(this);\n  this._releaseHandler = this._handleRelease.bind(this);\n\n  element.addEventListener('mousedown', this._pressHandler);\n  element.addEventListener('mouseup', this._releaseHandler);\n  element.addEventListener('mouseleave', this._releaseHandler);\n  element.addEventListener('touchstart', this._pressHandler);\n  element.addEventListener('touchmove', this._releaseHandler);\n  element.addEventListener('touchend', this._releaseHandler);\n\n  this._parameter = parameter;\n  this._velocity = velocity;\n  this._friction = friction;\n  this._dynamics = new Dynamics();\n\n  this._pressing = false;\n}\neventEmitter(ElementPressControlMethod);\n\n/**\n * Destructor.\n */\nElementPressControlMethod.prototype.destroy = function() {\n  this._element.removeEventListener('mousedown', this._pressHandler);\n  this._element.removeEventListener('mouseup', this._releaseHandler);\n  this._element.removeEventListener('mouseleave', this._releaseHandler);\n  this._element.removeEventListener('touchstart', this._pressHandler);\n  this._element.removeEventListener('touchmove', this._releaseHandler);\n  this._element.removeEventListener('touchend', this._releaseHandler);\n  clearOwnProperties(this);\n};\n\nElementPressControlMethod.prototype._handlePress = function() {\n  this._pressing = true;\n\n  this._dynamics.velocity = this._velocity;\n  this._dynamics.friction = 0;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n  this.emit('active');\n};\n\nElementPressControlMethod.prototype._handleRelease = function() {\n  if(this._pressing) {\n    this._dynamics.friction = this._friction;\n    this.emit('parameterDynamics', this._parameter, this._dynamics);\n    this.emit('inactive');\n  }\n\n  this._pressing = false;\n};\n\nmodule.exports = ElementPressControlMethod;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar now = require('../util/now');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class ControlComposer\n * @classdesc\n *\n * Combines changes in parameters triggered by multiple {@link ControlMethod}\n * instances.\n *\n * @listens ControlMethod#parameterDynamics\n */\nfunction ControlComposer(opts) {\n  opts = opts || {};\n\n  this._methods = [];\n\n  this._parameters = [ 'x' ,'y', 'axisScaledX', 'axisScaledY', 'zoom', 'yaw', 'pitch', 'roll' ];\n\n  this._now = opts.nowForTesting || now;\n\n  this._composedOffsets = { };\n\n  this._composeReturn = { offsets: this._composedOffsets, changing: null };\n}\n\neventEmitter(ControlComposer);\n\n\nControlComposer.prototype.add = function(instance) {\n  if (this.has(instance)) {\n    return;\n  }\n\n  var dynamics = {};\n  this._parameters.forEach(function(parameter) {\n    dynamics[parameter] = {\n      dynamics: new Dynamics(),\n      time: null\n    };\n  });\n\n  var parameterDynamicsHandler = this._updateDynamics.bind(this, dynamics);\n\n  var method = {\n    instance: instance,\n    dynamics: dynamics,\n    parameterDynamicsHandler: parameterDynamicsHandler\n  };\n\n  instance.addEventListener('parameterDynamics', parameterDynamicsHandler);\n\n  this._methods.push(method);\n};\n\n\nControlComposer.prototype.remove = function(instance) {\n  var index = this._indexOfInstance(instance);\n  if (index >= 0) {\n    var method = this._methods.splice(index, 1)[0];\n    method.instance.removeEventListener('parameterDynamics', method.parameterDynamicsHandler);\n  }\n};\n\n\nControlComposer.prototype.has = function(instance) {\n  return this._indexOfInstance(instance) >= 0;\n};\n\n\nControlComposer.prototype._indexOfInstance = function(instance) {\n  for (var i = 0; i < this._methods.length; i++) {\n    if (this._methods[i].instance === instance) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\nControlComposer.prototype.list = function() {\n  var instances = [];\n  for (var i = 0; i < this._methods.length; i++) {\n    instances.push(this._methods[i].instance);\n  }\n  return instances;\n};\n\n\nControlComposer.prototype._updateDynamics = function(storedDynamics, parameter, dynamics) {\n  var parameterDynamics = storedDynamics[parameter];\n\n  if (!parameterDynamics) {\n    throw new Error(\"Unknown control parameter \" + parameter);\n  }\n\n  var newTime = this._now();\n  parameterDynamics.dynamics.update(dynamics, (newTime - parameterDynamics.time)/1000);\n  parameterDynamics.time = newTime;\n\n  this.emit('change');\n};\n\n\nControlComposer.prototype._resetComposedOffsets = function() {\n  for (var i = 0; i < this._parameters.length; i++) {\n    this._composedOffsets[this._parameters[i]] = 0;\n  }\n};\n\n\nControlComposer.prototype.offsets = function() {\n  var parameter;\n  var changing = false;\n\n  var currentTime = this._now();\n\n  this._resetComposedOffsets();\n\n  for (var i = 0; i < this._methods.length; i++) {\n    var methodDynamics = this._methods[i].dynamics;\n\n    for (var p = 0; p < this._parameters.length; p++) {\n      parameter = this._parameters[p];\n      var parameterDynamics = methodDynamics[parameter];\n      var dynamics = parameterDynamics.dynamics;\n\n\n      // Add offset to composed offset\n      if (dynamics.offset != null) {\n        this._composedOffsets[parameter] += dynamics.offset;\n        // Reset offset\n        dynamics.offset = null;\n      }\n\n      // Calculate offset from velocity and add it\n      var elapsed = (currentTime - parameterDynamics.time)/1000;\n      var offsetFromVelocity = dynamics.offsetFromVelocity(elapsed);\n\n      if(offsetFromVelocity) {\n        this._composedOffsets[parameter] += offsetFromVelocity;\n      }\n\n      // Update velocity on dynamics\n      var currentVelocity = dynamics.velocityAfter(elapsed);\n      dynamics.velocity = currentVelocity;\n\n      // If there is still a velocity, set changing\n      if(currentVelocity) {\n        changing = true;\n      }\n\n      parameterDynamics.time = currentTime;\n    }\n  }\n\n  this._composeReturn.changing = changing;\n  return this._composeReturn;\n};\n\n\nControlComposer.prototype.destroy = function() {\n  var instances = this.list();\n  for (var i = 0; i < instances.length; i++) {\n    this.remove(instances[i]);\n  }\n\n  clearOwnProperties(this);\n};\n\n\nmodule.exports = ControlComposer;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Composer = require('./Composer');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar debug = typeof MARZIPANODEBUG !== 'undefined' && MARZIPANODEBUG.controls;\n\n/**\n * @class Controls\n * @classdesc\n *\n * Set of controls which affect a view (e.g. keyboard, touch)\n *\n * {@link ControlMethod} instances can be registered on this class. The methods\n * are then combined to calculate the final parameters to change the {@link View}.\n *\n * Controls is attached to a {@link RenderLoop}. Currently it affects the\n * {@link view} of all {@link Layer} on the {@link Stage} of the\n * {@link RenderLoop} it is attached to. A more flexible API may be provided\n * in the future.\n *\n * The ControlMethod instances are registered with an id and may be enabled,\n * disabled and unregistered using that id. The whole Control can also be\n * enabled or disabled.\n *\n */\nfunction Controls(opts) {\n  opts = opts || {};\n\n  this._methods = {};\n  this._methodGroups = {};\n  this._composer = new Composer();\n\n  // Whether the controls are enabled.\n  this._enabled = (opts && opts.enabled) ? !!opts.enabled : true;\n\n  // How many control methods are enabled and in the active state.\n  this._activeCount = 0;\n\n  this.updatedViews_ = [];\n\n  this._attachedRenderLoop = null;\n}\n\neventEmitter(Controls);\n\n/**\n * Destructor.\n */\nControls.prototype.destroy = function() {\n  this.detach();\n  this._composer.destroy();\n  clearOwnProperties(this);\n};\n\n\n/**\n * @return {ControlMethod[]} List of registered @{link ControlMethod instances}\n */\nControls.prototype.methods = function() {\n  var obj = {};\n  for (var id in this._methods) {\n    obj[id] = this._methods[id];\n  }\n  return obj;\n};\n\n/**\n * @param {String} id\n * @return {ControlMethod}\n */\nControls.prototype.method = function(id) {\n  return this._methods[id];\n};\n\n/**\n * @param {String} id\n * @param {ControlMethod} instance\n * @param {Boolean} [enable=false]\n */\nControls.prototype.registerMethod = function(id, instance, enable) {\n  if (this._methods[id]) {\n    throw new Error('Control method already registered with id ' + id);\n  }\n\n  this._methods[id] = {\n    instance: instance,\n    enabled: false,\n    active: false,\n    activeHandler: this._handleActive.bind(this, id),\n    inactiveHandler: this._handleInactive.bind(this, id)\n  };\n\n  if(enable) {\n    this.enableMethod(id, instance);\n  }\n};\n\n\n/**\n * @param {String} id\n */\nControls.prototype.unregisterMethod = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('No control method registered with id ' + id);\n  }\n  if (method.enabled) {\n    this.disableMethod(id);\n  }\n  delete this._methods[id];\n};\n\n/**\n * @param {String} id\n */\nControls.prototype.enableMethod = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('No control method registered with id ' + id);\n  }\n  if (method.enabled) {\n    return;\n  }\n  method.enabled = true;\n  if (method.active) {\n    this._incrementActiveCount();\n  }\n  this._listen(id);\n  this._updateComposer();\n  this.emit('methodEnabled', id);\n};\n\n\n/**\n * @param {String} id\n */\nControls.prototype.disableMethod = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('No control method registered with id ' + id);\n  }\n  if (!method.enabled) {\n    return;\n  }\n  method.enabled = false;\n  if (method.active) {\n    this._decrementActiveCount();\n  }\n  this._unlisten(id);\n  this._updateComposer();\n  this.emit('methodDisabled', id);\n};\n\n\n/**\n * Create a method group, which can be used to more conveniently enable or\n * disable several control methods at once\n * @param {String} groupId\n * @param {String[]} methodIds\n */\nControls.prototype.addMethodGroup = function(groupId, methodIds) {\n  this._methodGroups[groupId] = methodIds;\n}\n\n/**\n * @param {String} groupId\n */\nControls.prototype.removeMethodGroup = function(id) {\n  delete this._methodGroups[id];\n}\n\n/**\n * @return {ControlMethodGroup[]} List of control method groups\n */\nControls.prototype.methodGroups = function() {\n  var obj = {};\n  for (var id in this._methodGroups) {\n    obj[id] = this._methodGroups[id];\n  }\n  return obj;\n}\n\n/**\n * Enables all the control methods in the group\n * @param {String} groupId\n */\nControls.prototype.enableMethodGroup = function(id) {\n  var self = this;\n  self._methodGroups[id].forEach(function(methodId) {\n    self.enableMethod(methodId);\n  });\n}\n\n/**\n * Disables all the control methods in the group\n * @param {String} groupId\n */\nControls.prototype.disableMethodGroup = function(id) {\n  var self = this;\n  self._methodGroups[id].forEach(function(methodId) {\n    self.disableMethod(methodId);\n  });\n}\n\n/**\n * @returns {Boolean}\n */\nControls.prototype.enabled = function() {\n  return this._enabled;\n};\n\n/**\n * Enables the controls\n */\nControls.prototype.enable = function() {\n  if (this._enabled) {\n    return;\n  }\n  this._enabled = true;\n  if (this._activeCount > 0) {\n    this.emit('active');\n  }\n  this.emit('enabled');\n  this._updateComposer();\n};\n\n\n/**\n * Disables the controls\n */\nControls.prototype.disable = function() {\n  if (!this._enabled) {\n    return;\n  }\n  this._enabled = false;\n  if (this._activeCount > 0) {\n    this.emit('inactive');\n  }\n  this.emit('disabled');\n  this._updateComposer();\n};\n\n\n\n/**\n * Attaches the controls to a {@link RenderLoop}. The RenderLoop will be woken\n * up when the controls are activated\n *\n * @param {RenderLoop}\n */\nControls.prototype.attach = function(renderLoop) {\n  if (this._attachedRenderLoop) {\n    this.detach();\n  }\n\n  this._attachedRenderLoop = renderLoop;\n  this._beforeRenderHandler = this._updateViewsWithControls.bind(this);\n  this._changeHandler = renderLoop.renderOnNextFrame.bind(renderLoop);\n\n  this._attachedRenderLoop.addEventListener('beforeRender', this._beforeRenderHandler);\n  this._composer.addEventListener('change', this._changeHandler);\n};\n\n/**\n * Detaches the controls\n */\nControls.prototype.detach = function() {\n  if (!this._attachedRenderLoop) {\n    return;\n  }\n\n  this._attachedRenderLoop.removeEventListener('beforeRender', this._beforeRenderHandler);\n  this._composer.removeEventListener('change', this._changeHandler);\n\n  this._beforeRenderHandler = null;\n  this._changeHandler = null;\n  this._attachedRenderLoop = null;\n};\n\n/**\n * @param {Boolean}\n */\nControls.prototype.attached = function() {\n  return this._attachedRenderLoop != null;\n};\n\n\nControls.prototype._listen = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('Bad method id');\n  }\n  method.instance.addEventListener('active', method.activeHandler);\n  method.instance.addEventListener('inactive', method.inactiveHandler);\n};\n\n\nControls.prototype._unlisten = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('Bad method id');\n  }\n  method.instance.removeEventListener('active', method.activeHandler);\n  method.instance.removeEventListener('inactive', method.inactiveHandler);\n};\n\n\nControls.prototype._handleActive = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('Bad method id');\n  }\n  if (!method.enabled) {\n    throw new Error('Should not receive event from disabled control method');\n  }\n  if (!method.active) {\n    method.active = true;\n    this._incrementActiveCount();\n  }\n};\n\n\nControls.prototype._handleInactive = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('Bad method id');\n  }\n  if (!method.enabled) {\n    throw new Error('Should not receive event from disabled control method');\n  }\n  if (method.active) {\n    method.active = false;\n    this._decrementActiveCount();\n  }\n};\n\n\nControls.prototype._incrementActiveCount = function() {\n  this._activeCount++;\n  if (debug) {\n    this._checkActiveCount();\n  }\n  if (this._enabled && this._activeCount === 1) {\n    this.emit('active');\n  }\n};\n\n\nControls.prototype._decrementActiveCount = function() {\n  this._activeCount--;\n  if (debug) {\n    this._checkActiveCount();\n  }\n  if (this._enabled && this._activeCount === 0) {\n    this.emit('inactive');\n  }\n};\n\n\nControls.prototype._checkActiveCount = function() {\n  var count = 0;\n  for (var id in this._methods) {\n    var method = this._methods[id];\n    if (method.enabled && method.active) {\n      count++;\n    }\n  }\n  if (count != this._activeCount) {\n    throw new Error('Bad control state');\n  }\n};\n\n\nControls.prototype._updateComposer = function() {\n  var composer = this._composer;\n\n  for (var id in this._methods) {\n    var method = this._methods[id];\n    var enabled = this._enabled && method.enabled;\n\n    if (enabled && !composer.has(method.instance)) {\n      composer.add(method.instance);\n    }\n    if (!enabled && composer.has(method.instance)) {\n      composer.remove(method.instance);\n    }\n  }\n};\n\n\nControls.prototype._updateViewsWithControls = function() {\n  var controlData = this._composer.offsets();\n  if (controlData.changing) {\n    this._attachedRenderLoop.renderOnNextFrame();\n  }\n\n  // Update each view at most once, even when shared by multiple layers.\n  // The number of views is expected to be small, so use an array to keep track.\n  this.updatedViews_.length = 0;\n\n  var layers = this._attachedRenderLoop.stage().listLayers();\n  for (var i = 0; i < layers.length; i++) {\n    var view = layers[i].view();\n    if (this.updatedViews_.indexOf(view) < 0) {\n      layers[i].view().updateWithControlParameters(controlData.offsets);\n      this.updatedViews_.push(view);\n    }\n  }\n};\n\n\nmodule.exports = Controls;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar setTransform = require('./dom').setTransform;\nvar decimal = require('./decimal');\n\nfunction positionAbsolutely(element, x, y, extraTransforms) {\n  extraTransforms = extraTransforms || '';\n  // A translateZ(0) transform improves performance on Chrome by creating a\n  // new layer for the element, which prevents unnecessary repaints.\n  var transform = 'translateX(' + decimal(x) + 'px) translateY(' + decimal(y) + 'px) translateZ(0) ' + extraTransforms;\n  setTransform(element, transform);\n}\n\nmodule.exports = positionAbsolutely;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar positionAbsolutely = require('./util/positionAbsolutely');\nvar setTransform = require('./util/dom').setTransform;\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * @class Hotspot\n * @classdesc\n *\n * A Hotspot allows a DOM element to be placed at a fixed position in the\n * image. The position is updated automatically when the {@link View view}\n * changes.\n *\n * Positioning is performed with the `transform` CSS property when available,\n * falling back to the `position`, `left` and `top` properties when not.\n * In both cases, the top left corner of the element is placed in the requested\n * position; clients are expected to use additional children elements or other\n * CSS properties to achieve more sophisticated layouts.\n *\n * There are two kinds of hotspots: regular and embedded. A regular hotspot\n * does not change size depending on the zoom level. An embedded hotspot is\n * displayed at a fixed size relative to the panorama, always covering the\n * same portion of the image.\n *\n * Clients should call {@link HotspotContainer#createHotspot} instead of\n * invoking the constructor directly.\n *\n * @param {Element} domElement The DOM element.\n * @param {View} view The view.\n * @param {Object} coords The hotspot coordinates.\n *     Use {@link RectilinearViewCoords} for a {@link RectilinearView} or\n *     {@link FlatViewCoords} for a {@link FlatView}.\n * @param {Object} opts Additional options.\n * @param {Object} opts.perspective Perspective options for embedded hotspots.\n * @param {number} [opts.perspective.radius=null] If set, embed the hotspot\n *     into the image by transforming it into the surface of a sphere with this\n *     radius.\n * @param {string} [opts.perspective.extraTransforms=null] If set, append this\n *     value to the CSS `transform` property used to position the hotspot. This\n *     may be used to rotate an embedded hotspot.\n */\nfunction Hotspot(domElement, parentDomElement, view, coords, opts) {\n\n  opts = opts || {};\n  opts.perspective = opts.perspective || {};\n  opts.perspective.extraTransforms =\n      opts.perspective.extraTransforms != null ? opts.perspective.extraTransforms : \"\";\n\n  this._domElement = domElement;\n  this._parentDomElement = parentDomElement;\n  this._view = view;\n  this._coords = {};\n  this._perspective = {};\n\n  this.setPosition(coords);\n\n  // Add hotspot into the DOM.\n  this._parentDomElement.appendChild(this._domElement);\n\n  this.setPerspective(opts.perspective);\n\n  // Whether the hotspot is visible.\n  // The hotspot may still be hidden if it's inside a hidden HotspotContainer.\n  this._visible = true;\n\n  // The current calculated screen position.\n  this._position = { x: 0, y: 0 };\n}\n\neventEmitter(Hotspot);\n\n\n/**\n * Destructor.\n * Clients should call {@link HotspotContainer#destroyHotspot} instead.\n */\nHotspot.prototype.destroy = function() {\n  this._parentDomElement.removeChild(this._domElement);\n  clearOwnProperties(this);\n};\n\n\n/**\n * @return {Element}\n */\nHotspot.prototype.domElement = function() {\n  return this._domElement;\n};\n\n\n/**\n * @return {Object}\n */\nHotspot.prototype.position = function() {\n  return this._coords;\n};\n\n\n/**\n * @param {Object} coords\n */\nHotspot.prototype.setPosition = function(coords) {\n  for (var key in coords) {\n    this._coords[key] = coords[key];\n  }\n  this._update();\n  // TODO: We should probably emit a hotspotsChange event on the parent\n  // HotspotContainer. What's the best way to do so?\n};\n\n\n/**\n * @return {Object}\n */\nHotspot.prototype.perspective = function() {\n  return this._perspective;\n};\n\n\n/**\n * @param {Object}\n */\nHotspot.prototype.setPerspective = function(perspective) {\n  for (var key in perspective) {\n    this._perspective[key] = perspective[key];\n  }\n  this._update();\n};\n\n\n/**\n * Show the hotspot\n */\nHotspot.prototype.show = function() {\n  if (!this._visible) {\n    this._visible = true;\n    this._update();\n  }\n};\n\n\n/**\n * Hide the hotspot\n */\nHotspot.prototype.hide = function() {\n  if (this._visible) {\n    this._visible = false;\n    this._update();\n  }\n};\n\n\nHotspot.prototype._update = function() {\n  var element = this._domElement;\n\n  var params = this._coords;\n  var position = this._position;\n  var x, y;\n\n  var isVisible = false;\n\n  if (this._visible) {\n    var view = this._view;\n\n    if (this._perspective.radius) {\n      // Hotspots that are embedded in the panorama may be visible even when\n      // positioned behind the camera.\n      isVisible = true;\n      this._setEmbeddedPosition(view, params);\n    } else {\n      // Regular hotspots are only visible when positioned in front of the\n      // camera. Note that they may be partially visible when positioned outside\n      // the viewport.\n      view.coordinatesToScreen(params, position);\n      x = position.x;\n      y = position.y;\n\n      if (x != null && y != null) {\n        isVisible = true;\n        this._setPosition(x, y);\n      }\n    }\n  }\n\n  // Show if visible, hide if not.\n  if (isVisible) {\n    element.style.display = 'block';\n    element.style.position = 'absolute';\n  }\n  else {\n    element.style.display = 'none';\n    element.style.position = '';\n  }\n\n};\n\n\nHotspot.prototype._setEmbeddedPosition = function(view, params) {\n  var transform = view.coordinatesToPerspectiveTransform(\n      params, this._perspective.radius, this._perspective.extraTransforms);\n  setTransform(this._domElement, transform);\n};\n\n\nHotspot.prototype._setPosition = function(x, y) {\n  positionAbsolutely(this._domElement, x, y, this._perspective.extraTransforms);\n};\n\n\nmodule.exports = Hotspot;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Hotspot = require('./Hotspot');\nvar calcRect = require('./util/calcRect');\nvar positionAbsolutely = require('./util/positionAbsolutely');\nvar setAbsolute = require('./util/dom').setAbsolute;\nvar setOverflowHidden = require('./util/dom').setOverflowHidden;\nvar setOverflowVisible = require('./util/dom').setOverflowVisible;\nvar setNullSize = require('./util/dom').setNullSize;\nvar setPixelSize = require('./util/dom').setPixelSize;\nvar setPointerEvents = require('./util/dom').setWithVendorPrefix('pointer-events');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that a hotspot has been created or destroyed on the container.\n * @event HotspotContainer#hotspotsChange\n */\n\n/**\n * @class HotspotContainer\n * @classdesc\n *\n * Creates a DOM element to hold {@link Hotspot hotspots} and updates their\n * position when necessary.\n *\n * @param {Element} parentDomElement The DOM element inside which the container\n *     should be created.\n * @param {Stage} stage The underlying stage.\n * @param {View} view The view according to which the hotspots are positioned.\n * @param {RenderLoop} renderLoop The render loop indicating when the hotspots\n *     must be rendered.\n * @param {Object} opts\n * @param {RectSpec} opts.rect Rectangular region covered by the container. See\n *    {@link Effects#rect}.\n */\nfunction HotspotContainer(parentDomElement, stage, view, renderLoop, opts) {\n  opts = opts || {};\n\n  this._parentDomElement = parentDomElement;\n  this._stage = stage;\n  this._view = view;\n  this._renderLoop = renderLoop;\n\n  // Hotspot list.\n  this._hotspots = [];\n\n  // Whether the hotspot container should be visible.\n  this._visible = true;\n\n  // The current rect.\n  this._rect = opts.rect;\n\n  // Whether the visibility or the rect have changed since the last DOM update.\n  this._visibilityOrRectChanged = true;\n\n  // The last seen stage dimensions.\n  this._stageWidth = null;\n  this._stageHeight = null;\n\n  // Temporary variable to hold the calculated position and size.\n  this._tmpRect = {};\n\n  // Wrapper element. When the rect effect is set, the wrapper will have nonzero\n  // dimensions and `pointer-events: none` so that hotspots outside the rect are\n  // hidden, but no mouse events are hijacked.\n  this._hotspotContainerWrapper = document.createElement('div');\n  setAbsolute(this._hotspotContainerWrapper);\n  setPointerEvents(this._hotspotContainerWrapper, 'none');\n  this._parentDomElement.appendChild(this._hotspotContainerWrapper);\n\n  // Hotspot container element. It has zero dimensions and `pointer-events: all`\n  // to override the `pointer-events: none` on the wrapper and allow hotspots to\n  // be interacted with.\n  this._hotspotContainer = document.createElement('div');\n  setAbsolute(this._hotspotContainer);\n  setPointerEvents(this._hotspotContainer, 'all');\n  this._hotspotContainerWrapper.appendChild(this._hotspotContainer);\n\n  // Update when the hotspots change or scene is re-rendered.\n  this._updateHandler = this._update.bind(this);\n  this._renderLoop.addEventListener('afterRender', this._updateHandler);\n}\n\neventEmitter(HotspotContainer);\n\n\n/**\n * Destructor.\n */\nHotspotContainer.prototype.destroy = function() {\n  while (this._hotspots.length) {\n    this.destroyHotspot(this._hotspots[0]);\n  }\n\n  this._parentDomElement.removeChild(this._hotspotContainerWrapper);\n\n  this._renderLoop.removeEventListener('afterRender', this._updateHandler);\n\n  clearOwnProperties(this);\n};\n\n\n/**\n * @return {Element}\n */\nHotspotContainer.prototype.domElement = function() {\n  return this._hotspotContainer;\n};\n\n\n/**\n * @param {Rect} rect\n */\nHotspotContainer.prototype.setRect = function(rect) {\n  this._rect = rect;\n  this._visibilityOrRectChanged = true;\n};\n\n\n/**\n * @return {Rect}\n */\nHotspotContainer.prototype.rect = function() {\n  return this._rect;\n};\n\n\n/**\n * Creates a new hotspot in this container.\n *\n * @param {Element} domElement DOM element to use for the hotspot\n * @param {Object} coords The hotspot coordinates.\n *     Use {@link RectilinearViewCoords}` for a {@link RectilinearView} or\n *     {@link FlatViewCoords} for a {@link FlatView}.\n * @param {Object} opts Options in the same format as the `opts` argument to\n *     the {@link Hotspot} constructor.\n * @return {Hotspot}\n */\nHotspotContainer.prototype.createHotspot = function(domElement, coords, opts) {\n  coords = coords || {};\n\n  var hotspot = new Hotspot(\n      domElement, this._hotspotContainer, this._view, coords, opts);\n  this._hotspots.push(hotspot);\n  hotspot._update();\n\n  this.emit('hotspotsChange');\n\n  return hotspot;\n};\n\n\n/**\n * @param {Hotspot} hotspot\n * @return {boolean}\n */\nHotspotContainer.prototype.hasHotspot = function(hotspot) {\n  return this._hotspots.indexOf(hotspot) >= 0;\n};\n\n\n/**\n * @return {Hotspot[]}\n */\nHotspotContainer.prototype.listHotspots = function() {\n  return [].concat(this._hotspots);\n};\n\n\n/**\n * Removes a hotspot from the container.\n *\n * @param {Hotspot} hotspot\n */\nHotspotContainer.prototype.destroyHotspot = function(hotspot) {\n  var i = this._hotspots.indexOf(hotspot);\n  if (i < 0) {\n    throw new Error('No such hotspot');\n  }\n  this._hotspots.splice(i, 1);\n\n  hotspot.destroy();\n  this.emit('hotspotsChange');\n};\n\n\n/**\n * Hide the container's DOM element, causing every contained {@link Hotspot} to\n * be hidden.\n */\nHotspotContainer.prototype.hide = function() {\n  if (this._visible) {\n    this._visible = false;\n    this._visibilityOrRectChanged = true;\n    this._update();\n  }\n};\n\n\n/**\n * Show the container's DOM element, causing every contained {@link Hotspot} to\n * be shown.\n */\nHotspotContainer.prototype.show = function() {\n  if (!this._visible) {\n    this._visible = true;\n    this._visibilityOrRectChanged = true;\n    this._update();\n  }\n};\n\n\nHotspotContainer.prototype._update = function() {\n  var wrapper = this._hotspotContainerWrapper;\n  var width = this._stage.width();\n  var height = this._stage.height();\n  var tmpRect = this._tmpRect;\n\n  // Avoid updating the wrapper DOM unless necessary.\n  if (this._visibilityOrRectChanged ||\n      (this._rect && (width !== this._stageWidth || height !== this._stageHeight))) {\n    var visible = this._visible;\n    wrapper.style.display = visible ? 'block' : 'none';\n\n    if (visible) {\n      if (this._rect) {\n        calcRect(width, height, this._rect, tmpRect);\n        positionAbsolutely(wrapper, width * tmpRect.x, height * tmpRect.y);\n        setPixelSize(wrapper, width * tmpRect.width, height * tmpRect.height);\n        setOverflowHidden(wrapper);\n      } else {\n        positionAbsolutely(wrapper, 0, 0);\n        setNullSize(wrapper);\n        setOverflowVisible(wrapper);\n      }\n    }\n\n    this._stageWidth = width;\n    this._stageHeight = height;\n    this._visibilityOrRectChanged = false;\n  }\n\n  // Update hotspots unconditionally, as the view parameters may have changed.\n  for (var i = 0; i < this._hotspots.length; i++) {\n    this._hotspots[i]._update();\n  }\n};\n\n\nmodule.exports = HotspotContainer;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Layer = require('./Layer');\nvar TextureStore = require('./TextureStore');\nvar HotspotContainer = require('./HotspotContainer');\nvar eventEmitter = require('minimal-event-emitter');\nvar now = require('./util/now');\nvar noop = require('./util/noop');\nvar type = require('./util/type');\nvar defaults = require('./util/defaults');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that the scene's view has changed. See {@link View#event:change}.\n * @event Scene#viewChange\n */\n\n/**\n * Signals that the scene's layers have changed.\n * @event Scene#layerChange\n */\n\n/**\n * @class Scene\n * @classdesc\n *\n * A Scene is a stack of {@link Layer layers} sharing the same {@link View view}\n * and {@link HotspotContainer hotspot container}. It belongs to the\n * {@link Viewer viewer} inside which it is displayed.\n *\n * Clients should call {@link Viewer#createScene} instead of invoking the\n * constructor directly.\n *\n * @param {Viewer} viewer The viewer this scene belongs to.\n * @param {View} view The scene's underlying view.\n */\nfunction Scene(viewer, view) {\n  this._viewer = viewer;\n  this._view = view;\n  this._layers = [];\n\n  // Hotspot container. Assume it occupies a full rect.\n  this._hotspotContainer = new HotspotContainer(\n    viewer._controlContainer,\n    viewer.stage(),\n    this._view,\n    viewer.renderLoop());\n\n  // The current movement.\n  this._movement = null;\n  this._movementStartTime = null;\n  this._movementStep = null;\n  this._movementParams = null;\n  this._movementCallback = null;\n\n  // Event listener for updating the view according to the current movement.\n  // The listener is set/unset on the render loop when a movement starts/stops.\n  this._updateMovementHandler = this._updateMovement.bind(this);\n\n  // Show or hide hotspots when scene changes.\n  this._updateHotspotContainerHandler = this._updateHotspotContainer.bind(this);\n  this._viewer.addEventListener('sceneChange', this._updateHotspotContainerHandler);\n\n  // Emit event when view changes.\n  this._viewChangeHandler = this.emit.bind(this, 'viewChange');\n  this._view.addEventListener('change', this._viewChangeHandler);\n\n  // Update the hotspot container.\n  this._updateHotspotContainer();\n}\n\neventEmitter(Scene);\n\n\n/**\n * Destructor. Clients should call {@link Viewer#destroyScene} instead.\n */\nScene.prototype.destroy = function() {\n  this._view.removeEventListener('change', this._viewChangeHandler);\n  this._viewer.removeEventListener('sceneChange', this._updateHotspotContainerHandler);\n\n  if (this._movement) {\n    this.stopMovement();\n  }\n\n  this._hotspotContainer.destroy();\n\n  this.destroyAllLayers();\n\n  clearOwnProperties(this);\n};\n\n\n\n/**\n * Returns the {@link HotspotContainer hotspot container} for the scene.\n * @return {Layer}\n */\nScene.prototype.hotspotContainer = function() {\n  return this._hotspotContainer;\n};\n\n/**\n * Returns the first of the {@link Layer layers} belonging to the scene, or\n * null if the scene has no layers.\n *\n * This method is equivalent to `Scene#listLayers[0]`. It may be removed in the\n * future.\n *\n * @return {Layer}\n */\nScene.prototype.layer = function() {\n  return this._layers[0];\n};\n\n/**\n* Returns a list of all {@link Layer layers} belonging to the scene. The\n* returned list is in display order, background to foreground.\n* @return {Layer[]}\n */\nScene.prototype.listLayers = function() {\n  return [].concat(this._layers);\n};\n\n\n/**\n * Returns the scene's underlying {@link View view}.\n * @return {View}\n */\nScene.prototype.view = function() {\n  return this._view;\n};\n\n\n/**\n * Returns the {@link Viewer viewer} the scene belongs to.\n * @return {Viewer}\n */\nScene.prototype.viewer = function() {\n  return this._viewer;\n};\n\n\n/**\n * Returns whether the scene is currently visible.\n * @return {boolean}\n */\nScene.prototype.visible = function() {\n  return this._viewer.scene() === this;\n};\n\n\n/**\n * Creates a new {@link Layer layer} and adds it into the scene in the\n * foreground position.\n *\n * @param {Object} opts Layer creation options.\n * @param {Source} opts.source The layer's underlying {@link Source}.\n * @param {Source} opts.geometry The layer's underlying {@link Geometry}.\n * @param {boolean} [opts.pinFirstLevel=false] Whether to pin the first level to\n *     provide a fallback of last resort, at the cost of memory consumption.\n * @param {Object} [opts.textureStoreOpts={}] Options to pass to the\n *     {@link TextureStore} constructor.\n * @param {Object} [opts.layerOpts={}] Options to pass to the {@link Layer}\n *     constructor.\n * @return {Layer}\n */\nScene.prototype.createLayer = function(opts) {\n  opts = opts || {};\n\n  var textureStoreOpts = opts.textureStoreOpts || {};\n  var layerOpts = opts.layerOpts || {};\n\n  var source = opts.source;\n  var geometry = opts.geometry;\n  var view = this._view;\n  var stage = this._viewer.stage();\n  var textureStore = new TextureStore(source, stage, textureStoreOpts);\n  var layer = new Layer(source, geometry, view, textureStore, layerOpts);\n\n  this._layers.push(layer);\n\n  if (opts.pinFirstLevel) {\n    layer.pinFirstLevel();\n  }\n\n  // Signal that the layers have changed.\n  this.emit('layerChange');\n\n  return layer;\n};\n\n\n/**\n * Destroys a {@link Layer layer} and removes it from the scene.\n * @param {Layer} layer\n * @throws An error if the layer does not belong to the scene.\n */\nScene.prototype.destroyLayer = function(layer) {\n  var i = this._layers.indexOf(layer);\n  if (i < 0) {\n    throw new Error('No such layer in scene');\n  }\n\n  this._layers.splice(i, 1);\n\n  // Signal that the layers have changed.\n  this.emit('layerChange');\n\n  layer.textureStore().destroy();\n  layer.destroy();\n};\n\n\n/**\n * Destroys all {@link Layer layers} and removes them from the scene.\n */\nScene.prototype.destroyAllLayers = function() {\n  while (this._layers.length > 0) {\n    this.destroyLayer(this._layers[0]);\n  }\n};\n\n\n/**\n * Switches to the scene.\n *\n * This is equivalent to calling {@link Viewer#switchScene} on this scene.\n *\n * @param {Object} opts Options to pass into {@link Viewer#switchScene}.\n * @param {function} done Function to call when the switch is complete.\n */\nScene.prototype.switchTo = function(opts, done) {\n  return this._viewer.switchScene(this, opts, done);\n};\n\n\n/**\n * Tweens the scene's underlying {@link View view}.\n *\n * @param {Object} params Target view parameters.\n * @param {Object} opts Transition options.\n * @param {function} [opts.ease=easeInOutQuad] Tween easing function\n * @param {number} [opts.controlsInterrupt=false] allow controls to interrupt\n *     an ongoing tween.\n * @param {number} [opts.transitionDuration=1000] Tween duration, in\n *     milliseconds.\n * @param {number} [opts.closest=true] Whether to tween through the shortest\n *    path between the initial and final view parameters. This requires\n *    {@link View#normalizeToClosest} to be implemented, and does nothing\n *    otherwise.\n * @param {function} done Function to call when the tween finishes or is\n *    interrupted.\n */\nScene.prototype.lookTo = function(params, opts, done) {\n  var self = this;\n\n  opts = opts || {};\n  done = done || noop;\n\n  if (type(params) !== 'object') {\n    throw new Error(\"Target view parameters must be an object\");\n  }\n\n  // Quadratic in/out easing.\n  var easeInOutQuad = function (k) {\n    if ((k *= 2) < 1) {\n      return 0.5 * k * k;\n    }\n    return -0.5 * (--k * (k - 2) - 1);\n  };\n\n  var ease = opts.ease != null ? opts.ease : easeInOutQuad;\n  var controlsInterrupt = opts.controlsInterrupt != null ? opts.controlsInterrupt : false;\n  var duration = opts.transitionDuration != null ? opts.transitionDuration : 1000;\n  var shortest = opts.shortest != null ? opts.shortest : true;\n\n  var view = this._view;\n\n  var initialParams = view.parameters();\n\n  var finalParams = {};\n  defaults(finalParams, params);\n  defaults(finalParams, initialParams);\n\n  // Tween through the shortest path if requested.\n  // The view must implement the normalizeToClosest() method.\n  if (shortest && view.normalizeToClosest) {\n    view.normalizeToClosest(finalParams, finalParams);\n  }\n\n  var movement = function() {\n\n    var finalUpdate = false;\n\n    return function(params, elapsed) {\n\n      if (elapsed >= duration && finalUpdate) {\n        return null;\n      }\n\n      var delta = Math.min(elapsed / duration, 1);\n\n      for (var param in params) {\n        var start = initialParams[param];\n        var end = finalParams[param];\n        params[param] = start + ease(delta) * (end - start);\n      }\n\n      finalUpdate = elapsed >= duration;\n\n      return params;\n\n    };\n  };\n\n  var reenableControls = this._viewer.controls().enabled();\n\n  if (!controlsInterrupt) {\n    this._viewer.controls().disable();\n  }\n\n  this.startMovement(movement, function() {\n    if (reenableControls) {\n      self._viewer.controls().enable();\n    }\n    done();\n  });\n\n};\n\n\n/**\n * Starts a movement, possibly replacing the current movement.\n *\n * @param {function} fn The movement function.\n * @param {function} done Function to be called when the movement finishes or is\n *     interrupted.\n */\nScene.prototype.startMovement = function(fn, done) {\n\n  var renderLoop = this._viewer.renderLoop();\n\n  if (this._movement) {\n    this.stopMovement();\n  }\n\n  var step = fn();\n  if (typeof step !== 'function') {\n    throw new Error('Bad movement');\n  }\n\n  this._movement = fn;\n  this._movementStep = step;\n  this._movementStartTime = now();\n  this._movementParams = {};\n  this._movementCallback = done;\n\n  renderLoop.addEventListener('beforeRender', this._updateMovementHandler);\n  renderLoop.renderOnNextFrame();\n};\n\n\n/**\n * Stops the current movement.\n */\nScene.prototype.stopMovement = function() {\n\n  var done = this._movementCallback;\n  var renderLoop = this._viewer.renderLoop();\n\n  if (!this._movement) {\n    return;\n  }\n\n  // Clear state before calling done, to prevent an infinite loop when the\n  // callback starts a new movement.\n  this._movement = null;\n  this._movementStep = null;\n  this._movementStartTime = null;\n  this._movementParams = null;\n  this._movementCallback = null;\n\n  renderLoop.removeEventListener('beforeRender', this._updateMovementHandler);\n\n  if (done) {\n    done();\n  }\n};\n\n\n/**\n * Returns the current movement.\n * @return {function}\n */\nScene.prototype.movement = function() {\n  return this._movement;\n};\n\n\nScene.prototype._updateMovement = function() {\n\n  if (!this._movement) {\n    throw new Error('Should not call update');\n  }\n\n  var renderLoop = this._viewer.renderLoop();\n  var view = this._view;\n\n  var elapsed = now() - this._movementStartTime;\n  var step = this._movementStep;\n  var params = this._movementParams;\n\n  params = view.parameters(params);\n  params = step(params, elapsed);\n  if (params == null) {\n    this.stopMovement();\n  } else {\n    view.setParameters(params);\n    renderLoop.renderOnNextFrame();\n  }\n\n};\n\n\nScene.prototype._updateHotspotContainer = function() {\n  if (this.visible()) {\n    this._hotspotContainer.show();\n  } else {\n    this._hotspotContainer.hide();\n  }\n};\n\n\nmodule.exports = Scene;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar defaults = require('./util/defaults');\nvar now = require('./util/now');\n\nvar defaultOptions = {\n  duration: Infinity\n};\n\n\n/**\n * Signals a timeout.\n * @event Timer#timeout\n */\n\n\n/**\n * @class Timer\n * @classdesc\n *\n * A Timer provides a mechanism to receive an event after a timeout.\n *\n * A timer has a set duration, and is either started or stopped at a given time.\n * The timer is initially stopped. When the timer is started, a timeout event is\n * scheduled to fire once the set duration elapses. When the timer is stopped,\n * the scheduled timeout event is cancelled. When a timeout event fires, the\n * timer returns to the stopped state.\n *\n * @param {number} [opts.duration=Infinity] Timeout in milliseconds.\n */\nfunction Timer(opts) {\n\n  opts = defaults(opts || {}, defaultOptions);\n\n  this._duration = opts.duration;\n\n  this._startTime = null;\n\n  this._handle = null;\n\n  this._check = this._check.bind(this);\n\n}\n\neventEmitter(Timer);\n\n\n/**\n * Starts the timer. If the timer is already started, this has the effect of\n * stopping and starting again (i.e. resetting the timer).\n */\nTimer.prototype.start = function() {\n  this._startTime = now();\n  if (this._handle == null && this._duration < Infinity) {\n    this._setup(this._duration);\n  }\n};\n\n\n/**\n * Returns whether the timer is in the started state.\n * @return {boolean}\n */\nTimer.prototype.started = function() {\n  return this._startTime != null;\n};\n\n\n/**\n * Stops the timer.\n */\nTimer.prototype.stop = function() {\n  this._startTime = null;\n  if (this._handle != null) {\n    clearTimeout(this._handle);\n    this._handle = null;\n  }\n};\n\n\nTimer.prototype._setup = function(interval) {\n  this._handle = setTimeout(this._check, interval);\n};\n\n\nTimer.prototype._teardown = function() {\n  clearTimeout(this._handle);\n  this._handle = null;\n};\n\n\nTimer.prototype._check = function() {\n  var currentTime = now();\n  var elapsed = currentTime - this._startTime;\n  var remaining = this._duration - elapsed;\n\n  this._teardown();\n\n  if (remaining <= 0) {\n    this.emit('timeout');\n    this._startTime = null;\n  } else if (remaining < Infinity) {\n    this._setup(remaining);\n  }\n};\n\n\n/**\n * Returns the currently set duration.\n */\nTimer.prototype.duration = function() {\n  return this._duration;\n};\n\n\n/**\n * Sets the duration. If the timer is already started, the timeout event is\n * rescheduled to occur once the new duration has elapsed since the last call\n * to start. In particular, if an amount of time larger than the new duration\n * has already elapsed, the timeout event fires immediately.\n * @param {number}\n */\nTimer.prototype.setDuration = function(duration) {\n  this._duration = duration;\n  if (this._startTime != null) {\n    this._check();\n  }\n};\n\n\nmodule.exports = Timer;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar defaults = require('../util/defaults');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar defaultOpts = {\n  active: 'move',\n  inactive: 'default',\n  disabled: 'default'\n};\n\n/**\n * @class ControlCursor\n * @classdesc\n *\n * Sets the CSS cursor on a DOM element according to the state of a\n * {@link ControlMethod}.\n *\n * @param {Controls} controls Controls instance containing the control method.\n * @param {string} id ID of the control method.\n * @param {Element} element DOM element where the cursor should be set.\n * @param {Object} opts The control cursors. Each field must be a valid value\n *     for the `cursor` CSS property.\n * @param {string} [opts.active='move'] Cursor to set when the control method\n *     is enabled and active.\n * @param {string} [opts.inactive='default'] Cursor to set when the control\n *     method is enabled and inactive.\n * @param {string} [opts.disabled='default'] Cursor to set when the control\n *     method is disabled.\n */\nfunction ControlCursor(controls, id, element, opts) {\n  opts = defaults(opts || {}, defaultOpts);\n\n  // TODO: This class may misbehave if the control method is unregistered and a\n  // different control method is registered under the same id.\n\n  this._element = element;\n  this._controls = controls;\n  this._id = id;\n\n  this._attached = false;\n\n  this._setActiveCursor = this._setCursor.bind(this, opts.active);\n  this._setInactiveCursor = this._setCursor.bind(this, opts.inactive);\n  this._setDisabledCursor = this._setCursor.bind(this, opts.disabled);\n  this._setOriginalCursor = this._setCursor.bind(this, this._element.style.cursor);\n\n  this._updateAttachmentHandler = this._updateAttachment.bind(this);\n\n  controls.addEventListener('methodEnabled', this._updateAttachmentHandler);\n  controls.addEventListener('methodDisabled', this._updateAttachmentHandler);\n  controls.addEventListener('enabled', this._updateAttachmentHandler);\n  controls.addEventListener('disabled', this._updateAttachmentHandler);\n\n  this._updateAttachment();\n}\n\n/**\n * Destructor.\n */\nControlCursor.prototype.destroy = function() {\n  this._detachFromControlMethod(this._controls.method(this._id));\n  this._setOriginalCursor();\n\n  this._controls.removeEventListener('methodEnabled',\n      this._updateAttachmentHandler);\n  this._controls.removeEventListener('methodDisabled',\n      this._updateAttachmentHandler);\n  this._controls.removeEventListener('enabled',\n      this._updateAttachmentHandler);\n  this._controls.removeEventListener('disabled',\n      this._updateAttachmentHandler);\n\n  clearOwnProperties(this);\n};\n\nControlCursor.prototype._updateAttachment = function() {\n  var controls = this._controls;\n  var id = this._id;\n  if (controls.enabled() && controls.method(id).enabled) {\n    this._attachToControlMethod(controls.method(id));\n  } else {\n    this._detachFromControlMethod(controls.method(id));\n  }\n};\n\nControlCursor.prototype._attachToControlMethod = function(controlMethod) {\n  if (!this._attached) {\n    controlMethod.instance.addEventListener('active', this._setActiveCursor);\n    controlMethod.instance.addEventListener('inactive', this._setInactiveCursor);\n\n    if (controlMethod.active) {\n      this._setActiveCursor();\n    } else {\n      this._setInactiveCursor();\n    }\n\n    this._attached = true;\n  }\n};\n\nControlCursor.prototype._detachFromControlMethod = function(controlMethod) {\n  if (this._attached) {\n    controlMethod.instance.removeEventListener('active', this._setActiveCursor);\n    controlMethod.instance.removeEventListener('inactive', this._setInactiveCursor);\n\n    this._setDisabledCursor();\n\n    this._attached = false;\n  }\n};\n\nControlCursor.prototype._setCursor = function(cursor) {\n  this._element.style.cursor = cursor;\n}\n\nmodule.exports = ControlCursor;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar defaults = require('../util/defaults');\nvar DragControlMethod = require('./Drag');\nvar QtvrControlMethod = require('./Qtvr');\nvar ScrollZoomControlMethod = require('./ScrollZoom');\nvar PinchZoomControlMethod = require('./PinchZoom');\nvar KeyControlMethod = require('./Key');\n\nvar defaultOptions = {\n  mouseViewMode: 'drag',\n  dragMode: 'pan'\n};\n\n/**\n * Instantiate and register some commonly used {@link ControlMethod} instances.\n *\n * The following instances are registered:\n *   - mouseViewDrag\n *   - mouseViewQtvr\n *   - touchView\n *   - pinch\n *   - arrowKeys\n *   - plusMinusKeys\n *   - wasdKeys\n *   - qeKeys\n *\n * @param {Controls} controls Where to register the instances.\n * @param {Element} element Element to listen for events.\n * @param {'drag'|'qtvr'} opts.mouseViewMode\n * @param {'pan'|'pinch'} opts.dragMode\n * @param {boolean} opts.scrollZoom\n */\nfunction registerDefaultControls(controls, element, opts) {\n  opts = defaults(opts || {}, defaultOptions);\n\n  var controlMethods = {\n    mouseViewDrag: new DragControlMethod(element, 'mouse'),\n    mouseViewQtvr: new QtvrControlMethod(element, 'mouse'),\n\n    leftArrowKey: new KeyControlMethod(37, 'x', -0.7, 3),\n    rightArrowKey: new KeyControlMethod(39, 'x', 0.7, 3),\n    upArrowKey: new KeyControlMethod(38, 'y', -0.7, 3),\n    downArrowKey: new KeyControlMethod(40, 'y', 0.7, 3),\n    plusKey: new KeyControlMethod(107, 'zoom', -0.7, 3),\n    minusKey: new KeyControlMethod(109, 'zoom', 0.7, 3),\n\n    wKey: new KeyControlMethod(87, 'y', -0.7, 3),\n    aKey: new KeyControlMethod(65, 'x', -0.7, 3),\n    sKey: new KeyControlMethod(83, 'y', 0.7, 3),\n    dKey: new KeyControlMethod(68, 'x', 0.7, 3),\n    qKey: new KeyControlMethod(81, 'roll', 0.7, 3),\n    eKey: new KeyControlMethod(69, 'roll', -0.7, 3)\n  };\n\n  var enabledControls = ['scrollZoom', 'touchView', 'pinch' ];\n\n  if (opts.scrollZoom !== false) {\n    controlMethods.scrollZoom = new ScrollZoomControlMethod(element); //{ frictionTime: 0 }\n  }\n\n  var controlMethodGroups = {\n    arrowKeys: [ 'leftArrowKey', 'rightArrowKey', 'upArrowKey', 'downArrowKey' ],\n    plusMinusKeys: [ 'plusKey', 'minusKey' ],\n    wasdKeys: [ 'wKey', 'aKey', 'sKey', 'dKey' ],\n    qeKeys: [ 'qKey', 'eKey' ]\n  };\n\n\n  switch (opts.dragMode) {\n    case 'pinch':\n       controlMethods.pinch = new DragControlMethod(element, 'touch', { hammerEvent: 'pinch' });\n      break;\n    case 'pan':\n      controlMethods.touchView = new DragControlMethod(element, 'touch');\n      controlMethods.pinch = new PinchZoomControlMethod(element, 'touch');\n      break;\n    default:\n      throw new Error(\"Unknown drag mode: \" + opts.dragMode);\n  }\n\n  switch (opts.mouseViewMode) {\n    case 'drag':\n      enabledControls.push('mouseViewDrag');\n      break;\n    case 'qtvr':\n      enabledControls.push('mouseViewQtvr');\n      break;\n    default:\n      throw new Error(\"Unknown mouse view mode: \" + opts.mouseViewMode);\n  }\n\n  for (var id in controlMethods) {\n    var method = controlMethods[id];\n    controls.registerMethod(id, method);\n    if (enabledControls.indexOf(id) >= 0) {\n      controls.enableMethod(id);\n    }\n  }\n\n  for (var groupId in controlMethodGroups) {\n    var methodGroup = controlMethodGroups[groupId];\n    controls.addMethodGroup(groupId, methodGroup);\n  }\n\n  return controlMethods;\n}\n\nmodule.exports = registerDefaultControls;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar now = require('./now');\n\nfunction tween(duration, update, done) {\n  var cancelled = false;\n\n  var startTime = now();\n\n  function runUpdate() {\n    if(cancelled) { return; }\n    var tweenVal = (now() - startTime)/duration;\n    if(tweenVal < 1) {\n      update(tweenVal);\n      requestAnimationFrame(runUpdate);\n    }\n    else {\n      update(1);\n      done();\n    }\n  }\n\n  update(0);\n  requestAnimationFrame(runUpdate);\n\n  return function cancel() {\n    cancelled = true;\n    done.apply(null, arguments);\n  }\n}\n\nmodule.exports = tween;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\n\nvar RenderLoop = require('./RenderLoop');\nvar Controls = require('./controls/Controls');\nvar Scene = require('./Scene');\nvar Timer = require('./Timer');\n\nvar WebGlStage = require('./stages/WebGl');\n\nvar ControlCursor = require('./controls/ControlCursor');\nvar HammerGestures = require('./controls/HammerGestures');\n\nvar registerDefaultControls = require('./controls/registerDefaultControls');\nvar registerDefaultRenderers = require('./renderers/registerDefaultRenderers');\n\nvar setOverflowHidden = require('./util/dom').setOverflowHidden;\nvar setAbsolute = require('./util/dom').setAbsolute;\nvar setFullSize = require('./util/dom').setFullSize;\n\nvar tween = require('./util/tween');\nvar noop = require('./util/noop');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that the current scene has changed.\n * @event Viewer#sceneChange\n */\n\n/**\n * Signals that the view of the current scene has changed. See\n * {@link View#event:change}.\n * @event Viewer#viewChange\n */\n\n/**\n * @class Viewer\n * @classdesc\n *\n * A Viewer is a container for multiple {@link Scene scenes} to be displayed\n * inside a {@link Stage stage} contained in the DOM.\n *\n * Scenes may be created by calling {@link Viewer#createScene}. Except during a\n * scene switch, a single one of them, called the current scene, is visible.\n * Calling {@link Viewer#switchScene} sets the current scene and switches to it.\n *\n * @param {Element} domElement The DOM element to contain the stage.\n * @param {Object} opts Viewer creation options.\n * @param {Object} opts.controls Options to be passed to\n *     {@link registerDefaultControls}.\n * @param {Object} opts.stage Options to be passed to the {@link Stage}\n *     constructor.\n * @param {Object} opts.cursors Cursor options.\n * @param {Object} opts.cursors.drag Drag cursor options to be passed to the\n *     {@link ControlCursor} constructor.\n */\nfunction Viewer(domElement, opts) {\n  opts = opts || {};\n\n  this._domElement = domElement;\n\n  // Add `overflow: hidden` to the domElement.\n  setOverflowHidden(domElement);\n\n  // Create stage.\n  this._stage = new WebGlStage(opts.stage);\n\n  // Register the default renderers for the selected stage.\n  registerDefaultRenderers(this._stage);\n\n  // Add the stage element into the DOM.\n  this._domElement.appendChild(this._stage.domElement());\n\n  // Create control container.\n  // Controls cannot be placed directly on the root DOM element because\n  // Hammer.js will prevent click events from reaching the elements beneath.\n\n  // The hotspot containers will be added inside the controls container.\n  this._controlContainer = document.createElement('div');\n  setAbsolute(this._controlContainer);\n  setFullSize(this._controlContainer);\n  domElement.appendChild(this._controlContainer);\n\n  // Respond to window size changes.\n  this._size = {};\n  this.updateSize();\n  this._updateSizeListener = this.updateSize.bind(this);\n  window.addEventListener('resize', this._updateSizeListener);\n\n  // Create render loop.\n  this._renderLoop = new RenderLoop(this._stage);\n\n  // Create the controls and register them with the render loop.\n  this._controls = new Controls();\n  this._controlMethods = registerDefaultControls(this._controls, this._controlContainer, opts.controls);\n  this._controls.attach(this._renderLoop);\n\n  // Expose HammerJS.\n  this._hammerManagerTouch = HammerGestures.get(this._controlContainer, 'touch');\n  this._hammerManagerMouse = HammerGestures.get(this._controlContainer, 'mouse');\n\n  // Initialize drag cursor.\n  this._dragCursor = new ControlCursor(this._controls, 'mouseViewDrag', domElement, opts.cursors && opts.cursors.drag || {});\n\n  // Start the render loop.\n  this._renderLoop.start();\n\n  // Scene list.\n  this._scenes = [];\n\n  // The currently visible scene.\n  // During a scene transition, this is the scene being switched to.\n  this._currentScene = null;\n\n  // The scene being switched from during a scene transition.\n  // This is necessary to update the layers correctly when they are added or\n  // removed during a transition.\n  this._replacedScene = null;\n\n  // The current transition.\n  this._cancelCurrentTween = null;\n\n  // The event listener fired when the current scene layers change.\n  // This is attached to the correct scene whenever the current scene changes.\n  this._layerChangeHandler = this._updateSceneLayers.bind(this);\n\n  // The event listener fired when the current scene view changes.\n  // This is attached to the correct scene whenever the current scene changes.\n  this._viewChangeHandler = this.emit.bind(this, 'viewChange');\n\n  // Setup the idle timer.\n  // By default, the timer has an infinite duration so it does nothing.\n  this._idleTimer = new Timer();\n  this._idleTimer.start();\n\n  // Reset the timer whenever the view changes.\n  this._resetIdleTimerHandler = this._resetIdleTimer.bind(this);\n  this.addEventListener('viewChange', this._resetIdleTimerHandler);\n\n  // Start the idle movement when the idle timer fires.\n  this._triggerIdleTimerHandler = this._triggerIdleTimer.bind(this);\n  this._idleTimer.addEventListener('timeout', this._triggerIdleTimerHandler);\n\n  // Stop an ongoing movement when the controls are activated or when the\n  // scene changes.\n  this._stopMovementHandler = this.stopMovement.bind(this);\n  this._controls.addEventListener('active', this._stopMovementHandler);\n  this.addEventListener('sceneChange', this._stopMovementHandler);\n\n  // The currently programmed idle movement.\n  this._idleMovement = null;\n}\n\neventEmitter(Viewer);\n\n\n/**\n * Destructor.\n */\nViewer.prototype.destroy = function() {\n\n  window.removeEventListener('resize', this._updateSizeListener);\n\n  if (this._currentScene) {\n    this._removeSceneEventListeners(this._currentScene);\n  }\n\n  if (this._replacedScene) {\n    this._removeSceneEventListeners(this._replacedScene);\n  }\n\n  this._dragCursor.destroy();\n\n  for (var methodName in this._controlMethods) {\n    this._controlMethods[methodName].destroy();\n  }\n\n  while (this._scenes.length) {\n    this.destroyScene(this._scenes[0]);\n  }\n\n  this._domElement.removeChild(this._stage.domElement());\n\n  this._stage.destroy();\n  this._renderLoop.destroy();\n  this._controls.destroy();\n  this._controls = null;\n\n  if (this._cancelCurrentTween) {\n    this._cancelCurrentTween();\n  }\n\n  clearOwnProperties(this);\n};\n\n\n/**\n * Updates the stage size to fill the containing element.\n *\n * This method is automatically called when the browser window is resized.\n * Most clients won't need to explicitly call it to keep the size up to date.\n */\nViewer.prototype.updateSize = function() {\n  var size = this._size;\n  size.width = this._domElement.clientWidth;\n  size.height = this._domElement.clientHeight;\n  this._stage.setSize(size);\n};\n\n\n/**\n * Returns the underlying {@link Stage stage}.\n * @return {Stage}\n */\nViewer.prototype.stage = function() {\n  return this._stage;\n};\n\n\n/**\n * Returns the underlying {@link RenderLoop render loop}.\n * @return {RenderLoop}\n */\nViewer.prototype.renderLoop = function() {\n  return this._renderLoop;\n};\n\n\n/**\n * Returns the underlying {@link Controls controls}.\n * @return {Controls}\n */\nViewer.prototype.controls = function() {\n  return this._controls;\n};\n\n\n/**\n * Returns the underlying DOM element.\n * @return {Element}\n */\nViewer.prototype.domElement = function() {\n  return this._domElement;\n};\n\n\n/**\n * Creates a new {@link Scene scene} with a single layer and adds it to the\n * viewer.\n *\n * The current scene does not change. To switch to the scene, call\n * {@link Viewer#switchScene}.\n *\n * @param {Object} opts Scene creation options.\n * @param {View} opts.view The scene's underlying {@link View}.\n * @param {Source} opts.source The layer's underlying {@link Source}.\n * @param {Geometry} opts.geometry The layer's underlying {@link Geometry}.\n * @param {boolean} [opts.pinFirstLevel=false] Whether to pin the first level to\n *     provide a fallback of last resort, at the cost of memory consumption.\n * @param {Object} [opts.textureStoreOpts={}] Options to pass to the\n *     {@link TextureStore} constructor.\n * @param {Object} [opts.layerOpts={}] Options to pass to the {@link Layer}\n *     constructor.\n * @return {Scene}\n */\nViewer.prototype.createScene = function(opts) {\n  opts = opts || {};\n\n  var scene = this.createEmptyScene({ view: opts.view });\n\n  scene.createLayer({\n    source: opts.source,\n    geometry: opts.geometry,\n    pinFirstLevel: opts.pinFirstLevel,\n    textureStoreOpts: opts.textureStoreOpts,\n    layerOpts: opts.layerOpts\n  });\n\n  return scene;\n};\n\n\n/**\n * Creates a new {@link Scene scene} with no layers and adds it to the viewer.\n *\n * Layers may be added to the scene by calling {@link Scene#createLayer}.\n * However, if the scene has a single layer, it is simpler to call\n * {@link Viewer#createScene} instead of this method.\n *\n * The current scene does not change. To switch to the scene, call\n * {@link Viewer#switchScene}.\n *\n * @param {Object} opts Scene creation options.\n * @param {View} opts.view The scene's underlying {@link View}.\n * @return {Scene}\n */\nViewer.prototype.createEmptyScene = function(opts) {\n  opts = opts || {};\n\n  var scene = new Scene(this, opts.view);\n  this._scenes.push(scene);\n\n  return scene;\n};\n\n\nViewer.prototype._updateSceneLayers = function() {\n  var i;\n  var layer;\n\n  var stage = this._stage;\n  var currentScene = this._currentScene;\n  var replacedScene = this._replacedScene;\n\n  var oldLayers = stage.listLayers();\n\n  // The stage contains layers from at most two scenes: the current one, on top,\n  // and the one currently being switched away from, on the bottom.\n  var newLayers = [];\n  if (replacedScene) {\n    newLayers = newLayers.concat(replacedScene.listLayers());\n  }\n  if (currentScene) {\n    newLayers = newLayers.concat(currentScene.listLayers());\n  }\n\n  // A single layer can be added or removed from the scene at a time.\n  if (Math.abs(oldLayers.length - newLayers.length) !== 1) {\n    throw new Error('Stage and scene out of sync');\n  }\n\n  if (newLayers.length < oldLayers.length) {\n    // A layer was removed.\n    for (i = 0; i < oldLayers.length; i++) {\n      layer = oldLayers[i];\n      if (newLayers.indexOf(layer) < 0) {\n        this._removeLayerFromStage(layer);\n        break;\n      }\n    }\n  }\n  if (newLayers.length > oldLayers.length) {\n    // A layer was added.\n    for (i = 0; i < newLayers.length; i++) {\n      layer = newLayers[i];\n      if (oldLayers.indexOf(layer) < 0) {\n        this._addLayerToStage(layer, i);\n      }\n    }\n  }\n\n  // TODO: When in the middle of a scene transition, call the transition update\n  // function immediately to prevent an added layer from flashing with the wrong\n  // opacity.\n};\n\n\nViewer.prototype._addLayerToStage = function(layer, i) {\n  // Pin the first level to ensure a fallback while the layer is visible.\n  // Note that this is distinct from the `pinFirstLevel` option passed to\n  // createScene(), which pins the layer even when it's not visible.\n  layer.pinFirstLevel();\n  this._stage.addLayer(layer, i);\n};\n\n\nViewer.prototype._removeLayerFromStage = function(layer) {\n  this._stage.removeLayer(layer);\n  layer.unpinFirstLevel();\n  layer.textureStore().clearNotPinned();\n};\n\n\nViewer.prototype._addSceneEventListeners = function(scene) {\n  scene.addEventListener('layerChange', this._layerChangeHandler);\n  scene.addEventListener('viewChange', this._viewChangeHandler);\n};\n\n\nViewer.prototype._removeSceneEventListeners = function(scene) {\n  scene.removeEventListener('layerChange', this._layerChangeHandler);\n  scene.removeEventListener('viewChange', this._viewChangeHandler);\n};\n\n\n/**\n * Destroys a {@link Scene scene} and removes it from the viewer.\n * @param {Scene} scene\n */\nViewer.prototype.destroyScene = function(scene) {\n  var i = this._scenes.indexOf(scene);\n  if (i < 0) {\n    throw new Error('No such scene in viewer');\n  }\n\n  var j;\n  var layers;\n\n  if (this._currentScene === scene) {\n    // The destroyed scene is the current scene.\n    // Remove event listeners, remove layers from stage and cancel transition.\n    this._removeSceneEventListeners(scene);\n    layers = scene.listLayers();\n    for (j = 0; j < layers.length; j++) {\n      this._removeLayerFromStage(layers[j]);\n    }\n    if (this._cancelCurrentTween) {\n      this._cancelCurrentTween();\n      this._cancelCurrentTween = null;\n    }\n    this._currentScene = null;\n    this.emit('sceneChange');\n  }\n\n  if (this._replacedScene === scene) {\n    // The destroyed scene is being switched away from.\n    // Remove event listeners and remove layers from stage.\n    this._removeSceneEventListeners(scene);\n    layers = scene.listLayers();\n    for (j = 0; j < layers.length; j++) {\n      this._removeLayerFromStage(layers[j]);\n    }\n    this._replacedScene = null;\n  }\n\n  this._scenes.splice(i, 1);\n\n  scene.destroy();\n};\n\n\n/**\n * Destroys all {@link Scene scenes} and removes them from the viewer.\n */\nViewer.prototype.destroyAllScenes = function() {\n  while (this._scenes.length > 0) {\n    this.destroyScene(this._scenes[0]);\n  }\n};\n\n\n/**\n * Returns whether the viewer contains a {@link Scene scene}.\n * @param {Scene} scene\n * @return {boolean}\n */\nViewer.prototype.hasScene = function(scene) {\n  return this._scenes.indexOf(scene) >= 0;\n};\n\n\n/**\n * Returns a list of all {@link Scene scenes}.\n * @return {Scene[]}\n */\nViewer.prototype.listScenes = function() {\n  return [].concat(this._scenes);\n};\n\n\n/**\n * Returns the current {@link Scene scene}, or null if there isn't one.\n *\n * To change the current scene, call {@link Viewer#switchScene}.\n *\n * @return {Scene}\n */\nViewer.prototype.scene = function() {\n  return this._currentScene;\n};\n\n\n/**\n * Returns the {@link View view} for the current {@link Scene scene}, or null\n * if there isn't one.\n * @return {View}\n */\nViewer.prototype.view = function() {\n  var scene = this._currentScene;\n  if (scene) {\n    return scene.view();\n  }\n  return null;\n};\n\n\n/**\n * Tweens the {@link View view} for the current {@link Scene scene}.\n *\n * This method is equivalent to calling {@link Scene#lookTo} on the current\n * scene.\n *\n * @param {Object} opts Options to pass into {@link Scene#lookTo}.\n * @param {function} done Function to call when the tween is complete.\n */\nViewer.prototype.lookTo = function(params, opts, done) {\n  // TODO: is it an error to call lookTo when no scene is displayed?\n  var scene = this._currentScene;\n  if (scene) {\n    scene.lookTo(params, opts, done);\n  }\n};\n\n\n/**\n * Starts a movement, possibly replacing the current movement.\n *\n * This method is equivalent to calling {@link Scene#startMovement} on the\n * current scene. If there is no current scene, this is a no-op.\n *\n * @param {function} fn The movement function.\n * @param {function} done Function to be called when the movement finishes or is\n *     interrupted.\n */\nViewer.prototype.startMovement = function(fn, done) {\n  var scene = this._currentScene;\n  if (!scene) {\n    return;\n  }\n  scene.startMovement(fn, done);\n};\n\n\n/**\n * Stops the current movement.\n *\n * This method is equivalent to calling {@link Scene#stopMovement} on the\n * current scene. If there is no current scene, this is a no-op.\n */\nViewer.prototype.stopMovement = function() {\n  var scene = this._currentScene;\n  if (!scene) {\n    return;\n  }\n  scene.stopMovement();\n};\n\n\n/**\n * Returns the current movement.\n *\n * This method is equivalent to calling {@link Scene#movement} on the\n * current scene. If there is no current scene, this is a no-op.\n *\n * @return {function}\n */\nViewer.prototype.movement = function() {\n  var scene = this._currentScene;\n  if (!scene) {\n    return;\n  }\n  return scene.movement();\n};\n\n\n/**\n * Schedules an idle movement to be automatically started when the view remains\n * unchanged for the given timeout period.\n *\n * Changing the view while the idle movement is active stops the movement and\n * schedules it to start again after the same timeout period. To disable it\n * permanently, call with a null movement or an infinite timeout.\n *\n * @param {number} timeout Timeout period in milliseconds.\n * @param {function} movement Automatic movement function, or null to disable.\n */\nViewer.prototype.setIdleMovement = function(timeout, movement) {\n  this._idleTimer.setDuration(timeout);\n  this._idleMovement = movement;\n};\n\n\n/**\n * Stops the idle movement. It will be started again after the timeout set by\n * {@link Viewer#setIdleMovement}.\n */\nViewer.prototype.breakIdleMovement = function() {\n  this.stopMovement();\n  this._resetIdleTimer();\n};\n\n\nViewer.prototype._resetIdleTimer = function() {\n  this._idleTimer.start();\n};\n\n\nViewer.prototype._triggerIdleTimer = function() {\n  var idleMovement = this._idleMovement;\n  if (!idleMovement) {\n    return;\n  }\n  this.startMovement(idleMovement);\n};\n\n\nvar defaultSwitchDuration = 1000;\n\nfunction defaultTransitionUpdate(val, newScene, oldScene) {\n  var layers = newScene.listLayers();\n  layers.forEach(function(layer) {\n    layer.mergeEffects({ opacity: val });\n  });\n\n  newScene._hotspotContainer.domElement().style.opacity = val;\n}\n\n\n/**\n * Switches to another {@link Scene scene} with a fade transition. This scene\n * becomes the current one.\n *\n * If a transition is already taking place, it is interrupted before the new one\n * starts.\n *\n * @param {Scene} newScene The scene to switch to.\n * @param {Object} opts Transition options.\n * @param {number} [opts.transitionDuration=1000] Transition duration, in\n *     milliseconds.\n * @param {number} [opts.transitionUpdate=defaultTransitionUpdate]\n *     Transition update function, with signature `f(t, newScene, oldScene)`.\n *     This function is called on each frame with `t` increasing from 0 to 1.\n *     An initial call with `t=0` and a final call with `t=1` are guaranteed.\n *     The default function sets the opacity of the new scene to `t`.\n * @param {function} done Function to call when the transition finishes or is\n *     interrupted. If the new scene is equal to the old one, no transition\n *     takes place, but this function is still called.\n */\nViewer.prototype.switchScene = function(newScene, opts, done) {\n  var self = this;\n\n  opts = opts || {};\n  done = done || noop;\n\n  var stage = this._stage;\n\n  var oldScene = this._currentScene;\n\n  // Do nothing if the target scene is the current one.\n  if (oldScene === newScene) {\n    done();\n    return;\n  }\n\n  if (this._scenes.indexOf(newScene) < 0) {\n    throw new Error('No such scene in viewer');\n  }\n\n  // Cancel an already ongoing transition. This ensures that the stage contains\n  // layers from exactly one scene before the transition begins.\n  if (this._cancelCurrentTween) {\n    this._cancelCurrentTween();\n    this._cancelCurrentTween = null;\n  }\n\n  var oldSceneLayers = oldScene ? oldScene.listLayers() : [];\n  var newSceneLayers = newScene.listLayers();\n  var stageLayers = stage.listLayers();\n\n  // Check that the stage contains exactly as many layers as the current scene,\n  // and that the top layer is the right one. If this test fails, either there\n  // is a bug or the user tried to modify the stage concurrently.\n  if (oldScene && ((stageLayers.length !== oldSceneLayers.length) ||\n      (stageLayers.length > 1 && stageLayers[0] != oldSceneLayers[0]))) {\n    throw new Error('Stage not in sync with viewer');\n  }\n\n  // Get the transition parameters.\n  var duration = opts.transitionDuration != null ?\n      opts.transitionDuration : defaultSwitchDuration;\n  var update = opts.transitionUpdate != null ?\n      opts.transitionUpdate : defaultTransitionUpdate;\n\n  // Add new scene layers into the stage before starting the transition.\n  for (var i = 0; i < newSceneLayers.length; i++) {\n    this._addLayerToStage(newSceneLayers[i]);\n  }\n\n  // Update function to be called on every frame.\n  function tweenUpdate(val) {\n    update(val, newScene, oldScene);\n  }\n\n  // Once the transition is complete, remove old scene layers from the stage and\n  // remove the event listeners. If the old scene was destroyed during the\n  // transition, this has already been taken care of. Otherwise, we still need\n  // to get a fresh copy of the scene's layers, since they might have changed\n  // during the transition.\n  function tweenDone() {\n    if (self._replacedScene) {\n      self._removeSceneEventListeners(self._replacedScene);\n      oldSceneLayers = self._replacedScene.listLayers();\n      for (var i = 0; i < oldSceneLayers.length; i++) {\n        self._removeLayerFromStage(oldSceneLayers[i]);\n      }\n      self._replacedScene = null;\n    }\n    self._cancelCurrentTween = null;\n    done();\n  }\n\n  // Store the cancelable for the transition.\n  this._cancelCurrentTween = tween(duration, tweenUpdate, tweenDone);\n\n  // Update the current and replaced scene.\n  this._currentScene = newScene;\n  this._replacedScene = oldScene;\n\n  // Emit scene and view change events.\n  this.emit('sceneChange');\n  this.emit('viewChange');\n\n  // Add event listeners to the new scene.\n  // Note that event listeners can only be removed from the old scene once the\n  // transition is complete, since layers might get added or removed in the\n  // interim.\n  this._addSceneEventListeners(newScene);\n};\n\n\nmodule.exports = Viewer;\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar vec4 = require('gl-matrix').vec4;\nvar mat4 = require('gl-matrix').mat4;\n\n/**\n * Helper functions for color transformation {@link Effects}.\n *\n * References:\n *\n *   - [ColorMatrix Guide](http://docs.rainmeter.net/tips/colormatrix-guide)\n *   - [Matrix Operations for Image Processing](http://www.graficaobscura.com/matrix/index.html)\n *   - [WebGLImageFilter](https://github.com/phoboslab/WebGLImageFilter)\n *   - [glfx.js](https://github.com/evanw/glfx.js)\n *\n * @namespace colorEffects\n */\n\n/**\n * A vector and matrix corresponding to an identity transformation.\n *\n * @param {Object} result Object to store result\n * @param {vec4} result.colorOffset Array with zeroes.\n * @param {mat4} result.colorMatrix Identity matrix.\n *\n * @memberof colorEffects\n */\nfunction identity(resultArg) {\n  var result = resultArg || {};\n  result.colorOffset = result.colorOffset || vec4.create();\n  result.colorMatrix = result.colorMatrix || mat4.create();\n  return result;\n}\n\n/**\n * Apply color effects to a single pixel\n *\n * @param {vec4} pixel Values in range [0,1]\n * @param {Object} effect\n * @param {vec4} effect.colorOffset\n * @param {mat4} effect.colorMatrix\n * @param {vec4} result Object to store result\n *\n * @memberof colorEffects\n */\nfunction applyToPixel(pixel, effect, result) {\n  vec4TransformMat4Transposed(result, pixel, effect.colorMatrix);\n  vec4.add(result, result, effect.colorOffset);\n}\n\n// Oddly, the colorTransform matrix needs to be transposed to be used with\n// vec4.transformMat4. It is strange that transformMat4 dosn't work the same\n// way as multiplying on the shader.\n// TODO: investigate this further\nfunction vec4TransformMat4Transposed(out, a, m) {\n  var x = a[0], y = a[1], z = a[2], w = a[3];\n  out[0] = m[0] * x + m[1] * y + m[2] * z + m[3] * w;\n  out[1] = m[4] * x + m[5] * y + m[6] * z + m[7] * w;\n  out[2] = m[8] * x + m[9] * y + m[10] * z + m[11] * w;\n  out[3] = m[12] * x + m[13] * y + m[14] * z + m[15] * w;\n  return out;\n}\n\n/**\n * Apply color effects to an ImageData\n *\n * @param {ImageData} imageData This object will be mutated\n * @param {Object} effect\n * @param {vec4} effect.colorOffset\n * @param {mat4} effect.colorMatrix\n *\n * @memberof colorEffects\n */\nvar tmpPixel = vec4.create();\nfunction applyToImageData(imageData, effect) {\n  var width = imageData.width;\n  var height = imageData.height;\n  var data = imageData.data;\n\n  for(var i = 0; i < width * height; i++) {\n    vec4.set(tmpPixel, data[i*4+0]/255, data[i*4+1]/255, data[i*4+2]/255, data[i*4+3]/255);\n    applyToPixel(tmpPixel, effect, tmpPixel);\n    data[i*4+0] = tmpPixel[0]*255;\n    data[i*4+1] = tmpPixel[1]*255;\n    data[i*4+2] = tmpPixel[2]*255;\n    data[i*4+3] = tmpPixel[3]*255;\n  }\n}\n\nmodule.exports = {\n  identity: identity,\n  applyToPixel: applyToPixel,\n  applyToImageData: applyToImageData\n};\n", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar defaults = require('./util/defaults');\n\nvar defaultSpeed = 0.1;\nvar defaultAccel = 0.01;\n\nvar defaultOptions = {\n  yawSpeed: defaultSpeed,\n  pitchSpeed: defaultSpeed,\n  fovSpeed: defaultSpeed,\n  yawAccel: defaultAccel,\n  pitchAccel: defaultAccel,\n  fovAccel: defaultAccel,\n  targetPitch: 0,\n  targetFov: null\n};\n\n/**\n * @param {Object} opts\n * @param {Number} [opts.yawSpeed=0.1] Yaw maximum speed\n * @param {Number} [opts.pitchSpeed=0.1] Pitch maximum speed\n * @param {Number} [opts.fovSpeed=0.1] Fov maximum speed\n * @param {Number} [opts.yawAccel=0.01] Yaw acceleration\n * @param {Number} [opts.pitchAccel=0.01] Pitch acceleration\n * @param {Number} [opts.fovAccel=0.01] Fov acceleration\n * @param {Number} [opts.targetPitch=0] Value that pitch converges to. `null` means that the pitch will not change.\n * @param {Number} [opts.targetFov=null] Value that fov converges to. `null` means that the fov will not change.\n * @returns Movement function that can be passed to {@link Viewer#setIdleMovement} or {@link Scene#startMovement}\n*/\nfunction autorotate(opts) {\n\n  opts = defaults(opts || {}, defaultOptions);\n\n  var yawSpeed = opts.yawSpeed;\n  var pitchSpeed = opts.pitchSpeed;\n  var fovSpeed = opts.fovSpeed;\n  var yawAccel = opts.yawAccel;\n  var pitchAccel = opts.pitchAccel;\n  var fovAccel = opts.fovAccel;\n  var targetPitch = opts.targetPitch;\n  var targetFov = opts.targetFov;\n\n  return function start() {\n\n    var lastTime = 0;\n    var lastYawSpeed = 0;\n    var lastPitchSpeed = 0;\n    var lastFovSpeed = 0;\n\n    var currentYawSpeed = 0;\n    var currentPitchSpeed = 0;\n    var currentFovSpeed = 0;\n\n    var timeDelta;\n    var yawDelta;\n    var pitchDelta;\n    var fovDelta;\n\n    return function step(params, currentTime) {\n\n      timeDelta = (currentTime - lastTime) / 1000;\n      currentYawSpeed = Math.min(lastYawSpeed + timeDelta * yawAccel, yawSpeed);\n      yawDelta = currentYawSpeed * timeDelta;\n      params.yaw = params.yaw + yawDelta;\n\n      if (targetPitch != null && params.pitch !== targetPitch) {\n        var pitchThresh = 0.5 * lastPitchSpeed * lastPitchSpeed / pitchAccel;\n        if (Math.abs(targetPitch - params.pitch) > pitchThresh) {\n          // Acceleration phase\n          currentPitchSpeed = Math.min(lastPitchSpeed + timeDelta * pitchAccel, pitchSpeed);\n        } else {\n          // Deceleration phase\n          currentPitchSpeed = Math.max(lastPitchSpeed - timeDelta * pitchAccel, 0);\n        }\n        // currentPitchSpeed is the absolute value (>= 0)\n        pitchDelta = currentPitchSpeed * timeDelta;\n        if (targetPitch < params.pitch) {\n          params.pitch = Math.max(targetPitch, params.pitch - pitchDelta);\n        }\n        if (targetPitch > params.pitch) {\n          params.pitch = Math.min(targetPitch, params.pitch + pitchDelta);\n        }\n      }\n\n      if (targetFov != null && params.fov !== targetPitch) {\n        var fovThresh = 0.5 * lastFovSpeed * lastFovSpeed / fovAccel;\n        if (Math.abs(targetFov - params.fov) > fovThresh) {\n          // Acceleration phase\n          currentFovSpeed = Math.min(lastFovSpeed + timeDelta * fovAccel, fovSpeed);\n        } else {\n          // Deceleration phase\n          currentFovSpeed = Math.max(lastFovSpeed - timeDelta * fovAccel, 0);\n        }\n        // currentFovSpeed is the absolute value (>= 0)\n        fovDelta = currentFovSpeed * timeDelta;\n        if (targetFov < params.fov) {\n          params.fov = Math.max(targetFov, params.fov - fovDelta);\n        }\n        if (targetFov > params.fov) {\n          params.fov = Math.min(targetFov, params.fov + fovDelta);\n        }\n      }\n\n      lastTime = currentTime;\n      lastYawSpeed = currentYawSpeed;\n      lastPitchSpeed = currentPitchSpeed;\n      lastFovSpeed = currentFovSpeed;\n\n      return params;\n\n    };\n\n  };\n\n}\n\nmodule.exports = autorotate;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction defer(fn, args) {\n  function deferred() {\n    if (args && args.length > 0) {\n      fn.apply(null, args);\n    } else {\n      fn();\n    }\n  }\n  setTimeout(deferred, 0);\n}\n\nmodule.exports = defer;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @memberof util\n * @param {number} deg\n * @return {number}\n */\nfunction degToRad(deg) {\n  return deg * Math.PI / 180;\n}\n\nmodule.exports = degToRad;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @memberof util\n * @param {number} rad\n * @return {number}\n */\nfunction radToDeg(rad) {\n  return rad * 180 / Math.PI;\n}\n\nmodule.exports = radToDeg;", "/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = {\n\n  // Stages.\n  WebGlStage: require('./stages/WebGl'),\n\n  // Renderers.\n  WebGlCubeRenderer: require('./renderers/WebGlCube'),\n  WebGlFlatRenderer: require('./renderers/WebGlFlat'),\n  WebGlEquirectRenderer: require('./renderers/WebGlEquirect'),\n  registerDefaultRenderers: require('./renderers/registerDefaultRenderers'),\n\n  // Geometries.\n  CubeGeometry: require('./geometries/Cube'),\n  FlatGeometry: require('./geometries/Flat'),\n  EquirectGeometry: require('./geometries/Equirect'),\n\n  // Views.\n  RectilinearView: require('./views/Rectilinear'),\n  FlatView: require('./views/Flat'),\n\n  // Sources.\n  ImageUrlSource: require('./sources/ImageUrl'),\n  SingleAssetSource: require('./sources/SingleAsset'),\n\n  // Assets.\n  StaticAsset: require('./assets/Static'),\n  DynamicAsset: require('./assets/Dynamic'),\n\n  // Texture store.\n  TextureStore: require('./TextureStore'),\n\n  // Layer.\n  Layer: require('./Layer'),\n\n  // Render loop.\n  RenderLoop: require('./RenderLoop'),\n\n  // Controls.\n  KeyControlMethod: require('./controls/Key'),\n  DragControlMethod: require('./controls/Drag'),\n  QtvrControlMethod: require('./controls/Qtvr'),\n  ScrollZoomControlMethod: require('./controls/ScrollZoom'),\n  PinchZoomControlMethod: require('./controls/PinchZoom'),\n  VelocityControlMethod: require('./controls/Velocity'),\n  ElementPressControlMethod: require('./controls/ElementPress'),\n  Controls: require('./controls/Controls'),\n  Dynamics: require('./controls/Dynamics'),\n\n  // High-level API.\n  Viewer: require('./Viewer'),\n  Scene: require('./Scene'),\n\n  // Hotspots.\n  Hotspot: require('./Hotspot'),\n  HotspotContainer: require('./HotspotContainer'),\n\n  // Effects.\n  colorEffects: require('./colorEffects'),\n\n  // Miscellaneous functions.\n  registerDefaultControls: require('./controls/registerDefaultControls'),\n  autorotate: require('./autorotate'),\n\n  // Utility functions.\n  util: {\n    async: require('./util/async'),\n    cancelize: require('./util/cancelize'),\n    chain: require('./util/chain'),\n    clamp: require('./util/clamp'),\n    clearOwnProperties: require('./util/clearOwnProperties'),\n    cmp: require('./util/cmp'),\n    compose: require('./util/compose'),\n    convertFov: require('./util/convertFov'),\n    decimal: require('./util/decimal'),\n    defaults: require('./util/defaults'),\n    defer: require('./util/defer'),\n    degToRad: require('./util/degToRad'),\n    delay: require('./util/delay'),\n    dom: require('./util/dom'),\n    extend: require('./util/extend'),\n    hash: require('./util/hash'),\n    inherits: require('./util/inherits'),\n    mod: require('./util/mod'),\n    noop: require('./util/noop'),\n    now: require('./util/now'),\n    once: require('./util/once'),\n    pixelRatio: require('./util/pixelRatio'),\n    radToDeg: require('./util/radToDeg'),\n    real: require('./util/real'),\n    retry: require('./util/retry'),\n    tween: require('./util/tween'),\n    type: require('./util/type')\n  },\n\n  // Expose dependencies for clients to use.\n  dependencies: {\n    bowser: require('bowser'),\n    glMatrix: require('gl-matrix'),\n    eventEmitter: require('minimal-event-emitter'),\n    hammerjs: require('hammerjs')\n  }\n};\n"],
  "mappings": "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",
  "names": ["tile", "self", "global", "global", "self", "self", "tile", "equals", "scale", "add", "clone", "copy", "create", "determinant", "equals", "exactEquals", "frob", "fromRotation", "fromScaling", "fromValues", "identity", "invert", "mul", "multiply", "multiplyScalar", "multiplyScalarAndAdd", "rotate", "scale", "set", "str", "sub", "subtract", "add", "adjoint", "clone", "copy", "create", "determinant", "equals", "exactEquals", "frob", "fromRotation", "fromScaling", "fromTranslation", "fromValues", "identity", "invert", "mul", "multiply", "multiplyScalar", "multiplyScalarAndAdd", "rotate", "scale", "set", "str", "sub", "subtract", "translate", "transpose", "add", "adjoint", "clone", "copy", "create", "determinant", "equals", "exactEquals", "frob", "fromQuat", "fromRotation", "fromScaling", "fromTranslation", "fromValues", "identity", "invert", "mul", "multiply", "multiplyScalar", "multiplyScalarAndAdd", "rotate", "scale", "set", "str", "sub", "subtract", "translate", "transpose", "len", "add", "clone", "copy", "create", "equals", "exactEquals", "fromValues", "mul", "multiply", "rotateX", "rotateY", "rotateZ", "scale", "set", "str", "sub", "subtract", "len", "add", "ceil", "clone", "copy", "create", "cross", "dist", "distance", "div", "divide", "dot", "equals", "exactEquals", "floor", "forEach", "fromValues", "inverse", "len", "length", "lerp", "max", "min", "mul", "multiply", "negate", "normalize", "random", "round", "scale", "scaleAndAdd", "set", "sqrDist", "sqrLen", "squaredDistance", "squaredLength", "str", "sub", "subtract", "transformMat4", "transformQuat", "zero", "add", "clone", "copy", "create", "dot", "equals", "exactEquals", "fromValues", "identity", "invert", "len", "length", "lerp", "mul", "multiply", "normalize", "random", "rotateX", "rotateY", "rotateZ", "scale", "set", "sqrLen", "squaredLength", "str", "add", "clone", "conjugate", "copy", "create", "dot", "equals", "exactEquals", "fromMat4", "fromRotation", "fromRotationTranslation", "fromTranslation", "fromValues", "getTranslation", "identity", "invert", "len", "length", "lerp", "mul", "multiply", "normalize", "rotateX", "rotateY", "rotateZ", "scale", "set", "sqrLen", "squaredLength", "str", "translate", "add", "angle", "ceil", "clone", "copy", "create", "cross", "dist", "distance", "div", "divide", "dot", "equals", "exactEquals", "floor", "forEach", "fromValues", "inverse", "len", "length", "lerp", "max", "min", "mul", "multiply", "negate", "normalize", "random", "rotate", "round", "scale", "scaleAndAdd", "set", "sqrDist", "sqrLen", "squaredDistance", "squaredLength", "str", "sub", "subtract", "transformMat3", "transformMat4", "zero", "min", "max", "tile", "tile", "tile", "face", "v", "i", "angle", "max", "tile", "frustum", "perspective", "min", "max", "require_Flat", "scale", "frustum", "min", "max", "len", "tile", "self", "done", "tile", "self", "tile", "self", "self", "self", "window", "document", "undefined", "round", "merge", "str", "self", "getAngle", "getRotation", "distance", "add", "scale", "self", "perspective", "self", "params", "self", "i", "identity"]
}
